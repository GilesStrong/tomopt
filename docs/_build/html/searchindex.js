Search.setIndex({"docnames": ["index", "installation", "introduction", "modules", "tomopt", "tomopt.benchmarks", "tomopt.benchmarks.ladle_furnace", "tomopt.benchmarks.small_walls", "tomopt.benchmarks.u_lorry", "tomopt.inference", "tomopt.muon", "tomopt.optimisation", "tomopt.optimisation.callbacks", "tomopt.optimisation.data", "tomopt.optimisation.loss", "tomopt.optimisation.wrapper", "tomopt.plotting", "tomopt.volume"], "filenames": ["index.rst", "installation.rst", "introduction.md", "modules.rst", "tomopt.rst", "tomopt.benchmarks.rst", "tomopt.benchmarks.ladle_furnace.rst", "tomopt.benchmarks.small_walls.rst", "tomopt.benchmarks.u_lorry.rst", "tomopt.inference.rst", "tomopt.muon.rst", "tomopt.optimisation.rst", "tomopt.optimisation.callbacks.rst", "tomopt.optimisation.data.rst", "tomopt.optimisation.loss.rst", "tomopt.optimisation.wrapper.rst", "tomopt.plotting.rst", "tomopt.volume.rst"], "titles": ["TomOpt: Differential Muon Tomography Optimisation", "Installation", "Overview", "tomopt", "tomopt package", "tomopt.benchmarks package", "tomopt.benchmarks.ladle_furnace package", "tomopt.benchmarks.small_walls package", "tomopt.benchmarks.u_lorry package", "tomopt.inference package", "tomopt.muon package", "tomopt.optimisation package", "tomopt.optimisation.callbacks package", "tomopt.optimisation.data package", "tomopt.optimisation.loss package", "tomopt.optimisation.wrapper package", "tomopt.plotting package", "tomopt.volume package"], "terms": {"instal": 0, "test": [0, 1, 2, 6, 8, 9, 12, 14], "extern": 0, "repo": [0, 2], "author": 0, "volum": [0, 1, 2, 4, 8, 10, 12, 13, 14, 15, 16], "infer": [0, 1, 2, 4, 10, 12, 14, 15, 17], "plot": [0, 2, 4, 9, 12, 17], "benchmark": [0, 1, 2, 4], "muon": [2, 4, 6, 9, 12, 15, 16, 17], "optimis": [1, 2, 4, 17], "class_to_x0pr": 4, "arrai": [4, 10, 12, 16], "id2x0": 4, "sourc": [4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], "convert": [4, 6, 9, 14], "class": [0, 1, 2, 4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 17], "x0": [4, 6, 9, 12, 13, 14, 15, 16, 17], "predict": [4, 6, 9, 12, 13, 14, 15], "us": [0, 1, 2, 4, 9, 10, 12, 13, 14, 15, 16, 17], "map": [4, 10, 12, 14, 15], "defin": [0, 2, 4, 10, 12, 17], "paramet": [0, 2, 4, 6, 9, 10, 12, 13, 14, 15, 16, 17], "ndarrai": [4, 10, 12, 15, 16], "integ": [4, 9, 14], "id": [1, 4, 12, 14, 17], "dict": [4, 9, 10, 12, 14, 15, 17], "int": [4, 6, 9, 10, 12, 13, 14, 15, 17], "float": [4, 9, 10, 12, 13, 14, 15, 17], "valu": [4, 9, 10, 12, 13, 14, 16, 17], "return": [4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17], "type": [4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17], "new": [0, 2, 4, 6, 9, 10, 12, 13, 15, 17], "jacobian": 4, "y": [4, 6, 9, 10, 16, 17], "x": [4, 6, 9, 10, 16, 17], "create_graph": 4, "fals": [1, 4, 6, 10, 12, 14, 15, 17], "allow_unus": 4, "true": [4, 6, 9, 10, 12, 13, 14, 15, 16, 17], "comput": [1, 4, 6, 9, 10, 12, 14, 15, 17], "dy": 4, "dx": 4, "respect": [0, 2, 4], "variabl": [4, 9, 10, 15], "can": [0, 1, 2, 4, 9, 10, 12, 13, 14, 15, 17], "have": [0, 2, 4, 6, 9, 10, 12, 13, 14, 15, 17], "multipl": [4, 9, 12, 14, 15, 17], "element": [4, 10, 17], "If": [0, 1, 2, 4, 9, 10, 12, 13, 14, 15, 17], "ha": [4, 6, 9, 10, 12, 17], "i": [0, 1, 2, 4, 6, 9, 10, 12, 13, 14, 15, 16, 17], "vectoris": 4, "via": [1, 4, 6, 9, 10, 12, 14, 15, 17], "vmap": 4, "tensor": [4, 6, 7, 9, 10, 12, 13, 14, 15, 17], "differenti": [2, 4, 9, 12, 17], "depend": [4, 14], "bool": [4, 9, 12, 13, 14, 15, 17], "graph": 4, "deriv": 4, "construct": 4, "allow": [0, 2, 4, 9, 12, 17], "higher": [4, 9, 12, 14, 17], "order": [1, 4, 9, 12, 13, 14, 15, 16, 17], "product": [0, 2, 4], "default": [4, 10, 12, 14, 15, 17], "specifi": [4, 10, 12, 13, 14, 15, 17], "input": [1, 4], "were": [4, 9, 10], "when": [1, 4, 6, 9, 12, 13, 14, 15, 17], "output": [1, 4, 14], "therefor": [4, 17], "grad": 4, "alwai": [4, 9, 13, 17], "shape": [4, 10, 14], "x0_from_mixtur": 4, "densiti": 4, "weight_frac": 4, "none": [4, 6, 9, 10, 12, 13, 14, 15, 16, 17], "volume_frac": 4, "mixtur": 4, "non": [4, 17], "chemic": 4, "bond": 4, "materi": [4, 9, 12, 13, 14, 17], "base": [4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 17], "http": [1, 4, 9, 12, 17], "cd": [1, 4], "cern": 4, "ch": 4, "record": [0, 2, 4, 9, 10, 12, 15, 16, 17], "1279627": 4, "file": [4, 12, 15], "ph": 4, "ep": 4, "tech": 4, "note": 4, "2010": 4, "013": 4, "pdf": [4, 9, 17], "union": [4, 10, 12, 13, 14, 15, 17], "list": [1, 4, 10, 12, 13, 15, 17], "metr": [4, 9, 10, 12, 17], "kg": 4, "m": [4, 6, 10, 17], "3": [1, 4, 9, 10, 14, 17], "rel": [4, 9, 14, 17], "amount": [4, 9, 10, 12], "each": [1, 4, 9, 10, 12, 14, 15, 17], "weight": [4, 6, 9, 14, 17], "The": [0, 1, 2, 4, 9, 12, 13, 14, 15, 17], "x0targs_to_classtarg": 4, "x02id": [4, 12, 14], "target": [4, 9, 12, 13, 14, 15, 17], "To": [1, 4, 9], "account": [4, 9, 12, 15, 17], "point": [1, 4, 9, 10, 12, 15, 17], "precis": [4, 9, 10, 12, 15, 17], "ar": [0, 1, 2, 4, 9, 10, 12, 13, 14, 15, 16, 17], "which": [0, 1, 2, 4, 9, 10, 12, 13, 14, 15, 17], "closest": 4, "kei": [4, 10, 12], "thi": [0, 1, 2, 4, 6, 9, 10, 12, 13, 14, 16, 17], "mean": [4, 9, 12, 14, 15, 17], "method": [0, 2, 4, 6, 9, 10, 12, 13, 14, 15, 17], "cannot": [4, 9], "detect": [4, 12, 17], "miss": 4, "from": [0, 1, 2, 4, 9, 10, 12, 13, 14, 15, 17], "even": [4, 12], "isn": 4, "t": [4, 9, 10, 17], "modifi": [0, 2, 4, 10], "place": [4, 9, 10, 12, 17], "genscatterbatch": 9, "mu": [9, 12, 15, 17], "scatterbatch": [6, 9, 15], "inform": [0, 2, 9, 10, 14, 15, 17], "hit": [6, 9, 10, 12, 16, 17], "incom": [9, 12, 17], "outgo": 9, "trajectori": [0, 2, 9, 10, 15, 17], "fit": [6, 9, 12, 15, 17], "intend": [9, 17], "diagnost": 9, "purpos": 9, "onli": [6, 8, 9, 10, 12, 13, 15, 17], "track": [9, 12], "carri": 9, "gradient": [0, 2, 9, 12, 15], "w": [9, 10, 17], "r": [9, 10, 17], "detector": [0, 1, 2, 6, 9, 10, 12, 14, 15, 16, 17], "except": [9, 10, 17], "z": [6, 9, 10, 12, 13, 15, 16, 17], "posit": [9, 10, 12, 13, 15, 16, 17], "linear": 9, "perform": [0, 1, 2, 9, 14, 17], "separ": [1, 9], "all": [0, 2, 9, 10, 12, 13, 14, 15, 17], "associ": [9, 10, 12, 15], "layer": [9, 10, 12, 13, 14, 15, 16], "group": [9, 12, 17], "indic": [9, 12, 17], "po": [9, 10, 17], "attribut": [9, 10, 12, 17], "current": [1, 9, 10, 12, 14, 17], "expect": [1, 9, 12, 14, 17], "abov": [6, 9, 10, 17], "passiv": [0, 1, 2, 6, 9, 10, 12, 14, 15, 16, 17], "those": [1, 9, 10, 12, 17], "below": [6, 9, 10, 17], "an": [0, 1, 2, 9, 12, 13, 14, 17], "analyt": 9, "likelihood": [9, 14], "minimis": [0, 2, 9], "uncertainti": [6, 9], "consid": [9, 12], "doe": [9, 10, 12, 17], "e": [0, 1, 2, 9, 10, 12, 14, 16, 17], "g": [0, 1, 2, 9, 10, 12, 14, 17], "third": 9, "set": [0, 1, 2, 9, 10, 12, 13, 14, 15, 17], "sinc": [9, 15, 17], "split": 9, "n_hits_abov": 9, "One": 9, "instanc": [1, 9, 17], "should": [6, 9, 10, 12, 13, 14, 15, 17], "creat": [9, 10, 12], "muonbatch": [9, 10, 12, 15, 17], "As": [0, 2, 9, 12], "part": [0, 2, 9, 12, 17], "initialis": [9, 10, 12, 13, 15, 17], "filter": 9, "_filter_scatt": 9, "avoid": [9, 12], "nan": [9, 12, 17], "inf": 9, "result": [0, 1, 2, 9, 10, 17], "direct": [9, 10], "chang": [9, 10, 17], "mani": [1, 9, 10, 14], "requir": [0, 1, 2, 9, 10, 15, 17], "further": 9, "downstream": 9, "lazi": 9, "basi": 9, "memois": 9, "first": [0, 1, 2, 9, 12, 14, 16], "request": [9, 15], "store": [9, 10, 15, 17], "case": [0, 2, 9, 14], "dtheta": [9, 10], "dphi": 9, "total": [6, 9, 12, 13, 14, 15, 17], "under": [9, 17], "assumpt": 9, "small": [9, 17], "angular": [9, 10], "necessari": [9, 15], "here": [0, 1, 2, 9, 12, 17], "loss": [0, 2, 9, 11, 12, 15], "undergo": [9, 17], "theta": [9, 10], "phi": [9, 10], "0": [6, 7, 8, 9, 10, 12, 15, 17], "pi": [9, 10], "neg": [6, 9, 10, 14], "becom": 9, "one": [9, 12, 14, 15, 17], "tell": 9, "whether": [9, 12, 14, 17], "instead": [9, 10, 12, 14, 17], "larg": [9, 10, 12, 14], "occur": [9, 15], "total_scatt": 9, "quadratur": 9, "sum": [9, 14, 17], "three": [9, 17], "both": [9, 13, 14, 15, 17], "hypothes": 9, "final": [1, 6, 9, 12, 14], "chosen": 9, "hypothesi": 9, "been": [6, 9, 12], "found": [9, 12, 17], "good": [1, 9], "through": [0, 2, 9, 10, 12, 17], "travel": [9, 10], "_compute_track": [], "object": [0, 2, 9, 10, 12, 13, 15, 17], "effici": [6, 9, 10, 12, 17], "static": [6, 9, 10, 12, 17], "_compute_dtheta_dphi_scatt": [], "theta_in": 9, "phi_in": 9, "theta_out": 9, "phi_out": 9, "n": [1, 9, 10, 17], "1": [6, 7, 9, 10, 12, 14, 15, 17], "angl": 10, "str": [9, 10, 12, 13, 14, 15, 16, 17], "dictionari": [9, 10, 12, 14, 15], "_compute_out_var_unc": [], "var": [], "due": [], "error": [12, 14], "propag": [10, 12, 17], "triangl": [], "matrix": [], "assum": [6, 9, 14, 17], "zero": [12, 15, 17], "off": [10, 14], "diagon": [], "warn": 1, "un": [], "correl": [], "probabl": [6, 9, 14, 17], "ok": [], "behaviour": [], "_compute_phi": [], "xy": [9, 10, 12, 13, 15, 16, 17], "compon": [12, 14, 17], "vector": 9, "_compute_scatt": [], "normal": [15, 17], "them": [1, 12, 17], "extract": [], "handl": [0, 1, 2], "locat": [6, 9, 12, 15, 17], "adapt": 12, "misc": [], "3334866": [], "titl": [], "between": [1, 9, 10, 12, 14, 17], "two": [6, 9, 17], "line": [], "brian": [], "math": [], "stackexchang": [], "com": 1, "user": [0, 1, 2, 9, 12, 15, 17], "72614": [], "howpublish": [], "mathemat": [], "stack": [10, 17], "exchang": [], "url": [], "q": [], "version": [1, 14], "2019": [9, 17], "08": [], "26": [], "eprint": [], "_compute_theta": [], "xyz": [6, 9, 10, 17], "_compute_theta_msc": [], "p": [9, 10, 12, 15], "cosin": [], "dot": [], "2": [9, 10, 12, 17], "accord": [9, 10, 12, 15, 17], "resolut": [12, 17], "_compute_xyz_in": [], "level": [1, 6, 9, 17], "top": [9, 17], "_compute_xyz_out": [], "bottom": [9, 12, 16, 17], "_cross_track": [], "option": [9, 10, 12, 13, 14, 15, 16, 17], "_dphi": [], "_dphi_unc": [], "_dtheta": [], "_dtheta_unc": [], "_dtheta_xi": [], "_dtheta_xy_unc": [], "_dxy": [], "_dxy_unc": [], "_extract_hit": [], "take": [1, 12, 17], "combin": [1, 9, 12], "singl": [1, 9, 10, 12, 13, 14, 15, 17], "might": [], "seem": [], "heavi": [], "hand": 9, "invalid": [], "extrem": 10, "spoil": [], "other": [1, 12, 14, 15, 17], "remov": 10, "ani": [1, 10, 12, 15, 17], "least": [6, 9, 10, 14], "high": [1, 12, 14], "some": [12, 14, 17], "configur": [14, 15, 17], "tini": [], "best": [], "manual": [9, 10, 17], "unneed": [], "gain": [], "increas": [12, 14, 16], "number": [1, 6, 9, 10, 12, 13, 14, 15, 17], "avail": [1, 12, 17], "criteria": [], "parallel": [], "far": 14, "its": [1, 6, 10, 12, 13, 14, 17], "1e10": [], "_gen_hit": [], "_hit_eff": [], "_hit_unc": [], "_phi_in": [], "_phi_in_unc": [], "_phi_out": [], "_phi_out_unc": [], "_poca_xyz": [], "_poca_xyz_unc": [], "_reco_hit": [], "_set_dtheta_dphi_scatt": [], "simultan": [], "done": [], "_theta_in": [], "_theta_in_unc": [], "_theta_out": [], "_theta_out_unc": [], "_theta_xy_in": [], "_theta_xy_in_unc": [], "_theta_xy_out": [], "_theta_xy_out_unc": [], "_total_scatt": [], "_total_scatter_unc": [], "_track_coef": [], "_track_in": [], "_track_out": [], "_track_start_in": [], "_track_start_out": [], "_xyz_in": [], "_xyz_in_unc": [], "_xyz_out": [], "_xyz_out_unc": [], "properti": [0, 2, 6, 9, 10, 17], "above_gen_hit": 9, "above_hit_eff": 9, "eff": [6, 7, 9, 17], "above_hit_unc": 9, "above_hit": 9, "below_gen_hit": 9, "below_hit_eff": 9, "below_hit_unc": 9, "below_hit": 9, "delta": 9, "dphi_unc": 9, "dtheta_unc": 9, "dtheta_xi": [9, 10], "theta_xi": [9, 10], "zx": 9, "zy": 9, "plane": [9, 10, 17], "dtheta_xy_unc": 9, "dxy": 9, "distanc": [9, 10, 17], "poca": [6, 9, 12, 16], "dxy_unc": 9, "gen_hit": 9, "get_muon_trajectori": 9, "unc": 9, "lw": [9, 17], "whilst": [9, 12, 17], "No": 9, "maximis": 9, "length": [9, 12, 13, 17], "width": [9, 13, 17], "start": [9, 10, 12, 17], "initi": [9, 10, 12, 17], "vec": 9, "get_scatter_mask": 9, "boolean": [9, 10, 12, 17], "where": [9, 10, 12, 13, 14, 15, 17], "within": [1, 9, 10, 12, 15, 17], "hit_eff": 9, "hit_unc": 9, "get_hit": [9, 10, 17], "per": [6, 9, 12, 13, 14, 15, 17], "n_hits_below": 9, "phi_in_unc": 9, "phi_out_unc": 9, "plot_scatt": 9, "idx": 9, "represent": [9, 12], "index": [9, 10, 17], "poca_xyz": 9, "poca_xyz_unc": 9, "reco_hit": 9, "theta_in_unc": 9, "theta_msc": 9, "theta_msc_unc": 9, "theta_out_unc": 9, "theta_xy_in": 9, "decompos": 9, "theta_xy_in_unc": 9, "theta_xy_out": 9, "theta_xy_out_unc": 9, "total_scatter_unc": 9, "track_in": 9, "track_out": 9, "track_start_in": 9, "track_start_out": 9, "xyz_in": 9, "xyz_in_unc": 9, "xyz_out": 9, "xyz_out_unc": 9, "absintclassifierfromx0": [6, 9], "partial_x0_inferr": [6, 9], "output_prob": [6, 9], "class2float": 9, "absvolumeinferr": [6, 9, 15], "abstract": [9, 10, 13, 14, 15, 17], "multiclass": [9, 14], "classif": [9, 14], "voxelwis": [6, 9, 12, 14, 16], "inherit": [6, 9, 10, 12, 14, 15, 17], "must": [1, 6, 9, 12, 14, 17], "provid": [0, 2, 9, 10, 12, 13, 14, 15, 17], "wai": [1, 9], "dimens": 9, "basic": [1, 9], "inferr": [6, 9, 12], "raw": 9, "most": [1, 9, 16], "In": [1, 9, 10, 12, 15], "latter": [9, 17], "process": [0, 2, 9, 12, 17], "function": [0, 2, 9, 10, 12, 13, 14, 15, 17], "absx0inferr": 9, "partial": 9, "instati": 9, "pass": [0, 2, 9, 10, 12, 17], "probabilit": 9, "otherwis": [9, 12, 13, 14, 17], "argmax": 9, "over": [9, 10, 12, 14, 15, 17], "last": [9, 10, 12], "callabl": [9, 13, 15, 17], "_abc_impl": [], "_abc_data": [], "_reset_var": [], "reset": [], "made": [6, 12, 14], "ad": [9, 10, 12, 17], "batch": [0, 2, 6, 9, 10, 12, 15, 17], "add_scatt": 9, "append": [9, 12, 15], "vairabl": 9, "get_predict": [6, 9], "call": [9, 10, 12, 13, 15, 17], "": [9, 10, 12, 15, 17], "up": [1, 9, 12, 14, 15, 17], "compute_effici": [6, 9], "compuat": 9, "implement": [0, 2, 9, 10, 12, 15, 17], "contain": [0, 2, 6, 9, 10, 12, 13, 14, 15, 17], "whose": [1, 6, 9], "predicion": 9, "dure": [9, 12, 13, 17], "inv_weight": [], "pred": [6, 9, 14, 15, 16], "x02prob": [6, 9], "vox_pr": [6, 9], "overrid": [6, 9, 10, 12, 14, 15, 17], "fed": 9, "given": [6, 9, 10, 13, 14], "individu": [6, 9, 14], "accompani": [], "invers": 9, "design": [0, 1, 2, 12, 14, 15, 17], "divid": 9, "targ": [], "tupl": [10, 12, 13, 15, 17], "everi": [9, 10, 12, 13, 14, 15, 17], "voxel": [6, 9, 12, 13, 14, 17], "approach": [9, 17], "assign": [9, 15, 17], "entireti": 9, "pdg": [9, 17], "model": [1, 9, 10, 12, 17], "describ": [9, 17], "lbl": [9, 17], "gov": [9, 17], "review": [9, 17], "rpp2018": [9, 17], "rev": [9, 17], "passag": [9, 17], "particl": [9, 17], "matter": [9, 17], "onc": [9, 10, 12], "proce": [9, 15], "thusli": 9, "For": [0, 2, 9, 10, 12, 14, 15, 17], "p_ij": 9, "wa": [1, 9, 12, 14], "j": 9, "These": [0, 1, 2, 9, 14], "integr": 9, "uncorrel": [9, 17], "gaussian": [9, 15, 17], "centr": [9, 12, 13, 14, 17], "scale": [9, 15], "equal": [9, 10, 14, 17], "multipli": [9, 14, 17], "e_i": 9, "w_ij": 9, "give": 9, "x_0": 9, "left": [9, 17], "frac": 9, "0136": 9, "mathrm": 9, "rm": 9, "right": 9, "co": 9, "bar": 9, "_": [1, 9], "tot": 9, "differ": [9, 10, 12, 13, 17], "whole": [9, 15], "popul": 9, "rmss": 9, "term": [9, 14], "side": 9, "equat": 9, "addit": [0, 2, 9, 10, 14], "varianc": 9, "squar": [9, 14, 17], "x0_j": 9, "NOT": [9, 10, 17], "natur": 9, "log": [1, 9, 12, 14], "simplifi": 9, "code": [0, 2, 9, 14], "reli": [9, 17], "heavili": 9, "care": [0, 2, 9, 17], "privat": 9, "_combine_scatt": [], "data": [0, 1, 2, 11, 12, 15, 17], "so": 12, "entri": [], "out": [1, 14], "aid": [], "pair": [10, 12], "retriev": [10, 12, 17], "_get_voxel_zxy_x0_pred_unc": [], "incorrect": [], "todo": [9, 12, 14, 16, 17], "correct": [1, 17], "incredibli": [], "slow": [], "recommend": [9, 17], "_get_voxel_zxy_x0_pr": [], "spread": [], "_muon_effici": [], "_muon_probs_per_voxel_zxi": [], "_muon_scatter_var_unc": [], "_muon_scatter_var": [], "_n_mu": [], "_set_var_dimens": [], "_var_order_sz": [], "tot_scatt": [], "mom": [9, 10, 15], "_vox_zxy_x0_pred_unc": [], "_vox_zxy_x0_pr": [], "_weighted_mean": [], "wgt": [], "row": [], "_weighted_rm": [], "root": 1, "muon_effici": [6, 9], "muon_mom": 9, "momenta": [9, 10], "muon_mom_unc": 9, "muon_poca_xyz": [6, 9], "muon_poca_xyz_unc": [6, 9], "muon_probs_per_voxel_zxi": 9, "don": 9, "muon_theta_in": 9, "muon_theta_in_unc": 9, "muon_theta_out": 9, "muon_theta_out_unc": 9, "muon_total_scatt": 9, "muon_total_scatter_unc": 9, "n_mu": [6, 9], "includ": [1, 6, 9, 12, 14, 17], "vox_zxy_x0_pred_unc": 9, "Not": 9, "long": [9, 17], "calcul": [0, 2, 9, 12], "unit": [6, 8, 9, 12, 14, 17], "vox_zxy_x0_pr": 9, "x0_from_scatt": 9, "deltaz": 9, "invert": 9, "height": [1, 6, 9, 14, 17], "momentum": [9, 10, 12, 15], "estim": [1, 9], "denseblockclassifierfromx0": 9, "n_block_voxel": 9, "use_avgpool": 9, "cut_coef": 9, "10000": [6, 7, 9], "ratio_offset": 9, "ratio_coef": 9, "presenc": 9, "denser": 9, "transform": [9, 12], "wise": [9, 12], "binari": [9, 14], "statist": 9, "dens": 9, "block": [9, 13, 14, 17], "against": [9, 12, 13], "light": 9, "background": [9, 13], "bkg": 9, "blk": 9, "sigma": [9, 17], "b": [1, 9], "lowest": [9, 17], "remain": [9, 17], "rescal": [9, 14, 17], "coeffici": [9, 12, 14, 15, 17], "offset": 9, "constrain": 9, "beween": 9, "present": [9, 12, 13], "nearer": 9, "form": [1, 9, 17], "contigu": [9, 17], "blur": 9, "stride": 9, "kernel": [6, 9], "size": [7, 9, 13, 15, 17], "averag": [6, 9, 12, 14], "pool": 9, "actual": [9, 12, 17], "cut": 9, "sigmoid": [9, 14, 17], "kth": 9, "statisitc": 9, "also": [0, 2, 9, 10, 15, 17], "occupi": [9, 17], "wether": 9, "prediciton": 9, "sharp": 9, "sharper": [9, 12, 17], "constant": [1, 9, 10], "ratio": [9, 17], "scatter_batch": [], "panelx0inferr": [9, 15], "paneldetectorlay": [9, 12, 17], "absmuongener": [10, 12, 15], "x_rang": 10, "y_rang": 10, "fixed_mom": 10, "5": [7, 8, 10, 14, 17], "energy_rang": 10, "500": 10, "theta_rang": 10, "2217304763960306": 10, "core": [0, 2, 10], "flux": [0, 1, 2, 10], "generate_set": 10, "kinemat": 10, "sampl": [10, 12, 17], "uniformli": 10, "region": 10, "rang": [10, 12, 15, 17], "absolut": [10, 14, 17], "refer": [10, 15], "frame": [10, 17], "gev": 10, "radian": 10, "_muon_mass2": [], "01116369210198225": [], "_n_bins_energi": [], "200": [], "_n_bins_theta": [], "energi": 10, "suppli": [10, 15, 17], "classmethod": [10, 15], "from_volum": [10, 15], "min_angl": 10, "2617993877991494": 10, "heurist": 10, "d": 10, "balanc": [10, 14], "trade": 10, "realism": 10, "minimum": [10, 17], "boundari": [10, 12, 15, 17], "would": [0, 2, 10, 17], "directli": 10, "toward": 10, "n_muon": 10, "rank": 10, "2pi": 10, "muongenerator2015": 10, "guan": 10, "et": 10, "al": 10, "2015": 10, "arxiv": [10, 12], "1509": 10, "06176": 10, "p1": 10, "102573": 10, "p2": 10, "068287": 10, "p3": 10, "958633": 10, "p4": 10, "0407253": 10, "p5": 10, "817285": 10, "gaisser": 10, "formula": 10, "cosmic": 10, "np": 10, "incid": 10, "muongenerator2016": 10, "shukla": 10, "sanskrith": 10, "2018": 10, "1606": 10, "06907": 10, "e_0": 10, "87": 10, "e_c": 10, "i_0": 10, "88": 10, "38": 10, "1938": 10, "rod": 10, "174": 10, "epinv": 10, "00117096018735363": 10, "xy_p_theta_phi": [10, 12], "init_z": 10, "devic": [6, 7, 10, 15, 17], "cpu": [6, 7, 10, 15, 17], "own": 10, "coordin": [10, 12], "axi": [10, 17], "upward": 10, "mai": [1, 10, 12, 17], "automat": [10, 12, 17], "anticlockwis": 10, "updat": [0, 1, 2, 6, 10, 12, 15, 17], "propagate_dz_dz": 10, "dz": 10, "propagate_dz_d": 10, "scatter_dxi": 10, "dx_vol": 10, "dy_vol": 10, "mask": [10, 17], "shift": 10, "scatter_dtheta_dphi": 10, "dtheta_vol": 10, "dphi_vol": 10, "alter": 10, "eventu": 10, "extend": [0, 2, 10, 12], "about": [10, 12, 14], "reco_mom": 10, "howev": [10, 17], "simul": [0, 2, 10, 17], "measur": 10, "By": [10, 17], "snapshot_xyz": 10, "time": [9, 10, 14, 17], "xyz_hist": 10, "append_hit": 10, "_hit": 10, "_keep_mask": [], "_mom": [], "_phi": [], "_theta": [], "_x": [], "_xy": [], "_xyz": [], "_y": [], "_z": [], "reco_xi": [10, 17], "gen_xi": [10, 17], "either": [10, 12, 13, 17], "copi": [1, 10], "detach": 10, "clone": [1, 10], "theta_ref": 10, "compar": [0, 2, 10, 14, 16], "dtheta_x": 10, "theta_ref_x": 10, "theta_x": 10, "dtheta_i": 10, "theta_ref_i": 10, "theta_i": 10, "filter_muon": 10, "keep_mask": 10, "along": 10, "xy_low": 10, "xy_high": 10, "eas": 10, "n_hit": 10, "lower": [10, 12, 13, 14, 17], "limit": [10, 12], "upper": 10, "get_xy_mask": [10, 17], "correspond": [10, 14, 17], "p_dim": 10, "ph_dim": 10, "phi_from_theta_xi": 10, "work": [0, 1, 2, 10, 15], "xz": 10, "yz": 10, "anti": 10, "clockwis": 10, "propagate_d": 10, "flight": 10, "move": [10, 12, 17], "propagate_dz": 10, "afterward": [10, 17], "thei": [10, 12, 13, 14, 15, 17], "downward": 10, "remove_upwards_muon": 10, "after": [6, 10, 12, 14, 15, 17], "scatter": [0, 2, 6, 10, 12, 15, 17], "run": [6, 10, 12, 15, 17], "make": [1, 10, 12, 16, 17], "sure": [1, 10], "complet": [10, 12], "longer": 10, "scatter_dtheta_xi": 10, "dtheta_x_vol": 10, "dtheta_y_vol": 10, "scatter_dxyz": 10, "dz_vol": 10, "displac": 10, "th_dim": 10, "4": [7, 10, 17], "theta_from_theta_xi": 10, "theta_x_from_theta_phi": 10, "theta_y_from_theta_phi": 10, "upwards_muon": 10, "x_dim": 10, "y_dim": 10, "z_dim": 10, "callback": [0, 1, 2, 6, 11, 15], "wrapper": [11, 12], "valid": [1, 12, 15], "absvolumewrapp": [12, 15, 17], "interject": [12, 15], "variou": [0, 2, 12, 15, 17], "do": [12, 17], "noth": [12, 17], "pleas": [0, 2, 12, 17], "check": [1, 12, 17], "see": [1, 12, 17], "exactli": 12, "write": [12, 15], "volumewrapp": [12, 17], "Their": 12, "fit_param": 12, "fitparam": [12, 15], "style": 12, "It": [12, 14, 17], "read": [0, 2, 12, 15], "rather": [0, 2, 12, 17], "than": [12, 13, 14, 17], "on_": [12, 15], "_begin": [12, 15], "_end": [12, 15], "full": [12, 15, 17], "loop": [12, 15, 17], "set_wrapp": [12, 15], "on_train_begin": [6, 12, 15], "epoch": [12, 13, 15], "n_epoch": [12, 15], "state": [12, 14, 15], "train": [1, 12, 13, 15, 17], "on_epoch_begin": [12, 15], "enumer": [12, 15], "trn_passiv": [12, 15], "passive_b": [12, 15], "on_volume_batch_begin": [6, 12, 15], "load": [1, 12, 13, 15, 17], "on_volume_begin": [12, 15], "muon_batch": [12, 15], "n_mu_per_volum": [12, 15], "mu_b": [12, 15], "on_mu_batch_begin": [12, 15], "irradi": [12, 15], "on_scatter_end": [12, 15], "on_mu_batch_end": [12, 15], "on_x0_pred_begin": [12, 15], "overal": [12, 14, 15], "on_x0_pred_end": [6, 12, 15], "cost": [1, 12, 14, 15, 17], "add": [1, 12, 14, 15, 17], "on_volume_batch_end": [6, 12, 15], "on_backwards_begin": [12, 15], "backpropag": [6, 12, 15], "on_backwards_end": [6, 12, 15], "viii": [12, 15], "ensur": [1, 12, 15, 17], "physic": [12, 15, 17], "absdetectorlay": [12, 15, 17], "conform_detector": [12, 15, 17], "viv": [12, 15], "len": [12, 15], "break": [12, 15], "on_epoch_end": [12, 15], "val_pass": [12, 15], "on_train_end": [12, 15], "yet": [6, 12], "begin": [6, 12, 17], "end": [6, 12], "on_pred_begin": 12, "mode": [12, 15, 17], "on_pred_end": 12, "finish": 12, "latest": 12, "on_step_end": 12, "layout": [6, 12, 13, 17], "on_volume_end": 12, "befor": [1, 6, 12], "cycliccallback": [12, 15], "muonresampl": 12, "resampl": 12, "impact": 12, "check_mu_batch": 12, "determin": [12, 13], "prior": [12, 14, 17], "realist": 12, "gen": 12, "until": [12, 15], "gener": [0, 1, 2, 12, 13, 15, 17], "replac": 12, "hitrecord": [12, 16], "scatterrecord": [12, 16], "get_record": [12, 16], "plot_hit_dens": [12, 16], "distinct": 12, "_to_df": [], "save": [9, 12, 15, 16], "panda": 12, "datafram": [12, 16], "insid": [1, 12, 17], "plot_scatter_dens": [12, 16], "_reset": [], "prepar": [12, 17], "as_df": 12, "access": [1, 12], "evalmetr": [12, 15], "lower_metric_bett": 12, "name": [6, 12, 13, 15], "main_metr": 12, "metric": 12, "metriclogg": [12, 15], "live": 12, "feedback": 12, "main": [12, 17], "better": [12, 17], "get_metr": 12, "nomorenan": 12, "introduc": [1, 12], "need": [1, 12, 14, 15, 17], "heatmapgif": 12, "gif_filenam": 12, "heatmap": 12, "gif": 12, "savenam": [9, 12, 15, 16], "savepath": 12, "_create_gif": [], "imag": 12, "_plot_curr": [], "optimisation_histori": 12, "gif_length": 12, "10": [1, 6, 7, 12, 14, 17], "show_plot": 12, "show": [1, 12], "varieti": 12, "help": 12, "highlight": 12, "problem": [0, 2, 12], "hyper": 12, "without": 12, "print": [12, 14], "histori": 12, "get_loss_histori": 12, "addition": [0, 2, 12], "control": [1, 12, 14], "second": 12, "notebook": [12, 17], "_build_grid_spec": [], "gridspec": [], "snapshot": 12, "_prep_plot": [], "_snapshot_monitor": [], "cat_palett": 12, "tab10": 12, "get": [1, 12], "get_result": 12, "loaded_best": 12, "h_mid": 12, "8": [6, 8, 12, 14], "lbl_col": 12, "black": 12, "lbl_sz": 12, "24": 12, "leg_sz": 12, "16": 12, "info": [1, 12], "clean": 12, "grab": 12, "sub": [12, 17], "print_loss": 12, "rc": 12, "patch": 12, "edgecolor": 12, "whitegrid": 12, "tk_col": 12, "tk_sz": 12, "update_plot": 12, "w_mid": 12, "14": 12, "222222222222221": 12, "panelmetriclogg": 12, "logger": 12, "_set_axes_label": [], "clear": [], "onecycl": 12, "opt_nam": 12, "warmup_length": 12, "init_lr": 12, "init_mom": 12, "mid_lr": 12, "mid_mom": 12, "final_lr": 12, "final_mom": 12, "absoptschedul": 12, "smith": 12, "cycl": 12, "evolut": 12, "lr": [12, 15], "beta_1": [12, 15], "org": [1, 12], "ab": 12, "1803": 12, "09820": 12, "warmup": 12, "phase": 12, "learn": [12, 15, 17], "rate": [12, 15, 17], "decreas": [12, 15, 17], "stabilis": 12, "converg": 12, "instanti": [12, 15, 17], "argument": 12, "anneal": [12, 17], "affect": [12, 17], "schedul": 12, "low": [12, 17], "nomin": [12, 17], "moder": 12, "_activ": [], "inter_cnt": [], "predhandl": [12, 15], "collect": [0, 2, 12], "numpi": 12, "get_pr": [12, 15], "save2hdf5predhandl": 12, "path": [1, 9, 12, 15], "use_volume_target": 12, "overwrit": 12, "compress": 12, "lzf": 12, "volumetargetpredhandl": 12, "hdf5": [1, 12], "cach": 12, "written": 12, "increment": 12, "lookup": [12, 17], "exist": 12, "same": [9, 12, 13, 14, 17], "string": [12, 15, 17], "_open_fil": [], "_write_data": [], "costcoefwarmup": 12, "n_warmup": 12, "warmupcallback": [12, 15], "more": [12, 16, 17], "stabl": 12, "absdetectorloss": [12, 14, 15], "sever": [0, 2, 12, 15], "warm": 12, "kept": 12, "fix": [12, 13, 15, 17], "wait": 12, "activ": 12, "enough": 12, "past": 12, "median": 12, "paneloptconfig": [], "xy_pos_r": 12, "z_pos_rat": 12, "xy_span_r": 12, "budget_r": [], "desir": 12, "step": [12, 17], "cours": 12, "suitabl": 12, "panel": [12, 15], "expand": [], "fraction": [15, 17], "budget": [14, 15, 17], "postwarmupcallback": 12, "obejct": 12, "check_warmup": 12, "act": [12, 17], "prevent": 12, "flag": 12, "warmup_act": 12, "super": 12, "next": [12, 17], "skip": 12, "unset": 12, "panelupdatelimit": 12, "max_xy_step": 12, "max_z_step": 12, "max_xy_span_step": 12, "maximum": [12, 13, 17], "being": [12, 14, 17], "anomol": 12, "enact": 12, "hard": 12, "clamp": 12, "xy_span": [12, 17], "paramat": 12, "goe": 12, "sigmoidpanelsmoothnessschedul": [12, 17], "smooth_rang": 12, "smooth": [6, 12, 17], "sigmoiddetectorpanel": [12, 17], "unphys": 12, "sensit": [12, 17], "outsid": [12, 17], "edg": [12, 17], "close": [12, 14], "resembl": 12, "still": [1, 12], "A": [1, 12, 13, 14, 15, 17], "appropri": [], "come": [], "_set_smooth": [], "At": 12, "detectorheatmap": [15, 17], "re": [6, 7, 17], "init_xyz": 17, "init_xy_span": 17, "m2_cost": 17, "realistic_valid": 17, "n_cluster": 17, "30": 17, "_backward_hook": [], "_buffer": [], "_forward_hook": [], "_forward_pre_hook": [], "_is_full_backward_hook": [], "_load_state_dict_post_hook": [], "_load_state_dict_pre_hook": [], "_modul": [], "_non_persistent_buffers_set": [], "_paramet": [], "_state_dict_hook": [], "assign_budget": 17, "clamp_param": 17, "musigz_low": 17, "musigz_high": 17, "get_cost": 17, "get_effici": 17, "as_2d": 17, "get_resolut": 17, "plot_map": 17, "bpixel": 17, "bsavefig": 17, "filenam": 17, "abslay": 17, "oper": 17, "_n_cost": 17, "learnabl": 17, "how": [1, 14, 17], "type_label": 17, "encod": [14, 17], "extra": 17, "pure": 17, "togeth": [13, 17], "span": [6, 7, 17], "meter": 17, "ax": 17, "divis": 17, "correctli": [1, 17], "relat": [14, 17], "proper": 17, "determinist": 17, "currenc": [14, 17], "lie": 17, "etc": 17, "forward": [1, 14, 17], "get_lw_z_siz": 17, "detectorpanel": [15, 17], "modulelist": [6, 17], "zeroth": [12, 13, 14, 17], "highest": 17, "necessarili": 17, "investig": 17, "bound": 17, "get_devic": 17, "helper": 17, "rais": 17, "get_panel_zord": 17, "rad_length": 17, "yield_zordered_panel": 17, "yield": [13, 17], "iter": [1, 15, 17], "passivelay": 17, "rad_length_func": 17, "step_sz": 17, "01": 17, "pgeant": [1, 17], "develop": 17, "parameteris": 17, "geant": [1, 17], "radiat": 17, "n_x": 17, "n_y": 17, "exampl": [0, 12, 14, 17], "def": 17, "arb_rad_length": 17, "torch": 17, "ones": [12, 14, 17], "lead": 17, "beryllium": 17, "later": 17, "load_rad_length": 17, "select": [14, 17], "travers": [], "_pdg_scatter": [], "log_term": [], "euler": [], "rotat": 17, "matric": [], "convers": 1, "_pgeant_scatt": [], "abs2idx": 17, "possibl": [14, 17], "seri": 17, "mu_abs2idx": 17, "look": 17, "scatter_and_propag": 17, "prespecifi": 17, "neighbour": 17, "infinit": 17, "thin": 17, "rectangular": 17, "despit": [14, 17], "nn": 17, "continu": [1, 17], "2d": [16, 17], "across": 17, "decid": 17, "evalu": [0, 2, 14, 15, 17], "eval": 17, "area": 17, "learnt": 17, "effect": [12, 17], "now": [1, 17], "aspect": [14, 15, 17], "improv": [9, 17], "resiz": 17, "meet": 17, "interpret": [1, 14, 17], "budget_scal": 17, "match": [14, 17], "xyz_low": 17, "xyz_high": 17, "20": 17, "random": [13, 17], "1e": 17, "subtract": 17, "min": 17, "max": 17, "doesn": 17, "overlap": 17, "overridden": [13, 17], "subclass": 17, "although": 17, "recip": 17, "former": 17, "regist": 17, "hook": 17, "while": 17, "silent": 17, "ignor": 17, "pre": [1, 13, 15, 17], "get_gauss": 17, "distribut": [0, 2, 17], "interact": [1, 17], "consist": [0, 2, 14, 17], "reconstruct": 17, "get_scaled_xy_span": 17, "xy2": 17, "li": 17, "border": 17, "slower": [14, 17], "wherea": 17, "transit": 17, "strongli": 17, "approxim": 17, "sig_model": 17, "interfac": 17, "conveni": 17, "respons": 17, "optim": [15, 17], "could": [9, 17], "volumeclassloss": [14, 17], "front": 17, "zxy": 17, "corner": 17, "support": [1, 15, 17], "spars": 17, "_check_pass": [], "_configure_budget": [], "budget_weight": [], "explicit": [], "hierarchi": [], "thu": [], "_n_layer_cost": 17, "softmax": [14, 17], "normalis": [14, 15, 17], "slice": 17, "taken": 17, "_get_devic": [], "system": [0, 1, 2, 17], "amongst": 17, "build_edg": [], "draw": 17, "xlim": 17, "ylim": 17, "zlim": 17, "pertain": 17, "jupyt": [1, 17], "matplotlib": 17, "you": [0, 1, 2, 17], "dimension": 17, "turn": 17, "won": 17, "explicitli": 17, "get_detector": [15, 17], "get_passive_z_rang": 17, "get_pass": 17, "get_rad_cub": [14, 17], "h": [6, 17], "lookup_passive_xyz_coord": 17, "passive_s": 17, "public": [0, 1, 2], "ssh": 1, "your": 1, "github": 1, "profil": [], "follow": [], "instruct": [], "checkout": [], "packag": 3, "git": 1, "gilesstrong": 1, "mode_muon_tomographi": [], "gpu": [], "setup": [], "conda": [], "pytorch": [], "nb_conda_kernel": [], "tomopt": [1, 2], "python": 1, "pip": 1, "ipykernel": [], "cu111": [], "f": 1, "download": 1, "whl": [], "torch_stabl": [], "html": [], "txt": [], "virtual": 1, "environ": 1, "anaconda": [], "miniconda": [], "rememb": [], "restart": [], "shell": [], "attemt": [], "command": 1, "bashrc": [], "env": [], "yml": [], "choic": [], "content": [], "commit": 1, "appar": [], "ipython": [], "displai": [], "pytest": 1, "pull": [], "ran": [], "local": 1, "test_muon": [], "py": [], "tomo_deepinf": 1, "contact": [0, 1, 2], "definit": [0, 1, 2], "gnn": 1, "export": 1, "jit": 1, "trace": 1, "script": 1, "deepvolumeinfer": 1, "we": [0, 1, 2], "find": 1, "host": 1, "easi": [0, 1, 2], "mode_muon_tomography_scatt": 1, "csv": 1, "tomopt_sphinx_them": 1, "appear": 1, "doc": [1, 14], "project": 1, "peopl": 1, "contribut": 1, "summaris": 1, "ladle_furnac": 5, "small_wal": 5, "u_lorri": 5, "ladlefurnacepassivegener": 6, "x0_furnac": 6, "01782": 6, "fill_materi": 6, "hot": 6, "liquid": 6, "steel": [1, 6], "slag_materi": 6, "slag": 6, "abspassivegener": [6, 7, 8, 13], "research": [0, 2, 6, 8], "edgedetladlefurnacefilllevelinferr": 6, "pipelin": 6, "remove_ladl": 6, "avg_3d": 6, "avg_lay": 6, "avg_1d": 6, "ridge_1d_0": 6, "max_div_min": 6, "add_batch_dim": 6, "edge_det": 6, "gauss_1d": 6, "gauss_3d": 6, "laplacian_1d": 6, "max_sub_min": 6, "prewit_1d": 6, "ladl": [1, 6], "thick": 6, "ridge_1d_2": 6, "ridge_1d_4": 6, "ridge_1d_8": 6, "linearcorrectioncallback": 6, "partial_opt": [6, 15], "init_weight": 6, "init_bia": 6, "pocazladlefurnacefilllevelinferr": 6, "fill": [1, 6, 14], "heigh": 6, "pred_height": 6, "ladlefurnaceintclassloss": 6, "pred_int_start": [6, 14], "use_ms": [6, 14], "target_budget": [6, 14], "budget_smooth": [6, 14], "cost_coef": [6, 14], "steep_budget": [6, 14], "debug": [6, 14], "volumeintclassloss": [6, 14], "spreadrangeloss": 6, "compare_init_optimised_2": 6, "df_start": 6, "df_opt_2": 6, "compare_init_to_optimis": 6, "df_opt": 6, "compare_optimised_to_baselin": 6, "df_bl_1": 6, "df_bl_2": 6, "compare_raw_init_to_bias_corrected_init": 6, "get_baseline_detector_1": 6, "9": 6, "get_baseline_detector_2": 6, "get_initial_detector": 6, "smallwallspassivegener": 7, "x0_soil": 7, "2624248696430881": 7, "x0_wall": 7, "08022522418503258": 7, "stop_k": 7, "turn_k": 7, "min_length": 7, "min_height": 7, "get_small_walls_volum": 7, "passive_lwh": 7, "det_height": 7, "get_small_walls_volume_wrapp": 7, "panelvolumewrapp": [7, 15], "ulorrypassivegener": 8, "u_volum": 8, "u_prob": 8, "fill_frac": 8, "x0_lorri": 8, "01757": 8, "bkg_materi": 8, "air": 8, "iron": 8, "figur": 9, "cdf": 9, "precomput": 9, "prob": 9, "tripl": 9, "rtype": 17, "refactor": 9, "panelcentr": 12, "epochsav": 12, "uniqu": 12, "specifc": 12, "resum": 12, "iter_cnt": 12, "optconfig": 12, "nor": 12, "sgd": 12, "opt": [12, 15], "param_group": 12, "param": 12, "impli": 12, "xy_pos_opt": [12, 15], "z_pos_opt": [12, 15], "xy_span_opt": [12, 15], "absblockpassivegener": 13, "block_siz": 13, "block_size_max_half": 13, "cuboid": 13, "_gener": 13, "get_data": 13, "randomli": 13, "orient": 13, "half": 13, "known": 13, "radlengthfunc": 13, "blockpresentpassivegener": 13, "potenti": 13, "passiveyield": [13, 15], "n_passiv": 13, "shuffl": 13, "dataset": 13, "randomblockpassivegener": 13, "sort_x0": 13, "enforce_diff_mat": 13, "unless": 13, "voxelpassivegener": 13, "quantifi": 14, "characteris": 14, "import": 14, "ideal": 14, "task": [0, 2, 14], "algorithm": [0, 2, 14], "gradual": 14, "predefin": 14, "rapidli": 14, "smoothli": 14, "Be": 14, "linearli": 14, "exceed": 14, "less": 14, "steep": 14, "flatten": 14, "slightli": 14, "_get_inference_loss": 14, "quickli": 14, "rise": 14, "veri": 14, "whenev": 14, "absmaterialclassloss": 14, "classifi": 14, "what": [1, 14], "multi": 14, "cross": 14, "entropi": 14, "nll": 14, "bce": 14, "targ2int": 14, "treatabl": 14, "just": [1, 14], "categor": 14, "integer_class_loss": 14, "icl": 14, "volumemseloss": 14, "voxelclassloss": 14, "voxelx0loss": 14, "mse": 14, "int_prob": 14, "target_int": 14, "pred_start_int": 14, "reduct": 14, "regress": 14, "applic": 14, "realli": 14, "like": 14, "aim": [1, 14], "penalis": 14, "produc": [14, 16], "0154": 14, "greater": 14, "0007": 14, "8773": 14, "unreduc": 14, "loss_func": 15, "partial_scatter_inferr": 15, "partial_volume_inferr": 15, "mu_gener": 15, "_build_opt": 15, "qualiti": 15, "life": 15, "val_loss": 15, "broken": 15, "_fit_epoch": 15, "_scan_volum": 15, "mechan": 15, "abl": 15, "awar": 15, "uninitialis": 15, "plan": 15, "cb": 15, "cb_savepath": 15, "train_weight": 15, "count": 15, "reach": 15, "get_opt_lr": 15, "get_opt_mom": 15, "get_param_count": 15, "trainabl": 15, "pred_cb": 15, "pred_callback": 15, "set_opt_lr": 15, "set_opt_mom": 15, "arbvolumewrapp": 15, "arbitrari": 15, "whatev": 15, "paramt": 15, "from_sav": 15, "kwarg": 15, "cyclic_cb": 15, "epoch_bar": 15, "progressbar": 15, "loss_val": 15, "mean_loss": 15, "metric_cb": 15, "metric_log": 15, "passive_bar": 15, "nbprogressbar": 15, "consoleprogressbar": 15, "sb": 15, "skip_opt_step": 15, "stop": 15, "tst_passiv": 15, "volume_id": 15, "volume_inferr": 15, "warmup_cb": 15, "heatmapvolumewrapp": 15, "mu_opt": 15, "norm_opt": 15, "sig_opt": 15, "adjust": 15, "budget_opt": 15, "hit_df": 16, "scatter_df": 16, "plot_pred_true_x0": 16, "revis": 16, "intuit": 16, "build_xyz_edg": 17, "xyz_centr": 17, "xyz_edg": 17, "librari": [0, 1, 2], "our": [0, 1, 2], "disclaim": [0, 1, 2], "specif": [0, 2], "unstabl": [0, 2], "tune": [0, 2], "sai": [0, 2], "polish": [0, 2], "fellow": [0, 2], "field": [0, 2], "interest": [0, 2], "serious": [0, 2], "u": [0, 2], "love": [0, 2], "wish": [0, 2], "geometri": [0, 2], "arriv": [0, 2], "ground": [0, 2], "truth": [0, 2], "modular": [0, 2], "easili": [0, 2], "extens": [0, 2], "constraint": [0, 2], "submodul": [0, 2], "ongo": [0, 2], "concret": [0, 2], "real": [0, 2], "world": [0, 2], "literatur": [0, 2], "util": [0, 2], "visualis": [0, 2], "throughout": [0, 2], "codebas": [0, 2], "usag": 1, "poetri": 1, "offici": 1, "curl": 1, "ssl": 1, "python3": 1, "self": 1, "pyenv": 1, "bash": 1, "plugin": 1, "config": 1, "everyth": 1, "unfamiliar": 1, "prepend": 1, "stuff": 1, "execut": 1, "tomographi": 2, "few": 1, "getting_start": 1, "four": 1, "00_hello_world": 1, "ipynb": 1, "workflow": 1, "01_indepth_tutorial_single_cycl": 1, "go": 1, "02_indepth_tutotial_optimisation_and_callback": 1, "03_fixed_budget_mod": 1, "maintain": 1, "cover": 1, "furnac": 1, "plant": 1, "fulli": 1, "reproduc": 1, "manner": 1, "experienc": 1, "want": 1, "browser": 1, "machin": 1, "server": 1, "On": 1, "port": 1, "8889": 1, "pick": 1, "anoth": 1, "l": 1, "localhost": 1, "8888": 1, "usernam": 1, "cluster_hostnam": 1, "layperson": 1, "tree": 1, "ask": 1, "authent": 1, "token": 1, "shown": 1, "intermedi": 1, "gatewai": 1, "similar": 1, "crucial": 1, "chain": 1, "8890": 1, "gateway_hostnam": 1}, "objects": {"tomopt.benchmarks.ladle_furnace": [[6, 0, 0, "-", "data"], [6, 0, 0, "-", "inference"], [6, 0, 0, "-", "loss"], [6, 0, 0, "-", "plotting"], [6, 0, 0, "-", "volume"]], "tomopt.benchmarks.ladle_furnace.data": [[6, 1, 1, "", "LadleFurnacePassiveGenerator"]], "tomopt.benchmarks.ladle_furnace.inference": [[6, 1, 1, "", "EdgeDetLadleFurnaceFillLevelInferrer"], [6, 1, 1, "", "LinearCorrectionCallback"], [6, 1, 1, "", "PocaZLadleFurnaceFillLevelInferrer"]], "tomopt.benchmarks.ladle_furnace.inference.EdgeDetLadleFurnaceFillLevelInferrer": [[6, 2, 1, "", "avg_1d"], [6, 2, 1, "", "avg_3d"], [6, 2, 1, "", "avg_layers"], [6, 2, 1, "", "edge_det"], [6, 2, 1, "", "gauss_1d"], [6, 2, 1, "", "gauss_3d"], [6, 2, 1, "", "laplacian_1d"], [6, 2, 1, "", "max_div_min"], [6, 2, 1, "", "max_sub_min"], [6, 2, 1, "", "negative"], [6, 2, 1, "", "prewit_1d"], [6, 2, 1, "", "remove_ladle"], [6, 2, 1, "", "ridge_1d_0"], [6, 2, 1, "", "ridge_1d_2"], [6, 2, 1, "", "ridge_1d_4"], [6, 2, 1, "", "ridge_1d_8"], [6, 2, 1, "", "x02probs"]], "tomopt.benchmarks.ladle_furnace.inference.LinearCorrectionCallback": [[6, 2, 1, "", "on_backwards_end"], [6, 2, 1, "", "on_train_begin"], [6, 2, 1, "", "on_volume_batch_begin"], [6, 2, 1, "", "on_x0_pred_end"]], "tomopt.benchmarks.ladle_furnace.inference.PocaZLadleFurnaceFillLevelInferrer": [[6, 2, 1, "", "compute_efficiency"], [6, 2, 1, "", "get_prediction"], [6, 3, 1, "", "muon_efficiency"], [6, 3, 1, "", "muon_poca_xyz"], [6, 3, 1, "", "muon_poca_xyz_unc"], [6, 3, 1, "", "n_mu"], [6, 3, 1, "", "pred_height"], [6, 3, 1, "", "smooth"]], "tomopt.benchmarks.ladle_furnace.loss": [[6, 1, 1, "", "LadleFurnaceIntClassLoss"], [6, 1, 1, "", "SpreadRangeLoss"]], "tomopt.benchmarks.ladle_furnace.loss.SpreadRangeLoss": [[6, 2, 1, "", "on_volume_batch_begin"], [6, 2, 1, "", "on_volume_batch_end"], [6, 2, 1, "", "on_x0_pred_end"]], "tomopt.benchmarks.ladle_furnace.plotting": [[6, 4, 1, "", "compare_init_optimised_2"], [6, 4, 1, "", "compare_init_to_optimised"], [6, 4, 1, "", "compare_optimised_to_baselines"], [6, 4, 1, "", "compare_raw_init_to_bias_corrected_init"]], "tomopt.benchmarks.ladle_furnace.volume": [[6, 4, 1, "", "get_baseline_detector_1"], [6, 4, 1, "", "get_baseline_detector_2"], [6, 4, 1, "", "get_initial_detector"]], "tomopt.benchmarks.small_walls": [[7, 0, 0, "-", "data"], [7, 0, 0, "-", "volume"]], "tomopt.benchmarks.small_walls.data": [[7, 1, 1, "", "SmallWallsPassiveGenerator"]], "tomopt.benchmarks.small_walls.volume": [[7, 4, 1, "", "get_small_walls_volume"], [7, 4, 1, "", "get_small_walls_volume_wrapper"]], "tomopt.benchmarks.u_lorry": [[8, 0, 0, "-", "data"]], "tomopt.benchmarks.u_lorry.data": [[8, 1, 1, "", "ULorryPassiveGenerator"]], "tomopt": [[4, 0, 0, "-", "core"], [4, 0, 0, "-", "utils"], [4, 0, 0, "-", "version"]], "tomopt.inference": [[9, 0, 0, "-", "scattering"], [9, 0, 0, "-", "volume"]], "tomopt.inference.scattering": [[9, 1, 1, "", "GenScatterBatch"], [9, 1, 1, "", "ScatterBatch"]], "tomopt.inference.scattering.ScatterBatch": [[9, 3, 1, "", "above_gen_hits"], [9, 3, 1, "", "above_hit_effs"], [9, 3, 1, "", "above_hit_uncs"], [9, 3, 1, "", "above_hits"], [9, 3, 1, "", "below_gen_hits"], [9, 3, 1, "", "below_hit_effs"], [9, 3, 1, "", "below_hit_uncs"], [9, 3, 1, "", "below_hits"], [9, 3, 1, "", "dphi"], [9, 3, 1, "", "dphi_unc"], [9, 3, 1, "", "dtheta"], [9, 3, 1, "", "dtheta_unc"], [9, 3, 1, "", "dtheta_xy"], [9, 3, 1, "", "dtheta_xy_unc"], [9, 3, 1, "", "dxy"], [9, 3, 1, "", "dxy_unc"], [9, 3, 1, "", "gen_hits"], [9, 2, 1, "", "get_muon_trajectory"], [9, 2, 1, "", "get_scatter_mask"], [9, 3, 1, "", "hit_effs"], [9, 3, 1, "", "hit_uncs"], [9, 3, 1, "", "hits"], [9, 3, 1, "", "n_hits_above"], [9, 3, 1, "", "n_hits_below"], [9, 3, 1, "", "phi_in"], [9, 3, 1, "", "phi_in_unc"], [9, 3, 1, "", "phi_out"], [9, 3, 1, "", "phi_out_unc"], [9, 2, 1, "", "plot_scatter"], [9, 3, 1, "", "poca_xyz"], [9, 3, 1, "", "poca_xyz_unc"], [9, 3, 1, "", "reco_hits"], [9, 3, 1, "", "theta_in"], [9, 3, 1, "", "theta_in_unc"], [9, 3, 1, "", "theta_msc"], [9, 3, 1, "", "theta_msc_unc"], [9, 3, 1, "", "theta_out"], [9, 3, 1, "", "theta_out_unc"], [9, 3, 1, "", "theta_xy_in"], [9, 3, 1, "", "theta_xy_in_unc"], [9, 3, 1, "", "theta_xy_out"], [9, 3, 1, "", "theta_xy_out_unc"], [9, 3, 1, "", "total_scatter"], [9, 3, 1, "", "total_scatter_unc"], [9, 3, 1, "", "track_in"], [9, 3, 1, "", "track_out"], [9, 3, 1, "", "track_start_in"], [9, 3, 1, "", "track_start_out"], [9, 3, 1, "", "xyz_in"], [9, 3, 1, "", "xyz_in_unc"], [9, 3, 1, "", "xyz_out"], [9, 3, 1, "", "xyz_out_unc"]], "tomopt.inference.volume": [[9, 1, 1, "", "AbsIntClassifierFromX0"], [9, 1, 1, "", "AbsVolumeInferrer"], [9, 1, 1, "", "AbsX0Inferrer"], [9, 1, 1, "", "DenseBlockClassifierFromX0s"], [9, 1, 1, "", "PanelX0Inferrer"]], "tomopt.inference.volume.AbsIntClassifierFromX0": [[9, 2, 1, "", "add_scatters"], [9, 2, 1, "", "compute_efficiency"], [9, 2, 1, "", "get_prediction"], [9, 2, 1, "", "x02probs"]], "tomopt.inference.volume.AbsVolumeInferrer": [[9, 2, 1, "", "add_scatters"], [9, 2, 1, "", "compute_efficiency"], [9, 2, 1, "", "get_prediction"]], "tomopt.inference.volume.AbsX0Inferrer": [[9, 2, 1, "", "get_prediction"], [9, 3, 1, "", "muon_efficiency"], [9, 3, 1, "", "muon_mom"], [9, 3, 1, "", "muon_mom_unc"], [9, 3, 1, "", "muon_poca_xyz"], [9, 3, 1, "", "muon_poca_xyz_unc"], [9, 3, 1, "", "muon_probs_per_voxel_zxy"], [9, 3, 1, "", "muon_theta_in"], [9, 3, 1, "", "muon_theta_in_unc"], [9, 3, 1, "", "muon_theta_out"], [9, 3, 1, "", "muon_theta_out_unc"], [9, 3, 1, "", "muon_total_scatter"], [9, 3, 1, "", "muon_total_scatter_unc"], [9, 3, 1, "", "n_mu"], [9, 3, 1, "", "vox_zxy_x0_pred_uncs"], [9, 3, 1, "", "vox_zxy_x0_preds"], [9, 2, 1, "", "x0_from_scatters"]], "tomopt.inference.volume.DenseBlockClassifierFromX0s": [[9, 2, 1, "", "add_scatters"], [9, 2, 1, "", "compute_efficiency"], [9, 2, 1, "", "get_prediction"]], "tomopt.inference.volume.PanelX0Inferrer": [[9, 2, 1, "", "compute_efficiency"]], "tomopt.muon": [[10, 0, 0, "-", "generation"], [10, 0, 0, "-", "muon_batch"]], "tomopt.muon.generation": [[10, 1, 1, "", "AbsMuonGenerator"], [10, 1, 1, "", "MuonGenerator2015"], [10, 1, 1, "", "MuonGenerator2016"]], "tomopt.muon.generation.AbsMuonGenerator": [[10, 2, 1, "", "flux"], [10, 2, 1, "", "from_volume"], [10, 2, 1, "", "generate_set"]], "tomopt.muon.generation.MuonGenerator2015": [[10, 5, 1, "", "P1"], [10, 5, 1, "", "P2"], [10, 5, 1, "", "P3"], [10, 5, 1, "", "P4"], [10, 5, 1, "", "P5"], [10, 2, 1, "", "flux"]], "tomopt.muon.generation.MuonGenerator2016": [[10, 5, 1, "", "E_0"], [10, 5, 1, "", "E_c"], [10, 5, 1, "", "I_0"], [10, 5, 1, "", "N"], [10, 5, 1, "", "Rod"], [10, 5, 1, "", "epinv"], [10, 2, 1, "", "flux"], [10, 5, 1, "", "n"]], "tomopt.muon.muon_batch": [[10, 1, 1, "", "MuonBatch"]], "tomopt.muon.muon_batch.MuonBatch": [[10, 2, 1, "", "append_hits"], [10, 2, 1, "", "copy"], [10, 2, 1, "", "dtheta"], [10, 2, 1, "", "dtheta_x"], [10, 2, 1, "", "dtheta_y"], [10, 2, 1, "", "filter_muons"], [10, 2, 1, "", "get_hits"], [10, 2, 1, "", "get_xy_mask"], [10, 3, 1, "", "mom"], [10, 3, 1, "", "muons"], [10, 5, 1, "", "p_dim"], [10, 5, 1, "", "ph_dim"], [10, 3, 1, "", "phi"], [10, 2, 1, "", "phi_from_theta_xy"], [10, 2, 1, "", "propagate_d"], [10, 2, 1, "", "propagate_dz"], [10, 3, 1, "", "reco_mom"], [10, 2, 1, "", "remove_upwards_muons"], [10, 2, 1, "", "scatter_dtheta_dphi"], [10, 2, 1, "", "scatter_dtheta_xy"], [10, 2, 1, "", "scatter_dxyz"], [10, 2, 1, "", "snapshot_xyz"], [10, 5, 1, "", "th_dim"], [10, 3, 1, "", "theta"], [10, 2, 1, "", "theta_from_theta_xy"], [10, 3, 1, "", "theta_x"], [10, 2, 1, "", "theta_x_from_theta_phi"], [10, 3, 1, "", "theta_xy"], [10, 3, 1, "", "theta_y"], [10, 2, 1, "", "theta_y_from_theta_phi"], [10, 3, 1, "", "upwards_muons"], [10, 3, 1, "", "x"], [10, 5, 1, "", "x_dim"], [10, 3, 1, "", "xy"], [10, 3, 1, "", "xyz"], [10, 3, 1, "", "xyz_hist"], [10, 3, 1, "", "y"], [10, 5, 1, "", "y_dim"], [10, 3, 1, "", "z"], [10, 5, 1, "", "z_dim"]], "tomopt.optimisation.callbacks": [[12, 0, 0, "-", "callback"], [12, 0, 0, "-", "cyclic_callbacks"], [12, 0, 0, "-", "data_callbacks"], [12, 0, 0, "-", "detector_callbacks"], [12, 0, 0, "-", "diagnostic_callbacks"], [12, 0, 0, "-", "eval_metric"], [12, 0, 0, "-", "grad_callbacks"], [12, 0, 0, "-", "heatmap_gif"], [12, 0, 0, "-", "monitors"], [12, 0, 0, "-", "opt_callbacks"], [12, 0, 0, "-", "pred_callbacks"], [12, 0, 0, "-", "warmup_callbacks"]], "tomopt.optimisation.callbacks.callback": [[12, 1, 1, "", "Callback"]], "tomopt.optimisation.callbacks.callback.Callback": [[12, 2, 1, "", "on_backwards_begin"], [12, 2, 1, "", "on_backwards_end"], [12, 2, 1, "", "on_epoch_begin"], [12, 2, 1, "", "on_epoch_end"], [12, 2, 1, "", "on_mu_batch_begin"], [12, 2, 1, "", "on_mu_batch_end"], [12, 2, 1, "", "on_pred_begin"], [12, 2, 1, "", "on_pred_end"], [12, 2, 1, "", "on_scatter_end"], [12, 2, 1, "", "on_step_end"], [12, 2, 1, "", "on_train_begin"], [12, 2, 1, "", "on_train_end"], [12, 2, 1, "", "on_volume_batch_begin"], [12, 2, 1, "", "on_volume_batch_end"], [12, 2, 1, "", "on_volume_begin"], [12, 2, 1, "", "on_volume_end"], [12, 2, 1, "", "on_x0_pred_begin"], [12, 2, 1, "", "on_x0_pred_end"], [12, 2, 1, "", "set_wrapper"], [12, 5, 1, "", "wrapper"]], "tomopt.optimisation.callbacks.cyclic_callbacks": [[12, 1, 1, "", "CyclicCallback"]], "tomopt.optimisation.callbacks.data_callbacks": [[12, 1, 1, "", "MuonResampler"]], "tomopt.optimisation.callbacks.data_callbacks.MuonResampler": [[12, 2, 1, "", "check_mu_batch"], [12, 2, 1, "", "on_mu_batch_begin"], [12, 2, 1, "", "resample"]], "tomopt.optimisation.callbacks.detector_callbacks": [[12, 1, 1, "", "PanelCentring"], [12, 1, 1, "", "PanelUpdateLimiter"], [12, 1, 1, "", "SigmoidPanelSmoothnessSchedule"]], "tomopt.optimisation.callbacks.detector_callbacks.PanelCentring": [[12, 2, 1, "", "on_step_end"]], "tomopt.optimisation.callbacks.detector_callbacks.PanelUpdateLimiter": [[12, 2, 1, "", "on_backwards_end"], [12, 2, 1, "", "on_step_end"]], "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule": [[12, 2, 1, "", "on_epoch_begin"], [12, 2, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.diagnostic_callbacks": [[12, 1, 1, "", "HitRecord"], [12, 1, 1, "", "ScatterRecord"]], "tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord": [[12, 2, 1, "", "on_scatter_end"]], "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord": [[12, 2, 1, "", "get_record"], [12, 2, 1, "", "on_pred_begin"], [12, 2, 1, "", "on_scatter_end"], [12, 2, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.eval_metric": [[12, 1, 1, "", "EvalMetric"]], "tomopt.optimisation.callbacks.eval_metric.EvalMetric": [[12, 2, 1, "", "get_metric"], [12, 2, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.grad_callbacks": [[12, 1, 1, "", "NoMoreNaNs"]], "tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs": [[12, 2, 1, "", "on_backwards_end"]], "tomopt.optimisation.callbacks.heatmap_gif": [[12, 1, 1, "", "HeatMapGif"]], "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif": [[12, 2, 1, "", "on_epoch_begin"], [12, 2, 1, "", "on_train_begin"], [12, 2, 1, "", "on_train_end"]], "tomopt.optimisation.callbacks.monitors": [[12, 1, 1, "", "MetricLogger"], [12, 1, 1, "", "PanelMetricLogger"]], "tomopt.optimisation.callbacks.monitors.MetricLogger": [[12, 5, 1, "", "cat_palette"], [12, 2, 1, "", "get_loss_history"], [12, 2, 1, "", "get_results"], [12, 5, 1, "", "h_mid"], [12, 5, 1, "", "lbl_col"], [12, 5, 1, "", "lbl_sz"], [12, 5, 1, "", "leg_sz"], [12, 2, 1, "", "on_backwards_end"], [12, 2, 1, "", "on_epoch_begin"], [12, 2, 1, "", "on_epoch_end"], [12, 2, 1, "", "on_train_begin"], [12, 2, 1, "", "on_train_end"], [12, 2, 1, "", "on_volume_batch_end"], [12, 2, 1, "", "on_volume_end"], [12, 2, 1, "", "print_losses"], [12, 5, 1, "", "style"], [12, 5, 1, "", "tk_col"], [12, 5, 1, "", "tk_sz"], [12, 2, 1, "", "update_plot"], [12, 5, 1, "", "w_mid"]], "tomopt.optimisation.callbacks.monitors.PanelMetricLogger": [[12, 2, 1, "", "update_plot"]], "tomopt.optimisation.callbacks.opt_callbacks": [[12, 1, 1, "", "EpochSave"], [12, 1, 1, "", "OneCycle"]], "tomopt.optimisation.callbacks.opt_callbacks.EpochSave": [[12, 2, 1, "", "on_epoch_end"]], "tomopt.optimisation.callbacks.opt_callbacks.OneCycle": [[12, 2, 1, "", "on_epoch_end"], [12, 2, 1, "", "schedule"]], "tomopt.optimisation.callbacks.pred_callbacks": [[12, 1, 1, "", "PredHandler"], [12, 1, 1, "", "Save2HDF5PredHandler"], [12, 1, 1, "", "VolumeTargetPredHandler"]], "tomopt.optimisation.callbacks.pred_callbacks.PredHandler": [[12, 2, 1, "", "get_preds"], [12, 2, 1, "", "on_pred_begin"], [12, 2, 1, "", "on_x0_pred_end"]], "tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler": [[12, 2, 1, "", "on_x0_pred_end"]], "tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler": [[12, 2, 1, "", "on_x0_pred_end"]], "tomopt.optimisation.callbacks.warmup_callbacks": [[12, 1, 1, "", "CostCoefWarmup"], [12, 1, 1, "", "OptConfig"], [12, 1, 1, "", "PostWarmupCallback"], [12, 1, 1, "", "WarmupCallback"]], "tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup": [[12, 2, 1, "", "on_epoch_end"], [12, 2, 1, "", "on_volume_end"]], "tomopt.optimisation.callbacks.warmup_callbacks.OptConfig": [[12, 2, 1, "", "on_backwards_end"], [12, 2, 1, "", "on_epoch_end"]], "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback": [[12, 2, 1, "", "check_warmups"], [12, 2, 1, "", "on_epoch_begin"], [12, 2, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback": [[12, 2, 1, "", "check_warmups"], [12, 2, 1, "", "on_epoch_begin"], [12, 2, 1, "", "on_epoch_end"], [12, 2, 1, "", "on_train_begin"]], "tomopt.optimisation.data": [[13, 0, 0, "-", "passives"]], "tomopt.optimisation.data.passives": [[13, 1, 1, "", "AbsBlockPassiveGenerator"], [13, 1, 1, "", "AbsPassiveGenerator"], [13, 1, 1, "", "BlockPresentPassiveGenerator"], [13, 1, 1, "", "PassiveYielder"], [13, 1, 1, "", "RandomBlockPassiveGenerator"], [13, 1, 1, "", "VoxelPassiveGenerator"]], "tomopt.optimisation.data.passives.AbsPassiveGenerator": [[13, 2, 1, "", "generate"], [13, 2, 1, "", "get_data"]], "tomopt.optimisation.loss": [[14, 0, 0, "-", "loss"], [14, 0, 0, "-", "sub_losses"]], "tomopt.optimisation.loss.loss": [[14, 1, 1, "", "AbsDetectorLoss"], [14, 1, 1, "", "AbsMaterialClassLoss"], [14, 1, 1, "", "VolumeClassLoss"], [14, 1, 1, "", "VolumeIntClassLoss"], [14, 1, 1, "", "VolumeMSELoss"], [14, 1, 1, "", "VoxelClassLoss"], [14, 1, 1, "", "VoxelX0Loss"]], "tomopt.optimisation.loss.loss.AbsDetectorLoss": [[14, 2, 1, "", "forward"]], "tomopt.optimisation.loss.sub_losses": [[14, 4, 1, "", "integer_class_loss"]], "tomopt.optimisation.wrapper": [[15, 0, 0, "-", "volume_wrapper"]], "tomopt.optimisation.wrapper.volume_wrapper": [[15, 1, 1, "", "AbsVolumeWrapper"], [15, 1, 1, "", "ArbVolumeWrapper"], [15, 1, 1, "", "FitParams"], [15, 1, 1, "", "HeatMapVolumeWrapper"], [15, 1, 1, "", "PanelVolumeWrapper"]], "tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper": [[15, 2, 1, "", "fit"], [15, 2, 1, "", "get_detectors"], [15, 2, 1, "", "get_opt_lr"], [15, 2, 1, "", "get_opt_mom"], [15, 2, 1, "", "get_param_count"], [15, 2, 1, "", "load"], [15, 5, 1, "", "opts"], [15, 2, 1, "", "predict"], [15, 2, 1, "", "save"], [15, 2, 1, "", "set_opt_lr"], [15, 2, 1, "", "set_opt_mom"]], "tomopt.optimisation.wrapper.volume_wrapper.ArbVolumeWrapper": [[15, 2, 1, "", "from_save"]], "tomopt.optimisation.wrapper.volume_wrapper.FitParams": [[15, 5, 1, "", "cb_savepath"], [15, 5, 1, "", "cbs"], [15, 5, 1, "", "cyclic_cbs"], [15, 5, 1, "", "device"], [15, 5, 1, "", "epoch"], [15, 5, 1, "", "epoch_bar"], [15, 5, 1, "", "loss_val"], [15, 5, 1, "", "mean_loss"], [15, 5, 1, "", "metric_cbs"], [15, 5, 1, "", "metric_log"], [15, 5, 1, "", "mu"], [15, 5, 1, "", "mu_bs"], [15, 5, 1, "", "n_epochs"], [15, 5, 1, "", "n_mu_per_volume"], [15, 5, 1, "", "passive_bar"], [15, 5, 1, "", "passive_bs"], [15, 5, 1, "", "pred"], [15, 5, 1, "", "sb"], [15, 5, 1, "", "skip_opt_step"], [15, 5, 1, "", "state"], [15, 5, 1, "", "stop"], [15, 5, 1, "", "trn_passives"], [15, 5, 1, "", "tst_passives"], [15, 5, 1, "", "val_passives"], [15, 5, 1, "", "volume_id"], [15, 5, 1, "", "volume_inferrer"], [15, 5, 1, "", "warmup_cbs"]], "tomopt.optimisation.wrapper.volume_wrapper.HeatMapVolumeWrapper": [[15, 2, 1, "", "from_save"]], "tomopt.optimisation.wrapper.volume_wrapper.PanelVolumeWrapper": [[15, 2, 1, "", "from_save"]], "tomopt.plotting": [[16, 0, 0, "-", "appearance"], [16, 0, 0, "-", "diagnostics"], [16, 0, 0, "-", "predictions"]], "tomopt.plotting.diagnostics": [[16, 4, 1, "", "plot_hit_density"], [16, 4, 1, "", "plot_scatter_density"]], "tomopt.plotting.predictions": [[16, 4, 1, "", "plot_pred_true_x0"]], "tomopt.utils": [[4, 4, 1, "", "class_to_x0preds"], [4, 4, 1, "", "jacobian"], [4, 4, 1, "", "x0_from_mixture"], [4, 4, 1, "", "x0targs_to_classtargs"]], "tomopt.volume": [[17, 0, 0, "-", "heatmap"], [17, 0, 0, "-", "layer"], [17, 0, 0, "-", "panel"], [17, 0, 0, "-", "scatter_model"], [17, 0, 0, "-", "volume"]], "tomopt.volume.heatmap": [[17, 1, 1, "", "DetectorHeatMap"]], "tomopt.volume.heatmap.DetectorHeatMap": [[17, 2, 1, "", "assign_budget"], [17, 2, 1, "", "clamp_params"], [17, 2, 1, "", "get_cost"], [17, 2, 1, "", "get_efficiency"], [17, 2, 1, "", "get_hits"], [17, 2, 1, "", "get_resolution"], [17, 2, 1, "", "get_xy_mask"], [17, 2, 1, "", "plot_map"], [17, 3, 1, "", "x"], [17, 3, 1, "", "y"]], "tomopt.volume.layer": [[17, 1, 1, "", "AbsDetectorLayer"], [17, 1, 1, "", "AbsLayer"], [17, 1, 1, "", "PanelDetectorLayer"], [17, 1, 1, "", "PassiveLayer"]], "tomopt.volume.layer.AbsDetectorLayer": [[17, 2, 1, "", "assign_budget"], [17, 2, 1, "", "conform_detector"], [17, 2, 1, "", "forward"], [17, 2, 1, "", "get_cost"]], "tomopt.volume.layer.AbsLayer": [[17, 2, 1, "", "forward"], [17, 2, 1, "", "get_lw_z_size"]], "tomopt.volume.layer.PanelDetectorLayer": [[17, 2, 1, "", "assign_budget"], [17, 2, 1, "", "conform_detector"], [17, 2, 1, "", "forward"], [17, 2, 1, "", "get_cost"], [17, 2, 1, "", "get_device"], [17, 2, 1, "", "get_panel_zorder"], [17, 2, 1, "", "yield_zordered_panels"]], "tomopt.volume.layer.PassiveLayer": [[17, 2, 1, "", "abs2idx"], [17, 2, 1, "", "forward"], [17, 2, 1, "", "load_rad_length"], [17, 2, 1, "", "mu_abs2idx"], [17, 2, 1, "", "scatter_and_propagate"]], "tomopt.volume.panel": [[17, 1, 1, "", "DetectorPanel"], [17, 1, 1, "", "SigmoidDetectorPanel"]], "tomopt.volume.panel.DetectorPanel": [[17, 2, 1, "", "assign_budget"], [17, 2, 1, "", "clamp_params"], [17, 2, 1, "", "forward"], [17, 2, 1, "", "get_cost"], [17, 2, 1, "", "get_efficiency"], [17, 2, 1, "", "get_gauss"], [17, 2, 1, "", "get_hits"], [17, 2, 1, "", "get_resolution"], [17, 2, 1, "", "get_scaled_xy_span"], [17, 2, 1, "", "get_xy_mask"], [17, 3, 1, "", "x"], [17, 3, 1, "", "y"]], "tomopt.volume.panel.SigmoidDetectorPanel": [[17, 2, 1, "", "get_efficiency"], [17, 2, 1, "", "get_resolution"], [17, 2, 1, "", "sig_model"], [17, 3, 1, "", "smooth"]], "tomopt.volume.volume": [[17, 1, 1, "", "Volume"]], "tomopt.volume.volume.Volume": [[17, 2, 1, "", "assign_budget"], [17, 2, 1, "", "build_xyz_edges"], [17, 3, 1, "", "device"], [17, 2, 1, "", "draw"], [17, 2, 1, "", "forward"], [17, 2, 1, "", "get_cost"], [17, 2, 1, "", "get_detectors"], [17, 2, 1, "", "get_passive_z_range"], [17, 2, 1, "", "get_passives"], [17, 2, 1, "", "get_rad_cube"], [17, 3, 1, "", "h"], [17, 2, 1, "", "load_rad_length"], [17, 2, 1, "", "lookup_passive_xyz_coords"], [17, 3, 1, "", "lw"], [17, 3, 1, "", "passive_size"], [17, 3, 1, "", "target"], [17, 3, 1, "", "xyz_centres"], [17, 3, 1, "", "xyz_edges"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"tomopt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "differenti": 0, "muon": [0, 10], "tomographi": 0, "optimis": [0, 11, 12, 13, 14, 15], "packag": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "overview": [0, 2], "document": 0, "index": 0, "subpackag": [4, 5, 11], "submodul": [4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], "core": 4, "modul": [4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], "util": 4, "version": 4, "infer": [6, 9], "scatter": 9, "volum": [6, 7, 9, 17], "gener": 10, "muon_batch": 10, "callback": 12, "cyclic_callback": 12, "data_callback": 12, "diagnostic_callback": 12, "eval_metr": 12, "grad_callback": 12, "heatmap_gif": 12, "loss_callback": [], "monitor": 12, "opt_callback": 12, "pred_callback": 12, "warmup_callback": 12, "detector_callback": 12, "heatmap": 17, "layer": 17, "panel": 17, "scatter_model": 17, "instal": 1, "window": [], "usag": [], "test": [], "extern": 1, "repo": 1, "author": 1, "benchmark": [5, 6, 7, 8], "ladle_furnac": 6, "data": [6, 7, 8, 13], "loss": [6, 14], "plot": [6, 16], "small_wal": 7, "u_lorri": 8, "passiv": 13, "sub_loss": 14, "wrapper": 15, "volume_wrapp": 15, "appear": 16, "diagnost": 16, "predict": 16, "As": 1, "depend": 1, "For": 1, "develop": 1, "exampl": 1, "run": 1, "notebook": 1, "remot": 1, "cluster": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"tomopt": [[3, "tomopt"]], "tomopt package": [[4, "tomopt-package"]], "Subpackages": [[4, "subpackages"], [5, "subpackages"], [11, "subpackages"]], "Submodules": [[4, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"], [9, "submodules"], [10, "submodules"], [12, "submodules"], [13, "submodules"], [14, "submodules"], [15, "submodules"], [16, "submodules"], [17, "submodules"]], "tomopt.core module": [[4, "module-tomopt.core"]], "tomopt.utils module": [[4, "module-tomopt.utils"]], "tomopt.version module": [[4, "module-tomopt.version"]], "tomopt.benchmarks package": [[5, "tomopt-benchmarks-package"]], "tomopt.benchmarks.ladle_furnace package": [[6, "tomopt-benchmarks-ladle-furnace-package"]], "tomopt.benchmarks.ladle_furnace.data module": [[6, "module-tomopt.benchmarks.ladle_furnace.data"]], "tomopt.benchmarks.ladle_furnace.inference module": [[6, "module-tomopt.benchmarks.ladle_furnace.inference"]], "tomopt.benchmarks.ladle_furnace.loss module": [[6, "module-tomopt.benchmarks.ladle_furnace.loss"]], "tomopt.benchmarks.ladle_furnace.plotting module": [[6, "module-tomopt.benchmarks.ladle_furnace.plotting"]], "tomopt.benchmarks.ladle_furnace.volume module": [[6, "module-tomopt.benchmarks.ladle_furnace.volume"]], "tomopt.benchmarks.small_walls package": [[7, "tomopt-benchmarks-small-walls-package"]], "tomopt.benchmarks.small_walls.data module": [[7, "module-tomopt.benchmarks.small_walls.data"]], "tomopt.benchmarks.small_walls.volume module": [[7, "module-tomopt.benchmarks.small_walls.volume"]], "tomopt.benchmarks.u_lorry package": [[8, "tomopt-benchmarks-u-lorry-package"]], "tomopt.benchmarks.u_lorry.data module": [[8, "module-tomopt.benchmarks.u_lorry.data"]], "tomopt.inference package": [[9, "tomopt-inference-package"]], "tomopt.inference.scattering module": [[9, "module-tomopt.inference.scattering"]], "tomopt.inference.volume module": [[9, "module-tomopt.inference.volume"]], "tomopt.muon package": [[10, "tomopt-muon-package"]], "tomopt.muon.generation module": [[10, "module-tomopt.muon.generation"]], "tomopt.muon.muon_batch module": [[10, "module-tomopt.muon.muon_batch"]], "tomopt.optimisation package": [[11, "tomopt-optimisation-package"]], "tomopt.optimisation.callbacks package": [[12, "tomopt-optimisation-callbacks-package"]], "tomopt.optimisation.callbacks.callback module": [[12, "module-tomopt.optimisation.callbacks.callback"]], "tomopt.optimisation.callbacks.cyclic_callbacks module": [[12, "module-tomopt.optimisation.callbacks.cyclic_callbacks"]], "tomopt.optimisation.callbacks.data_callbacks module": [[12, "module-tomopt.optimisation.callbacks.data_callbacks"]], "tomopt.optimisation.callbacks.detector_callbacks module": [[12, "module-tomopt.optimisation.callbacks.detector_callbacks"]], "tomopt.optimisation.callbacks.diagnostic_callbacks module": [[12, "module-tomopt.optimisation.callbacks.diagnostic_callbacks"]], "tomopt.optimisation.callbacks.eval_metric module": [[12, "module-tomopt.optimisation.callbacks.eval_metric"]], "tomopt.optimisation.callbacks.grad_callbacks module": [[12, "module-tomopt.optimisation.callbacks.grad_callbacks"]], "tomopt.optimisation.callbacks.heatmap_gif module": [[12, "module-tomopt.optimisation.callbacks.heatmap_gif"]], "tomopt.optimisation.callbacks.monitors module": [[12, "module-tomopt.optimisation.callbacks.monitors"]], "tomopt.optimisation.callbacks.opt_callbacks module": [[12, "module-tomopt.optimisation.callbacks.opt_callbacks"]], "tomopt.optimisation.callbacks.pred_callbacks module": [[12, "module-tomopt.optimisation.callbacks.pred_callbacks"]], "tomopt.optimisation.callbacks.warmup_callbacks module": [[12, "module-tomopt.optimisation.callbacks.warmup_callbacks"]], "tomopt.optimisation.data package": [[13, "tomopt-optimisation-data-package"]], "tomopt.optimisation.data.passives module": [[13, "module-tomopt.optimisation.data.passives"]], "tomopt.optimisation.loss package": [[14, "tomopt-optimisation-loss-package"]], "tomopt.optimisation.loss.loss module": [[14, "module-tomopt.optimisation.loss.loss"]], "tomopt.optimisation.loss.sub_losses module": [[14, "module-tomopt.optimisation.loss.sub_losses"]], "tomopt.optimisation.wrapper package": [[15, "tomopt-optimisation-wrapper-package"]], "tomopt.optimisation.wrapper.volume_wrapper module": [[15, "module-tomopt.optimisation.wrapper.volume_wrapper"]], "tomopt.plotting package": [[16, "tomopt-plotting-package"]], "tomopt.plotting.appearance module": [[16, "module-tomopt.plotting.appearance"]], "tomopt.plotting.diagnostics module": [[16, "module-tomopt.plotting.diagnostics"]], "tomopt.plotting.predictions module": [[16, "module-tomopt.plotting.predictions"]], "tomopt.volume package": [[17, "tomopt-volume-package"]], "tomopt.volume.heatmap module": [[17, "module-tomopt.volume.heatmap"]], "tomopt.volume.layer module": [[17, "module-tomopt.volume.layer"]], "tomopt.volume.panel module": [[17, "module-tomopt.volume.panel"]], "tomopt.volume.scatter_model module": [[17, "module-tomopt.volume.scatter_model"]], "tomopt.volume.volume module": [[17, "module-tomopt.volume.volume"]], "TomOpt: Differential Muon Tomography Optimisation": [[0, "tomopt-differential-muon-tomography-optimisation"]], "Overview": [[0, "overview"], [2, "overview"]], "Package overview": [[0, "package-overview"]], "Package documentation": [[0, "package-documentation"]], "Index": [[0, "index"]], "Installation": [[1, "installation"]], "As a dependency": [[1, "as-a-dependency"]], "For development": [[1, "for-development"]], "Examples": [[1, "examples"]], "Running notebooks in a remote cluster": [[1, "running-notebooks-in-a-remote-cluster"]], "External repos": [[1, "external-repos"]], "Authors": [[1, "authors"]]}, "indexentries": {}})