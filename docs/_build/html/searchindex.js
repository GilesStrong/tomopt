Search.setIndex({"docnames": ["index", "installation", "tomopt", "tomopt.benchmarks", "tomopt.benchmarks.ladle_furnace", "tomopt.benchmarks.phi_detector", "tomopt.benchmarks.small_walls", "tomopt.benchmarks.u_lorry", "tomopt.inference", "tomopt.muon", "tomopt.optimisation", "tomopt.optimisation.callbacks", "tomopt.optimisation.data", "tomopt.optimisation.loss", "tomopt.optimisation.wrapper", "tomopt.plotting", "tomopt.volume"], "filenames": ["index.rst", "installation.rst", "tomopt.rst", "tomopt.benchmarks.rst", "tomopt.benchmarks.ladle_furnace.rst", "tomopt.benchmarks.phi_detector.rst", "tomopt.benchmarks.small_walls.rst", "tomopt.benchmarks.u_lorry.rst", "tomopt.inference.rst", "tomopt.muon.rst", "tomopt.optimisation.rst", "tomopt.optimisation.callbacks.rst", "tomopt.optimisation.data.rst", "tomopt.optimisation.loss.rst", "tomopt.optimisation.wrapper.rst", "tomopt.plotting.rst", "tomopt.volume.rst"], "titles": ["TomOpt: Differential Muon Tomography Optimisation", "Installation", "tomopt package", "tomopt.benchmarks package", "tomopt.benchmarks.ladle_furnace package", "tomopt.benchmarks.phi_detector package", "tomopt.benchmarks.small_walls package", "tomopt.benchmarks.u_lorry package", "tomopt.inference package", "tomopt.muon package", "tomopt.optimisation package", "tomopt.optimisation.callbacks package", "tomopt.optimisation.data package", "tomopt.optimisation.loss package", "tomopt.optimisation.wrapper package", "tomopt.plotting package", "tomopt.volume package"], "terms": {"instal": 0, "test": [0, 4, 5, 7, 8, 11], "extern": 0, "repo": 0, "author": [0, 8], "volum": [0, 1, 2, 4, 5, 7, 9, 11, 12, 13, 14, 15], "infer": [0, 1, 2, 9, 11, 13, 14, 16], "plot": [0, 2, 5, 8, 11, 16], "benchmark": [0, 2], "muon": [2, 5, 8, 11, 14, 15, 16], "optimis": [2, 16], "class_to_x0pr": 2, "arrai": [2, 9, 11, 15], "id2x0": 2, "sourc": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "convert": [2, 4, 8, 11, 13], "class": [1, 2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16], "x0": [2, 4, 5, 8, 11, 12, 13, 14, 15, 16], "predict": [2, 4, 8, 11, 12, 13, 14], "us": [1, 2, 5, 8, 9, 11, 12, 13, 14, 15, 16], "map": [2, 9, 11, 13, 16], "defin": [2, 9, 11, 15, 16], "paramet": [2, 4, 5, 8, 9, 11, 12, 13, 14, 15, 16], "ndarrai": [2, 7, 9, 11, 12, 14, 15], "integ": [2, 8, 13], "id": [2, 11, 13, 16], "dict": [2, 5, 8, 9, 11, 13, 14, 16], "int": [2, 5, 8, 9, 11, 12, 13, 14, 16], "float": [2, 5, 8, 9, 11, 12, 13, 14, 16], "valu": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16], "return": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "type": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "new": [1, 2, 8, 9, 11, 12, 14, 16], "jacobian": 2, "y": [2, 4, 5, 8, 9, 13, 15, 16], "x": [2, 4, 5, 8, 9, 13, 15, 16], "create_graph": 2, "fals": [2, 4, 5, 9, 11, 13, 14, 16], "allow_unus": 2, "true": [2, 4, 5, 8, 9, 11, 12, 13, 14, 15, 16], "comput": [1, 2, 5, 8, 9, 11, 13, 14, 16], "dy": [2, 16], "dx": [2, 16], "respect": 2, "variabl": [2, 8, 9, 14, 16], "can": [1, 2, 8, 9, 11, 12, 13, 14, 16], "have": [1, 2, 5, 8, 9, 11, 12, 13, 14, 16], "multipl": [2, 8, 11, 13, 14, 16], "element": [2, 8, 9, 16], "If": [2, 5, 8, 9, 11, 12, 13, 14, 16], "ha": [2, 8, 9, 11, 16], "i": [1, 2, 4, 5, 8, 9, 11, 12, 13, 14, 15, 16], "vectoris": 2, "via": [1, 2, 8, 9, 11, 13, 14, 16], "vmap": 2, "tensor": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16], "differenti": [2, 8, 11, 16], "depend": [1, 2, 8, 13], "bool": [2, 4, 5, 8, 11, 12, 13, 14, 16], "graph": 2, "deriv": 2, "construct": 2, "allow": [2, 8, 11, 16], "higher": [2, 8, 11, 13, 16], "order": [2, 8, 11, 12, 13, 14, 15, 16], "product": [2, 8], "default": [1, 2, 9, 11, 13, 14, 16], "specifi": [2, 9, 11, 12, 13, 14, 16], "input": 2, "were": [2, 8, 9], "when": [1, 2, 4, 6, 7, 8, 11, 12, 13, 14, 16], "output": [2, 13], "therefor": [2, 16], "grad": [2, 8], "alwai": [2, 8, 12, 16], "shape": [2, 9, 13], "x0_from_mixtur": 2, "densiti": 2, "weight_frac": 2, "none": [2, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16], "volume_frac": 2, "mixtur": 2, "non": [2, 16], "chemic": 2, "bond": 2, "materi": [2, 8, 11, 12, 13, 16], "base": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16], "http": [1, 2, 8, 11, 16], "cd": [1, 2], "cern": 2, "ch": 2, "record": [2, 5, 8, 9, 11, 14, 15, 16], "1279627": 2, "file": [2, 11, 14], "ph": 2, "ep": 2, "tech": 2, "note": [2, 8], "2010": 2, "013": 2, "pdf": [2, 8, 16], "union": [2, 9, 11, 12, 13, 14, 16], "list": [1, 2, 5, 8, 9, 11, 12, 14, 16], "metr": [2, 5, 8, 9, 11, 16], "kg": 2, "m": [1, 2, 9, 16], "3": [1, 2, 5, 8, 9, 13, 16], "rel": [2, 8, 13, 16], "amount": [2, 8, 9], "each": [1, 2, 8, 9, 11, 13, 14, 16], "weight": [2, 8, 13, 16], "The": [1, 2, 5, 8, 11, 12, 13, 14, 16], "x0targs_to_classtarg": 2, "x02id": [2, 11, 13], "target": [2, 4, 6, 7, 8, 11, 12, 13, 14, 16], "To": [2, 8], "account": [2, 8, 11, 14, 16], "point": [2, 5, 8, 9, 11, 14, 16], "precis": [2, 8, 9, 11, 14, 16], "ar": [1, 2, 8, 9, 11, 12, 13, 14, 15, 16], "which": [2, 8, 9, 11, 12, 13, 14, 16], "closest": [2, 8], "kei": [1, 2, 9], "thi": [1, 2, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "mean": [2, 8, 13, 14, 16], "method": [2, 4, 5, 8, 9, 11, 12, 13, 14, 16], "cannot": [2, 8], "detect": [2, 11, 16], "miss": 2, "from": [1, 2, 5, 8, 9, 11, 12, 13, 14, 16], "even": [2, 8, 11], "isn": 2, "t": [2, 5, 8, 9, 16], "modifi": [2, 9], "place": [2, 8, 9, 16], "ladle_furnac": 3, "phi_detector": 3, "small_wal": 3, "u_lorri": 3, "phidetectorpanel": 5, "init_phi": 5, "init_z": [5, 9], "re": [5, 6, 16], "eff": [5, 6, 8, 16], "devic": [5, 6, 9, 14, 16], "cpu": [5, 6, 9, 14, 16], "detectorpanel": [5, 14, 16], "research": [4, 5, 7], "onli": [4, 5, 7, 8, 9, 11, 12, 14, 16], "unit": [4, 5, 7, 8, 11, 13, 16], "_is_full_backward_hook": [4, 5, 13, 16], "option": [4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "clamp_param": [5, 16], "xyz_low": [5, 16], "xyz_high": [5, 16], "ensur": [5, 11, 14, 16], "panel": [5, 11, 14], "centr": [5, 8, 12, 13, 16], "within": [1, 5, 8, 9, 11, 14, 16], "suppli": [5, 9, 16], "xyz": [5, 8, 9, 11, 16], "rang": [5, 9, 11, 14, 16], "span": [5, 6, 16], "between": [5, 8, 9, 11, 13, 16], "20": [5, 16], "10": [4, 5, 6, 11, 13, 16], "A": [4, 5, 6, 7, 11, 12, 13, 14, 16], "small": [5, 8, 16], "random": [5, 12, 16], "number": [5, 8, 9, 11, 12, 13, 14, 16], "1e": [5, 16], "ad": [5, 8, 9, 11, 16], "subtract": [5, 16], "min": [5, 16], "max": [5, 16], "z": [4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "posit": [4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], "doesn": [5, 16], "overlap": [5, 16], "other": [5, 8, 11, 13, 14, 16], "tupl": [5, 7, 8, 9, 11, 12, 14, 16], "minimum": [1, 5, 9, 16], "maximum": [5, 11, 12, 16], "get_effici": [5, 16], "xy": [4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], "mask": [5, 9, 16], "as_2d": [5, 16], "effici": [5, 8, 9, 11, 14, 16], "run": [1, 5, 9, 11, 14, 16], "evalu": [5, 13, 14, 16], "mode": [5, 11, 14, 16], "realistic_valid": [5, 16], "full": [5, 11, 14, 16], "insid": [5, 11, 16], "indic": [5, 8, 11, 16], "zero": [5, 8, 11, 14, 16], "outsid": [5, 11, 16], "otherwis": [1, 5, 8, 11, 12, 13, 16], "gaussian": [5, 8, 14, 16], "model": [1, 5, 8, 9, 11, 16], "n": [1, 5, 8, 9, 11, 16], "pre": [1, 5, 12, 16], "boolean": [5, 8, 9, 11, 16], "where": [5, 8, 9, 11, 12, 13, 14, 16], "requir": [1, 5, 8, 9, 14, 16], "than": [5, 11, 12, 13, 16], "automat": [5, 9, 11, 16], "get_hit": [5, 8, 9, 16], "mu": [5, 8, 11, 14, 16], "budget": [5, 11, 13, 14, 16], "main": [5, 11, 16], "interact": [5, 16], "hit": [5, 8, 9, 11, 15, 16], "consist": [5, 13, 15, 16], "reco_xi": [5, 9, 16], "reconstruct": [5, 16], "includ": [5, 8, 11, 13, 16], "simul": [5, 9, 16], "resolut": [5, 8, 11, 14, 16], "gen_xi": [5, 9, 16], "gener": [1, 5, 11, 12, 14, 16], "level": [5, 8, 16], "str": [5, 8, 9, 11, 12, 13, 14, 15, 16], "get_resolut": [5, 16], "train": [1, 4, 5, 11, 12, 13, 14, 16], "phidetscatterbatch": 5, "scatterbatch": [5, 8, 14], "untest": 5, "_compute_track": [5, 8], "track": [5, 8, 11], "accord": [1, 5, 8, 9, 11, 14, 16], "uncertainti": [5, 8], "1": [1, 4, 5, 6, 8, 9, 11, 13, 14, 16], "_extract_hit": [5, 8], "take": [5, 8, 16], "dictionari": [5, 8, 9, 11, 13, 14, 16], "combin": [1, 5, 8, 11], "them": [5, 8, 11, 14, 16], "singl": [5, 8, 9, 11, 12, 13, 14, 16], "static": [4, 5, 8, 9, 11, 14, 16], "_get_hit_unc": 5, "zordered_panel": 5, "get_muon_trajectori": [5, 8], "unc": [5, 8], "lw": [5, 8, 16], "h": [5, 16], "phi": [5, 8, 9], "0": [4, 5, 6, 7, 8, 9, 11, 14, 16], "assum": [1, 4, 5, 8, 13, 16], "an": [4, 5, 6, 7, 8, 11, 12, 13, 16], "analyt": [5, 8], "likelihood": [5, 8, 13], "maximis": [5, 8], "l": [5, 14], "prod_i": 5, "g": [1, 5, 8, 9, 11, 13, 14, 16], "h_i": 5, "h_": 5, "opt": [5, 14], "y0": 5, "theta": [5, 8, 9, 16], "x_": 5, "co": [5, 8], "phi_i": 5, "y_": 5, "sin": 5, "z_i": 5, "tan": 5, "z0": 5, "coordin": [5, 9], "angl": [5, 8, 9, 16], "sum_i": 5, "unc_i": 5, "2": [5, 8, 9, 16], "sun_i": 5, "In": [5, 8, 9, 11, 14], "eval": [5, 16], "nan": [5, 8, 11, 16], "trajectori": [5, 8, 9, 14, 16], "valid": [1, 5, 11, 14], "plot_scatt": [5, 8], "idx": [5, 8], "represent": [5, 8, 11], "fit": [5, 8, 11, 14, 16], "index": [5, 8, 9, 16], "genscatterbatch": 8, "inform": [8, 9, 13, 14, 16], "incom": [8, 11, 16], "outgo": 8, "intend": [8, 16], "diagnost": 8, "purpos": 8, "carri": 8, "gradient": [8, 11, 14], "w": [8, 9, 16], "r": [1, 8, 9, 16], "detector": [8, 9, 11, 13, 14, 15, 16], "except": [8, 9, 16], "linear": [8, 13], "perform": [8, 13, 14, 16], "separ": [1, 8], "all": [1, 8, 9, 11, 12, 13, 14, 16], "associ": [1, 8, 9, 11, 14], "layer": [4, 6, 7, 8, 9, 11, 12, 13, 14, 15], "group": [8, 16], "po": [8, 9, 16], "attribut": [8, 9, 11, 13, 16], "current": [8, 9, 11, 13, 16], "expect": [8, 13, 16], "abov": [8, 9, 13, 16], "passiv": [1, 8, 9, 11, 13, 14, 15, 16], "those": [8, 9, 11, 16], "below": [8, 9, 16], "minimis": 8, "consid": [8, 11], "doe": [8, 9, 16], "e": [1, 8, 9, 11, 13, 14, 15, 16], "third": 8, "set": [1, 5, 8, 9, 11, 12, 13, 14, 16], "sinc": [8, 14, 16], "split": [8, 14], "n_hits_abov": 8, "One": 8, "instanc": [1, 8, 16], "should": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "creat": [1, 8, 9, 11, 16], "muonbatch": [8, 9, 11, 14, 16], "As": [8, 11], "part": [8, 11, 16], "initialis": [8, 9, 11, 12, 14, 16], "filter": 8, "_filter_scatt": 8, "avoid": [8, 11], "inf": 8, "result": [1, 8, 9, 16], "direct": [8, 9], "chang": [8, 9, 11, 16], "mani": [1, 8, 9, 13], "further": 8, "downstream": 8, "lazi": 8, "basi": 8, "memois": 8, "first": [1, 8, 11, 13, 15], "request": [1, 8, 14], "store": [8, 9, 14, 16], "case": [8, 13], "dtheta": [8, 9], "dphi": 8, "total": [8, 11, 12, 13, 14, 16], "under": [8, 16], "assumpt": 8, "angular": [8, 9], "necessari": [8, 14], "here": [1, 8, 11, 16], "loss": [8, 10, 11, 14], "undergo": [8, 16], "pi": [8, 9], "neg": [4, 8, 9, 13], "becom": 8, "one": [8, 11, 13, 14, 16], "tell": 8, "whether": [8, 11, 13, 14, 16], "instead": [8, 9, 11, 13, 16], "larg": [8, 9, 11, 13], "occur": [8, 14], "total_scatt": 8, "quadratur": 8, "sum": [8, 13, 16], "three": [8, 16], "both": [8, 12, 13, 14, 16], "hypothes": 8, "final": [8, 11, 13], "chosen": [8, 16], "hypothesi": 8, "been": [8, 11], "found": [8, 16], "good": [1, 8], "through": [8, 9, 11, 14, 16], "travel": [8, 9], "object": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "_compute_dtheta_dphi_scatt": 8, "theta_in": 8, "phi_in": 8, "theta_out": 8, "phi_out": 8, "_compute_out_var_unc": 8, "var": 8, "due": 8, "error": [8, 11, 13], "propag": [8, 9, 11, 16], "triangl": 8, "matrix": 8, "off": [8, 9, 13], "diagon": 8, "behaviour": 8, "_compute_phi": 8, "compon": [8, 11, 13, 16], "vector": 8, "_compute_scatt": [8, 16], "normal": [8, 14, 16], "extract": [8, 13], "handl": [1, 8], "locat": [8, 11, 12, 14, 16], "adapt": 8, "misc": 8, "3334866": 8, "titl": 8, "two": [8, 16], "line": 8, "brian": 8, "math": 8, "stackexchang": 8, "com": [1, 8], "user": [1, 8, 11, 16], "72614": 8, "howpublish": 8, "mathemat": 8, "stack": [8, 9, 16], "exchang": 8, "url": 8, "q": 8, "version": [1, 8, 13], "2019": [8, 16], "08": 8, "26": 8, "eprint": 8, "_compute_theta": 8, "_compute_theta_msc": 8, "p": [8, 9, 11, 14], "cosin": 8, "dot": 8, "NOT": [8, 9, 16], "pleas": [8, 11, 16], "code": [8, 13], "kept": [8, 11], "still": [1, 8, 11], "_compute_xyz_in": 8, "top": [8, 16], "_compute_xyz_out": 8, "bottom": [8, 11, 15, 16], "_cross_track": 8, "_dphi": 8, "_dphi_unc": 8, "_dtheta": 8, "_dtheta_unc": 8, "_dtheta_xi": 8, "_dtheta_xy_unc": 8, "_dxy": 8, "_dxy_unc": 8, "might": [8, 14], "seem": 8, "heavi": 8, "hand": 8, "invalid": 8, "extrem": [8, 9], "spoil": 8, "remov": [8, 9], "ani": [8, 9, 11, 14, 16], "least": [8, 9, 13], "high": [8, 11, 13], "ok": 8, "some": [8, 11, 13, 16], "configur": [8, 13, 14, 16], "tini": 8, "best": 8, "manual": [1, 8, 9, 16], "unneed": 8, "gain": 8, "increas": [8, 11, 13, 15], "avail": [8, 11, 16], "criteria": 8, "parallel": 8, "far": [8, 13], "its": [1, 4, 6, 7, 8, 9, 11, 12, 13, 16], "1e10": 8, "_gen_hit": 8, "_hit_eff": 8, "_hit_unc": 8, "_phi_in": 8, "_phi_in_unc": 8, "_phi_out": 8, "_phi_out_unc": 8, "_poca_xyz": 8, "_poca_xyz_unc": 8, "_reco_hit": 8, "_set_dtheta_dphi_scatt": 8, "simultan": 8, "_theta_in": 8, "_theta_in_unc": 8, "_theta_msc": 8, "_theta_msc_unc": 8, "_theta_out": 8, "_theta_out_unc": 8, "_theta_xy_in": 8, "_theta_xy_in_unc": 8, "_theta_xy_out": 8, "_theta_xy_out_unc": 8, "_total_scatt": 8, "_total_scatter_unc": 8, "_track_coef": 8, "_track_in": 8, "_track_out": 8, "_track_start_in": 8, "_track_start_out": 8, "_xyz_in": 8, "_xyz_in_unc": 8, "_xyz_out": 8, "_xyz_out_unc": 8, "properti": [8, 9, 16], "above_gen_hit": 8, "above_hit_eff": 8, "above_hit_unc": 8, "above_hit": 8, "below_gen_hit": 8, "below_hit_eff": 8, "below_hit_unc": 8, "below_hit": 8, "delta": 8, "dphi_unc": 8, "dtheta_unc": 8, "dtheta_xi": 8, "theta_xi": [8, 9], "zx": 8, "zy": 8, "plane": [8, 9, 16], "dtheta_xy_unc": 8, "dxy": 8, "distanc": [8, 9, 11, 16], "poca": [8, 11, 15], "dxy_unc": 8, "gen_hit": 8, "whilst": [1, 8, 11, 16], "No": 8, "length": [4, 6, 7, 8, 11, 12, 16], "width": [4, 6, 7, 8, 12, 16], "start": [8, 9, 11, 16], "initi": [8, 9, 11, 16], "vec": 8, "get_scatter_mask": 8, "hit_eff": 8, "hit_unc": 8, "per": [8, 11, 12, 13, 14, 16], "n_hits_below": 8, "phi_in_unc": 8, "phi_out_unc": 8, "poca_xyz": 8, "poca_xyz_unc": 8, "reco_hit": 8, "theta_in_unc": 8, "theta_msc": 8, "rule": 8, "better": [8, 11, 16], "theta_msc_unc": 8, "theta_out_unc": 8, "theta_xy_in": 8, "decompos": 8, "theta_xy_in_unc": 8, "theta_xy_out": 8, "theta_xy_out_unc": 8, "fot": 8, "total_scatter_unc": 8, "track_in": 8, "track_out": 8, "track_start_in": 8, "track_start_out": 8, "xyz_in": 8, "xyz_in_unc": 8, "xyz_out": 8, "xyz_out_unc": 8, "absintclassifierfromx0": [4, 8], "partial_x0_inferr": [4, 8], "output_prob": [4, 8], "class2float": 8, "absvolumeinferr": [8, 14], "abstract": [8, 9, 12, 13, 14, 16], "multiclass": [8, 13], "classif": [8, 13], "voxelwis": [4, 8, 11, 13, 15], "inherit": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "must": [1, 4, 8, 11, 13, 16], "provid": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "wai": [1, 8], "probabl": [4, 8, 13, 16], "dimens": 8, "basic": 8, "inferr": [8, 11], "raw": 8, "most": [8, 15], "latter": [8, 16], "process": [8, 11, 14, 16], "function": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "absx0inferr": 8, "partial": 8, "instati": 8, "pass": [8, 9, 11, 14, 16], "probabilit": 8, "argmax": 8, "over": [8, 9, 11, 13, 14, 16], "last": [8, 9, 11], "callabl": [5, 8, 12, 13, 14, 16], "_abc_impl": [4, 6, 7, 8, 11, 12, 13, 14, 16], "_abc_data": [4, 6, 7, 8, 11, 12, 13, 14, 16], "_reset_var": 8, "reset": [8, 11], "made": [8, 11, 13], "batch": [8, 9, 11, 14, 16], "add_scatt": 8, "append": [8, 11, 14, 16], "vairabl": 8, "get_predict": 8, "call": [4, 6, 7, 8, 9, 11, 12, 14, 16], "": [8, 9, 11, 13, 14, 16], "up": [1, 8, 11, 13, 14, 16], "compute_effici": 8, "compuat": 8, "implement": [8, 9, 11, 14, 16], "contain": [8, 9, 11, 12, 13, 14, 16], "whose": [1, 8], "predicion": 8, "dure": [1, 8, 11, 12, 16], "inv_weight": [8, 14], "pred": [4, 8, 11, 13, 14, 15], "x02prob": [4, 8], "vox_pr": [4, 8], "overrid": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "fed": 8, "given": [4, 6, 7, 8, 9, 12, 13], "individu": [8, 13, 16], "accompani": 8, "invers": 8, "design": [8, 11, 13, 14, 16], "divid": [8, 13], "targ": [4, 8, 11], "everi": [8, 9, 11, 12, 13, 14, 16], "voxel": [4, 8, 11, 12, 13, 16], "approach": [8, 16], "assign": [8, 11, 14, 16], "entireti": 8, "pdg": [8, 16], "describ": [8, 16], "lbl": [8, 16], "gov": [8, 16], "review": [8, 16], "rpp2018": [8, 16], "rev": [8, 16], "passag": [8, 16], "particl": [8, 16], "matter": [8, 16], "onc": [8, 9, 11], "proce": [8, 14], "thusli": 8, "For": [1, 8, 9, 13, 14, 16], "p_ij": 8, "wa": [8, 11, 13], "j": 8, "These": [8, 13], "integr": 8, "uncorrel": [8, 16], "scale": [8, 14], "equal": [8, 9, 13, 16], "multipli": [8, 13, 16], "e_i": 8, "w_ij": 8, "give": 8, "x_0": 8, "left": [8, 16], "frac": 8, "0136": 8, "mathrm": 8, "rm": 8, "right": 8, "bar": 8, "_": 8, "tot": 8, "differ": [8, 9, 11, 12, 16], "whole": [8, 14], "popul": 8, "rmss": 8, "term": [8, 13], "side": 8, "equat": 8, "addit": [8, 9, 13], "varianc": 8, "squar": [8, 13, 16], "x0_j": 8, "natur": 8, "log": [8, 11, 13], "simplifi": 8, "reli": [8, 16], "heavili": 8, "care": [8, 16], "privat": [1, 8], "_combine_scatt": 8, "data": [1, 8, 10, 11, 14, 16], "so": [8, 11], "entri": 8, "out": [8, 13], "aid": 8, "pair": [8, 9, 11], "retriev": [8, 9, 11, 16], "_get_voxel_zxy_x0_pred_unc": 8, "incredibli": 8, "slow": 8, "recommend": [1, 8, 16], "_get_voxel_zxy_x0_pr": 8, "todo": [8, 11, 15, 16], "spread": 8, "_muon_effici": 8, "_muon_probs_per_voxel_zxi": 8, "_muon_scatter_var_unc": 8, "_muon_scatter_var": 8, "_n_mu": 8, "_set_var_dimens": 8, "_var_order_sz": 8, "tot_scatt": 8, "mom": [8, 9, 14, 16], "_vox_zxy_x0_pred_unc": 8, "_vox_zxy_x0_pr": 8, "_weighted_mean": 8, "wgt": 8, "row": 8, "_weighted_rm": 8, "root": [1, 8], "muon_effici": 8, "muon_mom": 8, "momenta": [8, 9], "muon_mom_unc": 8, "muon_poca_xyz": 8, "muon_poca_xyz_unc": 8, "muon_probs_per_voxel_zxi": 8, "don": 8, "muon_theta_in": 8, "muon_theta_in_unc": 8, "muon_theta_out": 8, "muon_theta_out_unc": 8, "muon_total_scatt": 8, "muon_total_scatter_unc": 8, "n_mu": 8, "vox_zxy_x0_pred_unc": 8, "Not": 8, "long": [8, 16], "calcul": 8, "vox_zxy_x0_pr": 8, "x0_from_scatt": 8, "deltaz": 8, "invert": 8, "height": [8, 13, 16], "momentum": [8, 9, 11, 14, 16], "estim": 8, "denseblockclassifierfromx0": 8, "n_block_voxel": 8, "use_avgpool": 8, "cut_coef": 8, "10000": [6, 8], "ratio_offset": 8, "ratio_coef": 8, "presenc": 8, "denser": 8, "transform": [8, 11], "wise": [8, 11], "binari": [8, 13], "statist": 8, "dens": 8, "block": [8, 12, 13, 16], "against": [8, 11, 12, 13], "light": 8, "background": [8, 12], "bkg": 8, "blk": 8, "sigma": [8, 16], "b": [1, 8], "lowest": [8, 16], "remain": [8, 14, 16], "rescal": [8, 13, 16], "coeffici": [8, 11, 13, 14, 16], "offset": 8, "constrain": 8, "beween": 8, "present": [8, 11, 12, 14], "nearer": 8, "form": [8, 14, 16], "contigu": [8, 16], "blur": 8, "stride": 8, "kernel": [4, 8], "size": [4, 6, 7, 8, 12, 14, 16], "averag": [8, 11, 13], "pool": 8, "actual": [8, 16], "cut": 8, "sigmoid": [8, 13, 16], "kth": 8, "statisitc": 8, "also": [1, 8, 9, 14, 16], "occupi": [8, 16], "wether": 8, "prediciton": 8, "sharp": 8, "sharper": [8, 11, 16], "constant": [8, 9, 15], "ratio": [8, 16], "scatter_batch": 8, "panelx0inferr": [8, 14], "paneldetectorlay": [8, 11, 16], "absmuongener": [9, 11, 14], "x_rang": 9, "y_rang": 9, "fixed_mom": 9, "5": [6, 7, 9, 13, 16], "energy_rang": 9, "500": 9, "theta_rang": 9, "2217304763960306": 9, "core": 9, "flux": 9, "generate_set": 9, "kinemat": 9, "sampl": [9, 11, 16], "uniformli": 9, "region": 9, "absolut": [9, 13, 16], "refer": [9, 14, 16], "frame": [9, 16], "gev": 9, "radian": 9, "_muon_mass2": 9, "01116369210198225": 9, "_n_bins_energi": 9, "200": 9, "_n_bins_theta": 9, "energi": 9, "classmethod": [9, 14], "from_volum": [9, 14], "min_angl": 9, "2617993877991494": 9, "heurist": 9, "d": 9, "balanc": [9, 13], "trade": 9, "realism": 9, "boundari": [9, 11, 14, 16], "would": [9, 16], "directli": 9, "toward": 9, "n_muon": 9, "rank": 9, "2pi": 9, "muongenerator2015": 9, "guan": 9, "et": 9, "al": 9, "2015": 9, "arxiv": [9, 11], "1509": 9, "06176": 9, "p1": 9, "102573": 9, "p2": 9, "068287": 9, "p3": 9, "958633": 9, "p4": 9, "0407253": 9, "p5": 9, "817285": 9, "gaisser": 9, "formula": 9, "cosmic": 9, "np": 9, "incid": 9, "muongenerator2016": 9, "shukla": 9, "sanskrith": 9, "2018": 9, "1606": 9, "06907": 9, "e_0": 9, "87": 9, "e_c": 9, "i_0": 9, "88": 9, "38": 9, "1938": 9, "rod": 9, "174": 9, "epinv": 9, "00117096018735363": 9, "xy_p_theta_phi": [9, 11], "own": 9, "axi": [9, 16], "upward": 9, "mai": [9, 11, 16], "anticlockwis": 9, "updat": [9, 11, 14, 16], "propagate_dz_dz": 9, "dz": 9, "propagate_dz_d": 9, "scatter_dxi": 9, "dx_vol": [9, 16], "dy_vol": [9, 16], "shift": 9, "scatter_dtheta_dphi": 9, "dtheta_vol": [9, 16], "dphi_vol": [9, 16], "alter": 9, "eventu": 9, "extend": [9, 11], "about": [9, 11, 13, 14], "reco_mom": 9, "howev": [9, 16], "measur": 9, "By": [9, 16], "snapshot_xyz": 9, "time": [1, 9, 13, 16], "xyz_hist": 9, "append_hit": 9, "_hit": 9, "_keep_mask": 9, "_mom": 9, "_phi": 9, "_theta": 9, "_x": 9, "_xy": 9, "_xyz": 9, "_y": 9, "_z": 9, "either": [9, 11, 12, 16], "copi": 9, "detach": 9, "clone": [1, 9], "theta_ref": 9, "compar": [9, 13, 15], "dtheta_x": 9, "theta_ref_x": 9, "theta_x": [9, 16], "dtheta_i": 9, "theta_ref_i": 9, "theta_i": [9, 16], "filter_muon": 9, "keep_mask": 9, "along": 9, "xy_low": 9, "xy_high": 9, "eas": 9, "n_hit": 9, "lower": [9, 11, 12, 13, 16], "limit": [9, 11], "upper": 9, "get_xy_mask": [9, 16], "correspond": [9, 13, 16], "p_dim": 9, "ph_dim": 9, "phi_from_theta_xi": 9, "work": [1, 9, 14], "xz": 9, "yz": 9, "anti": 9, "clockwis": 9, "propagate_d": 9, "flight": [9, 16], "move": [9, 11, 16], "propagate_dz": 9, "afterward": [9, 16], "thei": [9, 11, 12, 13, 14, 16], "downward": 9, "remove_upwards_muon": 9, "after": [1, 9, 11, 13, 14, 16], "scatter": [9, 11, 14, 16], "make": [1, 9, 11, 15, 16], "sure": [1, 9], "complet": [9, 11, 14], "longer": 9, "displac": [9, 16], "th_dim": 9, "4": [6, 9, 16], "theta_from_theta_xi": 9, "theta_x_from_theta_phi": 9, "theta_y_from_theta_phi": 9, "upwards_muon": 9, "x_dim": 9, "y_dim": 9, "z_dim": 9, "callback": [10, 14], "wrapper": [10, 11], "absvolumewrapp": [11, 14, 16], "interject": [11, 14], "variou": [11, 14, 16], "do": [11, 16], "noth": [11, 16], "check": [1, 11, 16], "see": [11, 16], "exactli": 11, "write": [1, 11, 14], "volumewrapp": [11, 16], "Their": 11, "fit_param": 11, "fitparam": [11, 14], "style": [11, 15], "It": [11, 13, 16], "read": [11, 14], "rather": [11, 16], "on_": [11, 14], "_begin": [11, 14], "_end": [11, 14], "loop": [11, 14, 16], "set_wrapp": [11, 14], "on_train_begin": [11, 14], "epoch": [11, 12, 14], "n_epoch": [11, 14], "state": [11, 13, 14], "on_epoch_begin": [11, 14], "enumer": [11, 14], "trn_passiv": [11, 14], "passive_b": [11, 14], "on_volume_batch_begin": [11, 14], "load": [1, 11, 12, 14, 16], "on_volume_begin": [11, 14], "muon_batch": [11, 14], "n_mu_per_volum": [11, 14], "mu_b": [11, 14], "on_mu_batch_begin": [11, 14], "irradi": [11, 14], "on_scatter_end": [11, 14], "on_mu_batch_end": [11, 14], "on_x0_pred_begin": [11, 14], "overal": [11, 13, 14], "on_x0_pred_end": [11, 14], "cost": [11, 13, 14, 16], "add": [11, 14, 16], "on_volume_batch_end": [11, 14], "on_backwards_begin": [11, 14], "backpropag": [11, 14], "on_backwards_end": [11, 14], "viii": [11, 14], "physic": [11, 14, 16], "absdetectorlay": [11, 14, 16], "conform_detector": [11, 14, 16], "viv": [11, 14], "len": [11, 14], "break": [11, 14], "on_epoch_end": [11, 14], "val_pass": [11, 14], "on_train_end": [11, 14], "yet": 11, "begin": [11, 16], "end": [11, 14], "on_pred_begin": 11, "on_pred_end": 11, "finish": 11, "latest": 11, "on_step_end": 11, "layout": [4, 6, 7, 11, 12, 16], "on_volume_end": 11, "befor": [1, 11], "cycliccallback": [11, 14], "muonresampl": 11, "resampl": 11, "impact": 11, "check_mu_batch": 11, "determin": [11, 12], "prior": [11, 13, 16], "realist": 11, "gen": 11, "until": [11, 14], "replac": 11, "hitrecord": [11, 15], "scatterrecord": [11, 15], "get_record": [11, 15], "plot_hit_dens": [11, 15], "distinct": 11, "_to_df": 11, "save": [11, 14, 15], "panda": 11, "datafram": [11, 15], "plot_scatter_dens": [11, 15], "_reset": 11, "prepar": [11, 16], "as_df": 11, "access": [1, 11], "evalmetr": [11, 14], "lower_metric_bett": 11, "name": [1, 11, 12, 14], "main_metr": 11, "metric": [11, 14], "metriclogg": [11, 14], "live": 11, "feedback": 11, "get_metr": 11, "nomorenan": 11, "introduc": 11, "need": [1, 11, 13, 14, 16], "heatmapgif": 11, "gif_filenam": 11, "heatmap": 11, "gif": 11, "savenam": [11, 14, 15], "savepath": 11, "_create_gif": 11, "imag": 11, "_plot_curr": 11, "optimisation_histori": 11, "gif_length": 11, "show_plot": 11, "show": 11, "varieti": 11, "help": 11, "highlight": 11, "problem": 11, "hyper": 11, "without": 11, "print": [11, 13], "histori": 11, "get_loss_histori": 11, "addition": 11, "control": [1, 11, 13], "second": 11, "notebook": [11, 16], "_build_grid_spec": 11, "gridspec": 11, "snapshot": 11, "_prep_plot": 11, "_snapshot_monitor": 11, "cat_palett": 11, "tab10": 11, "get": 11, "get_result": 11, "loaded_best": 11, "h_mid": 11, "8": [1, 7, 11, 13], "lbl_col": 11, "black": 11, "lbl_sz": 11, "24": 11, "leg_sz": 11, "16": 11, "info": 11, "clean": 11, "grab": 11, "sub": [11, 16], "print_loss": 11, "rc": 11, "patch": 11, "edgecolor": 11, "whitegrid": 11, "tk_col": 11, "tk_sz": 11, "update_plot": 11, "w_mid": 11, "14": 11, "222222222222221": 11, "panelmetriclogg": 11, "logger": [11, 14], "_set_axes_label": 11, "clear": 11, "predhandl": [11, 14], "collect": 11, "numpi": 11, "get_pr": [11, 14], "save2hdf5predhandl": 11, "path": [11, 14, 16], "use_volume_target": 11, "overwrit": 11, "compress": 11, "lzf": 11, "volumetargetpredhandl": 11, "hdf5": [1, 11], "cach": 11, "written": 11, "increment": 11, "lookup": [11, 16], "exist": [1, 11], "same": [11, 12, 13, 16], "string": [11, 14, 16], "_open_fil": 11, "_write_data": 11, "costcoefwarmup": 11, "n_warmup": 11, "warmupcallback": [11, 14], "more": [11, 15, 16], "stabl": 11, "absdetectorloss": [11, 13, 14], "sever": [11, 14], "warm": 11, "phase": 11, "fix": [11, 12, 14, 16], "wait": 11, "warmup": 11, "activ": [1, 11], "enough": [11, 14], "past": 11, "median": 11, "paneloptconfig": 11, "xy_pos_r": 11, "z_pos_rat": 11, "xy_span_r": 11, "budget_r": 11, "desir": 11, "step": [11, 16], "cours": 11, "suitabl": [1, 11], "learn": [11, 14, 16], "rate": [11, 14, 16], "expand": 11, "fraction": [11, 14, 16], "postwarmupcallback": 11, "obejct": 11, "_activ": 11, "check_warmup": 11, "act": [11, 14, 16], "prevent": 11, "flag": 11, "warmup_act": 11, "super": 11, "next": [11, 16], "skip": 11, "unset": 11, "panelupdatelimit": 11, "max_xy_step": 11, "max_z_step": 11, "max_xy_span_step": 11, "being": [11, 13, 14, 16], "affect": [11, 16], "anomol": 11, "enact": 11, "hard": 11, "clamp": 11, "xy_span": [11, 16], "paramat": 11, "goe": 11, "sigmoidpanelsmoothnessschedul": [11, 16], "smooth_rang": 11, "anneal": [11, 16], "schedul": 11, "smooth": [11, 13, 16], "sigmoiddetectorpanel": [11, 16], "unphys": 11, "sensit": [11, 16], "decreas": [11, 14, 16], "edg": [11, 16], "close": [11, 13], "resembl": 11, "appropri": 11, "come": 11, "_set_smooth": 11, "At": 11, "partial_opt": 14, "loss_func": 14, "partial_scatter_inferr": 14, "partial_volume_inferr": 14, "mu_gener": 14, "_build_opt": 14, "qualiti": 14, "life": 14, "val_loss": 14, "broken": 14, "_fit_epoch": 14, "_scan_volum": 14, "support": [1, 14, 16], "mechan": 14, "aspect": [13, 14, 16], "abl": 14, "awar": 14, "iter": [14, 16], "optim": [14, 16], "uninitialis": 14, "plan": 14, "kwarg": 14, "self": 14, "res_opt": 14, "get_detector": [14, 16], "eff_opt": 14, "keyword": 14, "argument": [11, 14], "again": 14, "scan": 14, "prematur": 14, "_sort_cb": 14, "cb": 14, "sort": 14, "telemetri": 14, "cyclic": 14, "cb_savepath": 14, "train_weight": 14, "count": 14, "reach": 14, "passiveyield": [12, 14], "get_opt_lr": 14, "get_opt_mom": 14, "beta_1": [11, 14], "get_param_count": 14, "trainabl": 14, "pred_cb": 14, "pred_callback": 14, "set_opt_lr": 14, "lr": [11, 14], "set_opt_mom": 14, "cyclic_cb": 14, "epoch_bar": 14, "progressbar": 14, "loss_val": 14, "mean_loss": 14, "metric_cb": 14, "metric_log": 14, "passive_bar": 14, "nbprogressbar": 14, "consoleprogressbar": 14, "sb": 14, "skip_opt_step": 14, "stop": 14, "tst_passiv": 14, "volume_id": 14, "volume_inferr": 14, "warmup_cb": 14, "heatmapvolumewrapp": 14, "mu_opt": 14, "norm_opt": 14, "sig_opt": 14, "z_pos_opt": 14, "detectorheatmap": [14, 16], "adjust": 14, "normalis": [13, 14, 16], "from_sav": 14, "instanti": [11, 14, 16], "panelvolumewrapp": [6, 14], "xy_pos_opt": 14, "xy_span_opt": 14, "budget_opt": 14, "global": 15, "produc": [13, 15], "hit_df": 15, "scatter_df": 15, "plot_pred_true_x0": 15, "2d": [15, 16], "revis": 15, "intuit": 15, "init_xyz": 16, "init_xy_span": 16, "m2_cost": 16, "n_cluster": 16, "30": 16, "assign_budget": 16, "musigz_low": 16, "musigz_high": 16, "get_cost": 16, "plot_map": 16, "bpixel": 16, "bsavefig": 16, "filenam": 16, "abslay": 16, "oper": 16, "_n_cost": 16, "learnabl": 16, "correct": [1, 16], "how": [13, 16], "type_label": 16, "encod": [13, 16], "extra": 16, "pure": 16, "togeth": [12, 16], "meter": 16, "ax": 16, "divis": 16, "correctli": 16, "relat": [13, 16], "proper": 16, "determinist": 16, "currenc": [13, 16], "lie": 16, "etc": 16, "forward": [13, 16], "get_lw_z_siz": 16, "modulelist": 16, "_backward_hook": [5, 13, 16], "_buffer": [5, 13, 16], "_forward_hook": [5, 13, 16], "_forward_pre_hook": [5, 13, 16], "_load_state_dict_pre_hook": [5, 13, 16], "_modul": [5, 13, 16], "_non_persistent_buffers_set": [5, 13, 16], "_paramet": [5, 13, 16], "_state_dict_hook": [5, 13, 16], "zeroth": [12, 13, 16], "highest": 16, "necessarili": 16, "investig": 16, "bound": 16, "get_devic": 16, "helper": 16, "rais": 16, "get_panel_zord": 16, "rad_length": 16, "yield_zordered_panel": 16, "yield": [12, 16], "passivelay": 16, "rad_length_func": 16, "step_sz": 16, "01": 16, "pgeant": [1, 16], "develop": [1, 16], "parameteris": 16, "geant": [1, 16], "radiat": 16, "n_x": 16, "n_y": 16, "exampl": [13, 16], "def": 16, "arb_rad_length": 16, "torch": [1, 16], "ones": [13, 16], "lead": 16, "beryllium": [4, 16], "later": 16, "load_rad_length": 16, "select": [13, 16], "travers": 16, "_pdg_scatter": 16, "log_term": 16, "_pgeant_scatt": 16, "abs2idx": 16, "possibl": [13, 16], "seri": 16, "mu_abs2idx": 16, "look": 16, "scatter_and_propag": 16, "prespecifi": 16, "neighbour": 16, "infinit": 16, "thin": 16, "rectangular": 16, "despit": [13, 16], "nn": 16, "continu": [1, 16], "across": 16, "decid": 16, "area": 16, "learnt": 16, "effect": 16, "now": 16, "improv": 16, "resiz": 16, "meet": 16, "interpret": [13, 16], "budget_scal": 16, "match": [13, 16], "overridden": [12, 16], "subclass": 16, "although": 16, "recip": 16, "former": 16, "regist": [1, 16], "hook": [1, 16], "while": 16, "silent": 16, "ignor": 16, "get_gauss": 16, "distribut": [1, 16], "get_scaled_xy_span": 16, "xy2": 16, "li": 16, "border": 16, "slower": [13, 16], "wherea": 16, "transit": 16, "strongli": 16, "approxim": 16, "sig_model": 16, "nomin": [11, 16], "interfac": 16, "conveni": 16, "respons": 16, "could": 16, "volumeclassloss": [13, 16], "low": [11, 16], "front": 16, "zxy": 16, "corner": 16, "spars": 16, "_check_pass": 16, "_configure_budget": 16, "budget_weight": 16, "explicit": 16, "hierarchi": 16, "thu": 16, "_n_layer_cost": 16, "softmax": [13, 16], "slice": 16, "taken": 16, "_get_devic": 16, "system": [1, 16], "amongst": 16, "build_edg": 16, "draw": 16, "xlim": 16, "ylim": 16, "zlim": 16, "pertain": 16, "jupyt": 16, "matplotlib": 16, "you": [1, 16], "rotat": 16, "dimension": 16, "turn": 16, "won": 16, "explicitli": 16, "get_passive_z_rang": 16, "get_pass": 16, "get_rad_cub": [13, 16], "lookup_passive_xyz_coord": 16, "passive_s": 16, "public": 1, "ssh": 1, "your": 1, "github": 1, "profil": 1, "follow": 1, "instruct": 1, "checkout": 1, "packag": 1, "git": 1, "gilesstrong": 1, "mode_muon_tomographi": 1, "gpu": 1, "setup": 1, "conda": 1, "pytorch": 1, "nb_conda_kernel": 1, "tomopt": 1, "python": 1, "pip": 1, "ipykernel": 1, "cu111": 1, "f": 1, "download": 1, "org": [1, 11], "whl": 1, "torch_stabl": 1, "html": 1, "txt": 1, "virtual": 1, "environ": 1, "anaconda": 1, "miniconda": 1, "rememb": 1, "restart": 1, "shell": 1, "attemt": 1, "command": 1, "bashrc": 1, "env": 1, "yml": 1, "choic": 1, "content": 1, "commit": 1, "appar": 1, "ipython": 1, "displai": 1, "pytest": 1, "pull": 1, "ran": 1, "local": 1, "test_muon": 1, "py": 1, "tomo_deepinf": 1, "contact": 1, "definit": 1, "gnn": 1, "export": 1, "jit": 1, "trace": 1, "script": 1, "deepvolumeinfer": 1, "we": 1, "find": 1, "host": 1, "easi": 1, "mode_muon_tomography_scatt": 1, "convers": 1, "csv": 1, "tomopt_sphinx_them": 1, "appear": 1, "doc": 1, "project": 1, "peopl": 1, "contribut": 1, "summaris": 1, "ladlefurnacepassivegener": 4, "x0_furnac": 4, "01757": [4, 7], "fill_materi": 4, "aluminium": 4, "slag_materi": 4, "silicon": 4, "graphit": 4, "abspassivegener": [4, 6, 7, 12], "_gener": [4, 6, 7, 12], "radlengthfunc": [4, 6, 7, 12], "ladlefurnacefilllevelinferr": 4, "pipelin": 4, "remove_ladl": 4, "avg_3d": 4, "avg_lay": 4, "avg_1d": 4, "ridge_1d_0": 4, "max_div_min": 4, "add_batch_dim": 4, "_class2float": 4, "edge_det": 4, "gauss_1d": 4, "gauss_3d": 4, "laplacian_1d": 4, "max_sub_min": 4, "prewit_1d": 4, "ladl": 4, "thick": 4, "ridge_1d_2": 4, "ridge_1d_4": 4, "ridge_1d_8": 4, "ladlefurnaceintclassloss": 4, "pred_int_start": [4, 13], "use_ms": [4, 13], "target_budget": [4, 13], "budget_smooth": [4, 13], "cost_coef": [4, 13], "steep_budget": [4, 13], "debug": [4, 13], "volumeintclassloss": [4, 13], "_targ2int": 4, "_load_state_dict_post_hook": [5, 16], "smallwallspassivegener": 6, "x0_soil": 6, "2624248696430881": 6, "x0_wall": 6, "08022522418503258": 6, "stop_k": 6, "turn_k": 6, "min_length": 6, "min_height": 6, "get_small_walls_volum": 6, "passive_lwh": 6, "det_height": 6, "get_small_walls_volume_wrapp": 6, "ulorrypassivegener": 7, "u_volum": 7, "u_prob": 7, "fill_frac": 7, "x0_lorri": 7, "bkg_materi": 7, "air": 7, "iron": 7, "_compute_s": 7, "_get_block_coord": [7, 12], "onecycl": 11, "opt_nam": 11, "warmup_length": 11, "init_lr": 11, "init_mom": 11, "mid_lr": 11, "mid_mom": 11, "final_lr": 11, "final_mom": 11, "absoptschedul": 11, "smith": 11, "cycl": 11, "evolut": 11, "ab": 11, "1803": 11, "09820": 11, "stabilis": 11, "converg": 11, "moder": 11, "inter_cnt": 11, "absblockpassivegener": 12, "block_siz": 12, "block_size_max_half": 12, "cuboid": 12, "get_data": 12, "randomli": 12, "orient": 12, "half": 12, "known": 12, "blockpresentpassivegener": 12, "potenti": 12, "surround": 12, "n_passiv": 12, "shuffl": 12, "dataset": 12, "randomblockpassivegener": 12, "sort_x0": 12, "enforce_diff_mat": 12, "unless": 12, "voxelpassivegener": 12, "ever": 12, "quantifi": 13, "characteris": 13, "import": 13, "ideal": 13, "task": 13, "algorithm": 13, "gradual": 13, "predefin": 13, "rapidli": 13, "smoothli": 13, "Be": 13, "linearli": 13, "exceed": 13, "less": 13, "steep": 13, "flatten": 13, "slightli": 13, "_get_inference_loss": 13, "quickli": 13, "rise": 13, "veri": 13, "whenev": 13, "_compute_cost_coef": 13, "_get_budget_coef": 13, "switch": 13, "plu": 13, "_get_cost_loss": 13, "reduc": 13, "inv_pred_weight": 13, "unreduc": 13, "absmaterialclassloss": 13, "classifi": 13, "what": 13, "multi": 13, "cross": 13, "entropi": 13, "nll": 13, "bce": 13, "targ2int": 13, "treatabl": 13, "just": 13, "categor": 13, "fill": 13, "integer_class_loss": 13, "icl": 13, "voxelclassloss": 13, "voxelx0loss": 13, "mse": 13, "int_prob": 13, "target_int": 13, "pred_start_int": 13, "reduct": 13, "regress": 13, "applic": 13, "realli": 13, "like": 13, "aim": 13, "penalis": 13, "0154": 13, "greater": 13, "0007": 13, "8773": 13}, "objects": {"tomopt.benchmarks.ladle_furnace": [[4, 0, 0, "-", "data"], [4, 0, 0, "-", "inference"], [4, 0, 0, "-", "loss"]], "tomopt.benchmarks.ladle_furnace.data": [[4, 1, 1, "", "LadleFurnacePassiveGenerator"]], "tomopt.benchmarks.ladle_furnace.data.LadleFurnacePassiveGenerator": [[4, 2, 1, "", "_abc_impl"], [4, 3, 1, "", "_generate"]], "tomopt.benchmarks.ladle_furnace.inference": [[4, 1, 1, "", "LadleFurnaceFillLevelInferrer"]], "tomopt.benchmarks.ladle_furnace.inference.LadleFurnaceFillLevelInferrer": [[4, 2, 1, "", "_abc_impl"], [4, 3, 1, "", "_class2float"], [4, 3, 1, "", "avg_1d"], [4, 3, 1, "", "avg_3d"], [4, 3, 1, "", "avg_layers"], [4, 3, 1, "", "edge_det"], [4, 3, 1, "", "gauss_1d"], [4, 3, 1, "", "gauss_3d"], [4, 3, 1, "", "laplacian_1d"], [4, 3, 1, "", "max_div_min"], [4, 3, 1, "", "max_sub_min"], [4, 3, 1, "", "negative"], [4, 3, 1, "", "prewit_1d"], [4, 3, 1, "", "remove_ladle"], [4, 3, 1, "", "ridge_1d_0"], [4, 3, 1, "", "ridge_1d_2"], [4, 3, 1, "", "ridge_1d_4"], [4, 3, 1, "", "ridge_1d_8"], [4, 3, 1, "", "x02probs"]], "tomopt.benchmarks.ladle_furnace.loss": [[4, 1, 1, "", "LadleFurnaceIntClassLoss"]], "tomopt.benchmarks.ladle_furnace.loss.LadleFurnaceIntClassLoss": [[4, 2, 1, "", "_abc_impl"], [4, 2, 1, "", "_is_full_backward_hook"], [4, 3, 1, "", "_targ2int"], [4, 2, 1, "", "training"]], "tomopt.benchmarks.phi_detector": [[5, 0, 0, "-", "detector"], [5, 0, 0, "-", "inference"]], "tomopt.benchmarks.phi_detector.detector": [[5, 1, 1, "", "PhiDetectorPanel"]], "tomopt.benchmarks.phi_detector.detector.PhiDetectorPanel": [[5, 2, 1, "", "_backward_hooks"], [5, 2, 1, "", "_buffers"], [5, 2, 1, "", "_forward_hooks"], [5, 2, 1, "", "_forward_pre_hooks"], [5, 2, 1, "", "_is_full_backward_hook"], [5, 2, 1, "", "_load_state_dict_post_hooks"], [5, 2, 1, "", "_load_state_dict_pre_hooks"], [5, 2, 1, "", "_modules"], [5, 2, 1, "", "_non_persistent_buffers_set"], [5, 2, 1, "", "_parameters"], [5, 2, 1, "", "_state_dict_hooks"], [5, 3, 1, "", "clamp_params"], [5, 3, 1, "", "get_efficiency"], [5, 3, 1, "", "get_hits"], [5, 3, 1, "", "get_resolution"], [5, 2, 1, "", "training"]], "tomopt.benchmarks.phi_detector.inference": [[5, 1, 1, "", "PhiDetScatterBatch"]], "tomopt.benchmarks.phi_detector.inference.PhiDetScatterBatch": [[5, 3, 1, "", "_compute_tracks"], [5, 3, 1, "", "_extract_hits"], [5, 3, 1, "", "_get_hit_uncs"], [5, 3, 1, "", "get_muon_trajectory"], [5, 3, 1, "", "plot_scatter"]], "tomopt.benchmarks.small_walls": [[6, 0, 0, "-", "data"], [6, 0, 0, "-", "volume"]], "tomopt.benchmarks.small_walls.data": [[6, 1, 1, "", "SmallWallsPassiveGenerator"]], "tomopt.benchmarks.small_walls.data.SmallWallsPassiveGenerator": [[6, 2, 1, "", "_abc_impl"], [6, 3, 1, "", "_generate"]], "tomopt.benchmarks.small_walls.volume": [[6, 4, 1, "", "get_small_walls_volume"], [6, 4, 1, "", "get_small_walls_volume_wrapper"]], "tomopt.benchmarks.u_lorry": [[7, 0, 0, "-", "data"]], "tomopt.benchmarks.u_lorry.data": [[7, 1, 1, "", "ULorryPassiveGenerator"]], "tomopt.benchmarks.u_lorry.data.ULorryPassiveGenerator": [[7, 2, 1, "", "_abc_impl"], [7, 3, 1, "", "_compute_sizes"], [7, 3, 1, "", "_generate"], [7, 3, 1, "", "_get_block_coords"]], "tomopt": [[2, 0, 0, "-", "core"], [2, 0, 0, "-", "utils"], [2, 0, 0, "-", "version"]], "tomopt.inference": [[8, 0, 0, "-", "scattering"], [8, 0, 0, "-", "volume"]], "tomopt.inference.scattering": [[8, 1, 1, "", "GenScatterBatch"], [8, 1, 1, "", "ScatterBatch"]], "tomopt.inference.scattering.GenScatterBatch": [[8, 3, 1, "", "_compute_tracks"]], "tomopt.inference.scattering.ScatterBatch": [[8, 3, 1, "", "_compute_dtheta_dphi_scatter"], [8, 3, 1, "", "_compute_out_var_unc"], [8, 3, 1, "", "_compute_phi"], [8, 3, 1, "", "_compute_scatters"], [8, 3, 1, "", "_compute_theta"], [8, 3, 1, "", "_compute_theta_msc"], [8, 3, 1, "", "_compute_tracks"], [8, 3, 1, "", "_compute_xyz_in"], [8, 3, 1, "", "_compute_xyz_out"], [8, 2, 1, "", "_cross_track"], [8, 2, 1, "", "_dphi"], [8, 2, 1, "", "_dphi_unc"], [8, 2, 1, "", "_dtheta"], [8, 2, 1, "", "_dtheta_unc"], [8, 2, 1, "", "_dtheta_xy"], [8, 2, 1, "", "_dtheta_xy_unc"], [8, 2, 1, "", "_dxy"], [8, 2, 1, "", "_dxy_unc"], [8, 3, 1, "", "_extract_hits"], [8, 3, 1, "", "_filter_scatters"], [8, 2, 1, "", "_gen_hits"], [8, 2, 1, "", "_hit_effs"], [8, 2, 1, "", "_hit_uncs"], [8, 2, 1, "", "_phi_in"], [8, 2, 1, "", "_phi_in_unc"], [8, 2, 1, "", "_phi_out"], [8, 2, 1, "", "_phi_out_unc"], [8, 2, 1, "", "_poca_xyz"], [8, 2, 1, "", "_poca_xyz_unc"], [8, 2, 1, "", "_reco_hits"], [8, 3, 1, "", "_set_dtheta_dphi_scatter"], [8, 2, 1, "", "_theta_in"], [8, 2, 1, "", "_theta_in_unc"], [8, 2, 1, "", "_theta_msc"], [8, 2, 1, "", "_theta_msc_unc"], [8, 2, 1, "", "_theta_out"], [8, 2, 1, "", "_theta_out_unc"], [8, 2, 1, "", "_theta_xy_in"], [8, 2, 1, "", "_theta_xy_in_unc"], [8, 2, 1, "", "_theta_xy_out"], [8, 2, 1, "", "_theta_xy_out_unc"], [8, 2, 1, "", "_total_scatter"], [8, 2, 1, "", "_total_scatter_unc"], [8, 2, 1, "", "_track_coefs"], [8, 2, 1, "", "_track_in"], [8, 2, 1, "", "_track_out"], [8, 2, 1, "", "_track_start_in"], [8, 2, 1, "", "_track_start_out"], [8, 2, 1, "", "_xyz_in"], [8, 2, 1, "", "_xyz_in_unc"], [8, 2, 1, "", "_xyz_out"], [8, 2, 1, "", "_xyz_out_unc"], [8, 5, 1, "", "above_gen_hits"], [8, 5, 1, "", "above_hit_effs"], [8, 5, 1, "", "above_hit_uncs"], [8, 5, 1, "", "above_hits"], [8, 5, 1, "", "below_gen_hits"], [8, 5, 1, "", "below_hit_effs"], [8, 5, 1, "", "below_hit_uncs"], [8, 5, 1, "", "below_hits"], [8, 5, 1, "", "dphi"], [8, 5, 1, "", "dphi_unc"], [8, 5, 1, "", "dtheta"], [8, 5, 1, "", "dtheta_unc"], [8, 5, 1, "", "dtheta_xy"], [8, 5, 1, "", "dtheta_xy_unc"], [8, 5, 1, "", "dxy"], [8, 5, 1, "", "dxy_unc"], [8, 5, 1, "", "gen_hits"], [8, 3, 1, "", "get_muon_trajectory"], [8, 3, 1, "", "get_scatter_mask"], [8, 5, 1, "", "hit_effs"], [8, 5, 1, "", "hit_uncs"], [8, 5, 1, "", "hits"], [8, 5, 1, "", "n_hits_above"], [8, 5, 1, "", "n_hits_below"], [8, 5, 1, "", "phi_in"], [8, 5, 1, "", "phi_in_unc"], [8, 5, 1, "", "phi_out"], [8, 5, 1, "", "phi_out_unc"], [8, 3, 1, "", "plot_scatter"], [8, 5, 1, "", "poca_xyz"], [8, 5, 1, "", "poca_xyz_unc"], [8, 5, 1, "", "reco_hits"], [8, 5, 1, "", "theta_in"], [8, 5, 1, "", "theta_in_unc"], [8, 5, 1, "", "theta_msc"], [8, 5, 1, "", "theta_msc_unc"], [8, 5, 1, "", "theta_out"], [8, 5, 1, "", "theta_out_unc"], [8, 5, 1, "", "theta_xy_in"], [8, 5, 1, "", "theta_xy_in_unc"], [8, 5, 1, "", "theta_xy_out"], [8, 5, 1, "", "theta_xy_out_unc"], [8, 5, 1, "", "total_scatter"], [8, 5, 1, "", "total_scatter_unc"], [8, 5, 1, "", "track_in"], [8, 5, 1, "", "track_out"], [8, 5, 1, "", "track_start_in"], [8, 5, 1, "", "track_start_out"], [8, 5, 1, "", "xyz_in"], [8, 5, 1, "", "xyz_in_unc"], [8, 5, 1, "", "xyz_out"], [8, 5, 1, "", "xyz_out_unc"]], "tomopt.inference.volume": [[8, 1, 1, "", "AbsIntClassifierFromX0"], [8, 1, 1, "", "AbsVolumeInferrer"], [8, 1, 1, "", "AbsX0Inferrer"], [8, 1, 1, "", "DenseBlockClassifierFromX0s"], [8, 1, 1, "", "PanelX0Inferrer"]], "tomopt.inference.volume.AbsIntClassifierFromX0": [[8, 2, 1, "", "_abc_impl"], [8, 3, 1, "", "_reset_vars"], [8, 3, 1, "", "add_scatters"], [8, 3, 1, "", "compute_efficiency"], [8, 3, 1, "", "get_prediction"], [8, 3, 1, "", "x02probs"]], "tomopt.inference.volume.AbsVolumeInferrer": [[8, 2, 1, "", "_abc_impl"], [8, 3, 1, "", "_reset_vars"], [8, 3, 1, "", "add_scatters"], [8, 3, 1, "", "compute_efficiency"], [8, 3, 1, "", "get_prediction"]], "tomopt.inference.volume.AbsX0Inferrer": [[8, 2, 1, "", "_abc_impl"], [8, 3, 1, "", "_combine_scatters"], [8, 3, 1, "", "_get_voxel_zxy_x0_pred_uncs"], [8, 3, 1, "", "_get_voxel_zxy_x0_preds"], [8, 2, 1, "", "_muon_efficiency"], [8, 2, 1, "", "_muon_probs_per_voxel_zxy"], [8, 2, 1, "", "_muon_scatter_var_uncs"], [8, 2, 1, "", "_muon_scatter_vars"], [8, 2, 1, "", "_n_mu"], [8, 3, 1, "", "_reset_vars"], [8, 3, 1, "", "_set_var_dimensions"], [8, 2, 1, "", "_var_order_szs"], [8, 2, 1, "", "_vox_zxy_x0_pred_uncs"], [8, 2, 1, "", "_vox_zxy_x0_preds"], [8, 3, 1, "", "_weighted_mean"], [8, 3, 1, "", "_weighted_rms"], [8, 3, 1, "", "get_prediction"], [8, 5, 1, "", "inv_weights"], [8, 5, 1, "", "muon_efficiency"], [8, 5, 1, "", "muon_mom"], [8, 5, 1, "", "muon_mom_unc"], [8, 5, 1, "", "muon_poca_xyz"], [8, 5, 1, "", "muon_poca_xyz_unc"], [8, 5, 1, "", "muon_probs_per_voxel_zxy"], [8, 5, 1, "", "muon_theta_in"], [8, 5, 1, "", "muon_theta_in_unc"], [8, 5, 1, "", "muon_theta_out"], [8, 5, 1, "", "muon_theta_out_unc"], [8, 5, 1, "", "muon_total_scatter"], [8, 5, 1, "", "muon_total_scatter_unc"], [8, 5, 1, "", "n_mu"], [8, 5, 1, "", "vox_zxy_x0_pred_uncs"], [8, 5, 1, "", "vox_zxy_x0_preds"], [8, 3, 1, "", "x0_from_scatters"]], "tomopt.inference.volume.DenseBlockClassifierFromX0s": [[8, 2, 1, "", "_abc_impl"], [8, 3, 1, "", "_reset_vars"], [8, 3, 1, "", "add_scatters"], [8, 3, 1, "", "compute_efficiency"], [8, 3, 1, "", "get_prediction"], [8, 2, 1, "", "scatter_batches"]], "tomopt.inference.volume.PanelX0Inferrer": [[8, 2, 1, "", "_abc_impl"], [8, 3, 1, "", "compute_efficiency"], [8, 2, 1, "", "scatter_batches"]], "tomopt.muon": [[9, 0, 0, "-", "generation"], [9, 0, 0, "-", "muon_batch"]], "tomopt.muon.generation": [[9, 1, 1, "", "AbsMuonGenerator"], [9, 1, 1, "", "MuonGenerator2015"], [9, 1, 1, "", "MuonGenerator2016"]], "tomopt.muon.generation.AbsMuonGenerator": [[9, 2, 1, "", "_muon_mass2"], [9, 2, 1, "", "_n_bins_energy"], [9, 2, 1, "", "_n_bins_theta"], [9, 3, 1, "", "flux"], [9, 3, 1, "", "from_volume"], [9, 3, 1, "", "generate_set"]], "tomopt.muon.generation.MuonGenerator2015": [[9, 2, 1, "", "P1"], [9, 2, 1, "", "P2"], [9, 2, 1, "", "P3"], [9, 2, 1, "", "P4"], [9, 2, 1, "", "P5"], [9, 3, 1, "", "flux"]], "tomopt.muon.generation.MuonGenerator2016": [[9, 2, 1, "", "E_0"], [9, 2, 1, "", "E_c"], [9, 2, 1, "", "I_0"], [9, 2, 1, "", "N"], [9, 2, 1, "", "Rod"], [9, 2, 1, "", "epinv"], [9, 3, 1, "", "flux"], [9, 2, 1, "", "n"]], "tomopt.muon.muon_batch": [[9, 1, 1, "", "MuonBatch"]], "tomopt.muon.muon_batch.MuonBatch": [[9, 2, 1, "", "_keep_mask"], [9, 5, 1, "", "_mom"], [9, 5, 1, "", "_phi"], [9, 5, 1, "", "_theta"], [9, 5, 1, "", "_x"], [9, 5, 1, "", "_xy"], [9, 5, 1, "", "_xyz"], [9, 5, 1, "", "_y"], [9, 5, 1, "", "_z"], [9, 3, 1, "", "append_hits"], [9, 3, 1, "", "copy"], [9, 3, 1, "", "dtheta"], [9, 3, 1, "", "dtheta_x"], [9, 3, 1, "", "dtheta_y"], [9, 3, 1, "", "filter_muons"], [9, 3, 1, "", "get_hits"], [9, 3, 1, "", "get_xy_mask"], [9, 5, 1, "", "mom"], [9, 5, 1, "", "muons"], [9, 2, 1, "", "p_dim"], [9, 2, 1, "", "ph_dim"], [9, 5, 1, "", "phi"], [9, 3, 1, "", "phi_from_theta_xy"], [9, 3, 1, "", "propagate_d"], [9, 3, 1, "", "propagate_dz"], [9, 5, 1, "", "reco_mom"], [9, 3, 1, "", "remove_upwards_muons"], [9, 3, 1, "", "scatter_dtheta_dphi"], [9, 3, 1, "", "scatter_dxy"], [9, 3, 1, "", "snapshot_xyz"], [9, 2, 1, "", "th_dim"], [9, 5, 1, "", "theta"], [9, 3, 1, "", "theta_from_theta_xy"], [9, 5, 1, "", "theta_x"], [9, 3, 1, "", "theta_x_from_theta_phi"], [9, 5, 1, "", "theta_xy"], [9, 5, 1, "", "theta_y"], [9, 3, 1, "", "theta_y_from_theta_phi"], [9, 5, 1, "", "upwards_muons"], [9, 5, 1, "", "x"], [9, 2, 1, "", "x_dim"], [9, 5, 1, "", "xy"], [9, 5, 1, "", "xyz"], [9, 5, 1, "", "xyz_hist"], [9, 5, 1, "", "y"], [9, 2, 1, "", "y_dim"], [9, 5, 1, "", "z"], [9, 2, 1, "", "z_dim"]], "tomopt.optimisation.callbacks": [[11, 0, 0, "-", "callback"], [11, 0, 0, "-", "cyclic_callbacks"], [11, 0, 0, "-", "data_callbacks"], [11, 0, 0, "-", "detector_callbacks"], [11, 0, 0, "-", "diagnostic_callbacks"], [11, 0, 0, "-", "eval_metric"], [11, 0, 0, "-", "grad_callbacks"], [11, 0, 0, "-", "heatmap_gif"], [11, 0, 0, "-", "monitors"], [11, 0, 0, "module-0", "opt_callbacks"], [11, 0, 0, "-", "pred_callbacks"], [11, 0, 0, "-", "warmup_callbacks"]], "tomopt.optimisation.callbacks.callback": [[11, 1, 1, "", "Callback"]], "tomopt.optimisation.callbacks.callback.Callback": [[11, 3, 1, "", "on_backwards_begin"], [11, 3, 1, "", "on_backwards_end"], [11, 3, 1, "", "on_epoch_begin"], [11, 3, 1, "", "on_epoch_end"], [11, 3, 1, "", "on_mu_batch_begin"], [11, 3, 1, "", "on_mu_batch_end"], [11, 3, 1, "", "on_pred_begin"], [11, 3, 1, "", "on_pred_end"], [11, 3, 1, "", "on_scatter_end"], [11, 3, 1, "", "on_step_end"], [11, 3, 1, "", "on_train_begin"], [11, 3, 1, "", "on_train_end"], [11, 3, 1, "", "on_volume_batch_begin"], [11, 3, 1, "", "on_volume_batch_end"], [11, 3, 1, "", "on_volume_begin"], [11, 3, 1, "", "on_volume_end"], [11, 3, 1, "", "on_x0_pred_begin"], [11, 3, 1, "", "on_x0_pred_end"], [11, 3, 1, "", "set_wrapper"], [11, 2, 1, "", "wrapper"]], "tomopt.optimisation.callbacks.cyclic_callbacks": [[11, 1, 1, "", "CyclicCallback"]], "tomopt.optimisation.callbacks.data_callbacks": [[11, 1, 1, "", "MuonResampler"]], "tomopt.optimisation.callbacks.data_callbacks.MuonResampler": [[11, 3, 1, "", "check_mu_batch"], [11, 3, 1, "", "on_mu_batch_begin"], [11, 3, 1, "", "resample"]], "tomopt.optimisation.callbacks.detector_callbacks": [[11, 1, 1, "", "PanelUpdateLimiter"], [11, 1, 1, "", "SigmoidPanelSmoothnessSchedule"]], "tomopt.optimisation.callbacks.detector_callbacks.PanelUpdateLimiter": [[11, 3, 1, "", "on_backwards_end"], [11, 3, 1, "", "on_step_end"]], "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule": [[11, 3, 1, "", "_activate"], [11, 3, 1, "", "_set_smooth"], [11, 3, 1, "", "on_epoch_begin"], [11, 3, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.diagnostic_callbacks": [[11, 1, 1, "", "HitRecord"], [11, 1, 1, "", "ScatterRecord"]], "tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord": [[11, 3, 1, "", "_to_df"], [11, 3, 1, "", "on_scatter_end"]], "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord": [[11, 3, 1, "", "_reset"], [11, 3, 1, "", "_to_df"], [11, 3, 1, "", "get_record"], [11, 3, 1, "", "on_pred_begin"], [11, 3, 1, "", "on_scatter_end"], [11, 3, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.eval_metric": [[11, 1, 1, "", "EvalMetric"]], "tomopt.optimisation.callbacks.eval_metric.EvalMetric": [[11, 3, 1, "", "get_metric"], [11, 3, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.grad_callbacks": [[11, 1, 1, "", "NoMoreNaNs"]], "tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs": [[11, 3, 1, "", "on_backwards_end"]], "tomopt.optimisation.callbacks.heatmap_gif": [[11, 1, 1, "", "HeatMapGif"]], "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif": [[11, 3, 1, "", "_create_gif"], [11, 3, 1, "", "_plot_current"], [11, 3, 1, "", "_reset"], [11, 3, 1, "", "on_epoch_begin"], [11, 3, 1, "", "on_train_begin"], [11, 3, 1, "", "on_train_end"]], "tomopt.optimisation.callbacks.monitors": [[11, 1, 1, "", "MetricLogger"], [11, 1, 1, "", "PanelMetricLogger"]], "tomopt.optimisation.callbacks.monitors.MetricLogger": [[11, 3, 1, "", "_build_grid_spec"], [11, 3, 1, "", "_create_gif"], [11, 3, 1, "", "_prep_plots"], [11, 3, 1, "", "_reset"], [11, 3, 1, "", "_snapshot_monitor"], [11, 2, 1, "", "cat_palette"], [11, 3, 1, "", "get_loss_history"], [11, 3, 1, "", "get_results"], [11, 2, 1, "", "h_mid"], [11, 2, 1, "", "lbl_col"], [11, 2, 1, "", "lbl_sz"], [11, 2, 1, "", "leg_sz"], [11, 3, 1, "", "on_backwards_end"], [11, 3, 1, "", "on_epoch_begin"], [11, 3, 1, "", "on_epoch_end"], [11, 3, 1, "", "on_train_begin"], [11, 3, 1, "", "on_train_end"], [11, 3, 1, "", "on_volume_batch_end"], [11, 3, 1, "", "on_volume_end"], [11, 3, 1, "", "print_losses"], [11, 2, 1, "", "style"], [11, 2, 1, "", "tk_col"], [11, 2, 1, "", "tk_sz"], [11, 3, 1, "", "update_plot"], [11, 2, 1, "", "w_mid"]], "tomopt.optimisation.callbacks.monitors.PanelMetricLogger": [[11, 3, 1, "", "_build_grid_spec"], [11, 3, 1, "", "_prep_plots"], [11, 3, 1, "", "_reset"], [11, 3, 1, "", "_set_axes_labels"], [11, 3, 1, "", "update_plot"]], "tomopt.optimisation.callbacks.opt_callbacks": [[11, 1, 1, "id0", "OneCycle"]], "tomopt.optimisation.callbacks.opt_callbacks.OneCycle": [[11, 2, 1, "id4", "_abc_impl"], [11, 3, 1, "id5", "_activate"], [11, 3, 1, "id6", "on_epoch_end"], [11, 3, 1, "id7", "schedule"]], "tomopt.optimisation.callbacks.pred_callbacks": [[11, 1, 1, "", "PredHandler"], [11, 1, 1, "", "Save2HDF5PredHandler"], [11, 1, 1, "", "VolumeTargetPredHandler"]], "tomopt.optimisation.callbacks.pred_callbacks.PredHandler": [[11, 3, 1, "", "get_preds"], [11, 3, 1, "", "on_pred_begin"], [11, 3, 1, "", "on_x0_pred_end"]], "tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler": [[11, 3, 1, "", "_open_file"], [11, 3, 1, "", "_write_data"], [11, 3, 1, "", "on_x0_pred_end"]], "tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler": [[11, 3, 1, "", "on_x0_pred_end"]], "tomopt.optimisation.callbacks.warmup_callbacks": [[11, 1, 1, "", "CostCoefWarmup"], [11, 1, 1, "", "PanelOptConfig"], [11, 1, 1, "", "PostWarmupCallback"], [11, 1, 1, "", "WarmupCallback"]], "tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup": [[11, 3, 1, "", "_reset"], [11, 3, 1, "", "on_epoch_end"], [11, 3, 1, "", "on_volume_end"]], "tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig": [[11, 3, 1, "", "_reset"], [11, 3, 1, "", "on_backwards_end"], [11, 3, 1, "", "on_epoch_end"]], "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback": [[11, 3, 1, "", "_activate"], [11, 3, 1, "", "check_warmups"], [11, 3, 1, "", "on_epoch_begin"], [11, 3, 1, "", "on_train_begin"]], "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback": [[11, 3, 1, "", "_reset"], [11, 3, 1, "", "check_warmups"], [11, 3, 1, "", "on_epoch_begin"], [11, 3, 1, "", "on_epoch_end"], [11, 3, 1, "", "on_train_begin"]], "tomopt.optimisation.data": [[12, 0, 0, "-", "passives"]], "tomopt.optimisation.data.passives": [[12, 1, 1, "", "AbsBlockPassiveGenerator"], [12, 1, 1, "", "AbsPassiveGenerator"], [12, 1, 1, "", "BlockPresentPassiveGenerator"], [12, 1, 1, "", "PassiveYielder"], [12, 1, 1, "", "RandomBlockPassiveGenerator"], [12, 1, 1, "", "VoxelPassiveGenerator"]], "tomopt.optimisation.data.passives.AbsBlockPassiveGenerator": [[12, 2, 1, "", "_abc_impl"], [12, 3, 1, "", "_get_block_coords"]], "tomopt.optimisation.data.passives.AbsPassiveGenerator": [[12, 2, 1, "", "_abc_impl"], [12, 3, 1, "", "_generate"], [12, 3, 1, "", "generate"], [12, 3, 1, "", "get_data"]], "tomopt.optimisation.data.passives.BlockPresentPassiveGenerator": [[12, 2, 1, "", "_abc_impl"], [12, 3, 1, "", "_generate"]], "tomopt.optimisation.data.passives.RandomBlockPassiveGenerator": [[12, 2, 1, "", "_abc_impl"], [12, 3, 1, "", "_generate"]], "tomopt.optimisation.data.passives.VoxelPassiveGenerator": [[12, 2, 1, "", "_abc_impl"], [12, 3, 1, "", "_generate"]], "tomopt.optimisation.loss": [[13, 0, 0, "-", "loss"], [13, 0, 0, "-", "sub_losses"]], "tomopt.optimisation.loss.loss": [[13, 1, 1, "", "AbsDetectorLoss"], [13, 1, 1, "", "AbsMaterialClassLoss"], [13, 1, 1, "", "VolumeClassLoss"], [13, 1, 1, "", "VolumeIntClassLoss"], [13, 1, 1, "", "VoxelClassLoss"], [13, 1, 1, "", "VoxelX0Loss"]], "tomopt.optimisation.loss.loss.AbsDetectorLoss": [[13, 2, 1, "", "_abc_impl"], [13, 3, 1, "", "_compute_cost_coef"], [13, 3, 1, "", "_get_budget_coef"], [13, 3, 1, "", "_get_cost_loss"], [13, 3, 1, "", "_get_inference_loss"], [13, 2, 1, "", "_is_full_backward_hook"], [13, 3, 1, "", "forward"], [13, 2, 1, "", "training"]], "tomopt.optimisation.loss.loss.AbsMaterialClassLoss": [[13, 2, 1, "", "_abc_impl"], [13, 2, 1, "", "_backward_hooks"], [13, 2, 1, "", "_buffers"], [13, 2, 1, "", "_forward_hooks"], [13, 2, 1, "", "_forward_pre_hooks"], [13, 2, 1, "", "_is_full_backward_hook"], [13, 2, 1, "", "_load_state_dict_pre_hooks"], [13, 2, 1, "", "_modules"], [13, 2, 1, "", "_non_persistent_buffers_set"], [13, 2, 1, "", "_parameters"], [13, 2, 1, "", "_state_dict_hooks"], [13, 2, 1, "", "sub_losses"], [13, 2, 1, "", "training"]], "tomopt.optimisation.loss.loss.VolumeClassLoss": [[13, 2, 1, "", "_abc_impl"], [13, 2, 1, "", "_backward_hooks"], [13, 2, 1, "", "_buffers"], [13, 2, 1, "", "_forward_hooks"], [13, 2, 1, "", "_forward_pre_hooks"], [13, 3, 1, "", "_get_inference_loss"], [13, 2, 1, "", "_is_full_backward_hook"], [13, 2, 1, "", "_load_state_dict_pre_hooks"], [13, 2, 1, "", "_modules"], [13, 2, 1, "", "_non_persistent_buffers_set"], [13, 2, 1, "", "_parameters"], [13, 2, 1, "", "_state_dict_hooks"], [13, 2, 1, "", "sub_losses"], [13, 2, 1, "", "training"]], "tomopt.optimisation.loss.loss.VolumeIntClassLoss": [[13, 2, 1, "", "_abc_impl"], [13, 2, 1, "", "_backward_hooks"], [13, 2, 1, "", "_buffers"], [13, 2, 1, "", "_forward_hooks"], [13, 2, 1, "", "_forward_pre_hooks"], [13, 3, 1, "", "_get_inference_loss"], [13, 2, 1, "", "_is_full_backward_hook"], [13, 2, 1, "", "_load_state_dict_pre_hooks"], [13, 2, 1, "", "_modules"], [13, 2, 1, "", "_non_persistent_buffers_set"], [13, 2, 1, "", "_parameters"], [13, 2, 1, "", "_state_dict_hooks"], [13, 2, 1, "", "sub_losses"], [13, 2, 1, "", "training"]], "tomopt.optimisation.loss.loss.VoxelClassLoss": [[13, 2, 1, "", "_abc_impl"], [13, 2, 1, "", "_backward_hooks"], [13, 2, 1, "", "_buffers"], [13, 2, 1, "", "_forward_hooks"], [13, 2, 1, "", "_forward_pre_hooks"], [13, 3, 1, "", "_get_inference_loss"], [13, 2, 1, "", "_is_full_backward_hook"], [13, 2, 1, "", "_load_state_dict_pre_hooks"], [13, 2, 1, "", "_modules"], [13, 2, 1, "", "_non_persistent_buffers_set"], [13, 2, 1, "", "_parameters"], [13, 2, 1, "", "_state_dict_hooks"], [13, 2, 1, "", "sub_losses"], [13, 2, 1, "", "training"]], "tomopt.optimisation.loss.loss.VoxelX0Loss": [[13, 2, 1, "", "_abc_impl"], [13, 2, 1, "", "_backward_hooks"], [13, 2, 1, "", "_buffers"], [13, 2, 1, "", "_forward_hooks"], [13, 2, 1, "", "_forward_pre_hooks"], [13, 3, 1, "", "_get_inference_loss"], [13, 2, 1, "", "_is_full_backward_hook"], [13, 2, 1, "", "_load_state_dict_pre_hooks"], [13, 2, 1, "", "_modules"], [13, 2, 1, "", "_non_persistent_buffers_set"], [13, 2, 1, "", "_parameters"], [13, 2, 1, "", "_state_dict_hooks"], [13, 2, 1, "", "sub_losses"], [13, 2, 1, "", "training"]], "tomopt.optimisation.loss.sub_losses": [[13, 4, 1, "", "integer_class_loss"]], "tomopt.optimisation.wrapper": [[14, 0, 0, "-", "volume_wrapper"]], "tomopt.optimisation.wrapper.volume_wrapper": [[14, 1, 1, "", "AbsVolumeWrapper"], [14, 1, 1, "", "FitParams"], [14, 1, 1, "", "HeatMapVolumeWrapper"], [14, 1, 1, "", "PanelVolumeWrapper"]], "tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper": [[14, 2, 1, "", "_abc_impl"], [14, 3, 1, "", "_build_opt"], [14, 3, 1, "", "_fit_epoch"], [14, 3, 1, "", "_scan_volume"], [14, 3, 1, "", "_scan_volumes"], [14, 3, 1, "", "_sort_cbs"], [14, 3, 1, "", "fit"], [14, 3, 1, "", "get_detectors"], [14, 3, 1, "", "get_opt_lr"], [14, 3, 1, "", "get_opt_mom"], [14, 3, 1, "", "get_param_count"], [14, 3, 1, "", "load"], [14, 2, 1, "", "opts"], [14, 3, 1, "", "predict"], [14, 3, 1, "", "save"], [14, 3, 1, "", "set_opt_lr"], [14, 3, 1, "", "set_opt_mom"]], "tomopt.optimisation.wrapper.volume_wrapper.FitParams": [[14, 2, 1, "", "cb_savepath"], [14, 2, 1, "", "cbs"], [14, 2, 1, "", "cyclic_cbs"], [14, 2, 1, "", "device"], [14, 2, 1, "", "epoch"], [14, 2, 1, "", "epoch_bar"], [14, 2, 1, "", "inv_weight"], [14, 2, 1, "", "loss_val"], [14, 2, 1, "", "mean_loss"], [14, 2, 1, "", "metric_cbs"], [14, 2, 1, "", "metric_log"], [14, 2, 1, "", "mu"], [14, 2, 1, "", "mu_bs"], [14, 2, 1, "", "n_epochs"], [14, 2, 1, "", "n_mu_per_volume"], [14, 2, 1, "", "passive_bar"], [14, 2, 1, "", "passive_bs"], [14, 2, 1, "", "pred"], [14, 2, 1, "", "sb"], [14, 2, 1, "", "skip_opt_step"], [14, 2, 1, "", "state"], [14, 2, 1, "", "stop"], [14, 2, 1, "", "trn_passives"], [14, 2, 1, "", "tst_passives"], [14, 2, 1, "", "val_passives"], [14, 2, 1, "", "volume_id"], [14, 2, 1, "", "volume_inferrer"], [14, 2, 1, "", "warmup_cbs"]], "tomopt.optimisation.wrapper.volume_wrapper.HeatMapVolumeWrapper": [[14, 2, 1, "", "_abc_impl"], [14, 3, 1, "", "_build_opt"], [14, 3, 1, "", "from_save"], [14, 2, 1, "", "opts"]], "tomopt.optimisation.wrapper.volume_wrapper.PanelVolumeWrapper": [[14, 2, 1, "", "_abc_impl"], [14, 3, 1, "", "_build_opt"], [14, 3, 1, "", "from_save"], [14, 2, 1, "", "opts"]], "tomopt.plotting": [[15, 0, 0, "-", "appearance"], [15, 0, 0, "-", "diagnostics"], [15, 0, 0, "-", "predictions"]], "tomopt.plotting.diagnostics": [[15, 4, 1, "", "plot_hit_density"], [15, 4, 1, "", "plot_scatter_density"]], "tomopt.plotting.predictions": [[15, 4, 1, "", "plot_pred_true_x0"]], "tomopt.utils": [[2, 4, 1, "", "class_to_x0preds"], [2, 4, 1, "", "jacobian"], [2, 4, 1, "", "x0_from_mixture"], [2, 4, 1, "", "x0targs_to_classtargs"]], "tomopt.volume": [[16, 0, 0, "-", "heatmap"], [16, 0, 0, "-", "layer"], [16, 0, 0, "-", "panel"], [16, 0, 0, "-", "scatter_model"], [16, 0, 0, "-", "volume"]], "tomopt.volume.heatmap": [[16, 1, 1, "", "DetectorHeatMap"]], "tomopt.volume.heatmap.DetectorHeatMap": [[16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "assign_budget"], [16, 3, 1, "", "clamp_params"], [16, 3, 1, "", "get_cost"], [16, 3, 1, "", "get_efficiency"], [16, 3, 1, "", "get_hits"], [16, 3, 1, "", "get_resolution"], [16, 3, 1, "", "get_xy_mask"], [16, 3, 1, "", "plot_map"], [16, 2, 1, "", "training"], [16, 5, 1, "", "x"], [16, 5, 1, "", "y"]], "tomopt.volume.layer": [[16, 1, 1, "", "AbsDetectorLayer"], [16, 1, 1, "", "AbsLayer"], [16, 1, 1, "", "PanelDetectorLayer"], [16, 1, 1, "", "PassiveLayer"]], "tomopt.volume.layer.AbsDetectorLayer": [[16, 2, 1, "", "_abc_impl"], [16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_n_costs"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "assign_budget"], [16, 3, 1, "", "conform_detector"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "get_cost"], [16, 2, 1, "", "training"]], "tomopt.volume.layer.AbsLayer": [[16, 2, 1, "", "_abc_impl"], [16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "get_lw_z_size"], [16, 2, 1, "", "training"]], "tomopt.volume.layer.PanelDetectorLayer": [[16, 2, 1, "", "_abc_impl"], [16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "assign_budget"], [16, 3, 1, "", "conform_detector"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "get_cost"], [16, 3, 1, "", "get_device"], [16, 3, 1, "", "get_panel_zorder"], [16, 2, 1, "", "rad_length"], [16, 2, 1, "", "training"], [16, 3, 1, "", "yield_zordered_panels"]], "tomopt.volume.layer.PassiveLayer": [[16, 2, 1, "", "_abc_impl"], [16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 3, 1, "", "_compute_scattering"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 3, 1, "", "_pdg_scatter"], [16, 3, 1, "", "_pgeant_scatter"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "abs2idx"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "load_rad_length"], [16, 3, 1, "", "mu_abs2idx"], [16, 2, 1, "", "rad_length"], [16, 3, 1, "", "scatter_and_propagate"], [16, 2, 1, "", "training"]], "tomopt.volume.panel": [[16, 1, 1, "", "DetectorPanel"], [16, 1, 1, "", "SigmoidDetectorPanel"]], "tomopt.volume.panel.DetectorPanel": [[16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "assign_budget"], [16, 3, 1, "", "clamp_params"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "get_cost"], [16, 3, 1, "", "get_efficiency"], [16, 3, 1, "", "get_gauss"], [16, 3, 1, "", "get_hits"], [16, 3, 1, "", "get_resolution"], [16, 3, 1, "", "get_scaled_xy_span"], [16, 3, 1, "", "get_xy_mask"], [16, 2, 1, "", "training"], [16, 5, 1, "", "x"], [16, 5, 1, "", "y"]], "tomopt.volume.panel.SigmoidDetectorPanel": [[16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "get_efficiency"], [16, 3, 1, "", "get_resolution"], [16, 3, 1, "", "sig_model"], [16, 5, 1, "", "smooth"], [16, 2, 1, "", "training"]], "tomopt.volume.volume": [[16, 1, 1, "", "Volume"]], "tomopt.volume.volume.Volume": [[16, 2, 1, "", "_backward_hooks"], [16, 2, 1, "", "_buffers"], [16, 3, 1, "", "_check_passives"], [16, 3, 1, "", "_configure_budget"], [16, 2, 1, "", "_forward_hooks"], [16, 2, 1, "", "_forward_pre_hooks"], [16, 3, 1, "", "_get_device"], [16, 2, 1, "", "_is_full_backward_hook"], [16, 2, 1, "", "_load_state_dict_post_hooks"], [16, 2, 1, "", "_load_state_dict_pre_hooks"], [16, 2, 1, "", "_modules"], [16, 2, 1, "", "_non_persistent_buffers_set"], [16, 2, 1, "", "_parameters"], [16, 2, 1, "", "_state_dict_hooks"], [16, 3, 1, "", "assign_budget"], [16, 3, 1, "", "build_edges"], [16, 5, 1, "", "centres"], [16, 5, 1, "", "device"], [16, 3, 1, "", "draw"], [16, 5, 1, "", "edges"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "get_cost"], [16, 3, 1, "", "get_detectors"], [16, 3, 1, "", "get_passive_z_range"], [16, 3, 1, "", "get_passives"], [16, 3, 1, "", "get_rad_cube"], [16, 5, 1, "", "h"], [16, 3, 1, "", "load_rad_length"], [16, 3, 1, "", "lookup_passive_xyz_coords"], [16, 5, 1, "", "lw"], [16, 5, 1, "", "passive_size"], [16, 5, 1, "", "target"], [16, 2, 1, "", "training"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:function", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "function", "Python function"], "5": ["py", "property", "Python property"]}, "titleterms": {"tomopt": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "differenti": 0, "muon": [0, 9], "tomographi": 0, "optimis": [0, 10, 11, 12, 13, 14], "packag": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "overview": 0, "document": 0, "index": 0, "subpackag": [2, 3, 10], "submodul": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "core": 2, "modul": [2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "util": 2, "version": 2, "benchmark": [3, 4, 5, 6, 7], "phi_detector": 5, "detector": 5, "infer": [4, 5, 8], "scatter": 8, "volum": [6, 8, 16], "gener": 9, "muon_batch": 9, "callback": 11, "cyclic_callback": 11, "data_callback": 11, "diagnostic_callback": 11, "eval_metr": 11, "grad_callback": 11, "heatmap_gif": 11, "loss_callback": 11, "monitor": 11, "opt_callback": 11, "pred_callback": 11, "warmup_callback": 11, "detector_callback": 11, "wrapper": 14, "volume_wrapp": 14, "plot": 15, "appear": 15, "diagnost": 15, "predict": 15, "heatmap": 16, "layer": 16, "panel": 16, "scatter_model": 16, "instal": 1, "window": 1, "usag": 1, "test": 1, "extern": 1, "repo": 1, "author": 1, "ladle_furnac": 4, "data": [4, 6, 7, 12], "loss": [4, 13], "small_wal": 6, "u_lorri": 7, "passiv": 12, "sub_loss": 13}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"TomOpt: Differential Muon Tomography Optimisation": [[0, "tomopt-differential-muon-tomography-optimisation"]], "Package overview": [[0, "package-overview"]], "Package documentation": [[0, "package-documentation"]], "Index": [[0, "index"]], "Installation": [[1, "installation"]], "Windows usage": [[1, "windows-usage"]], "Testing": [[1, "testing"]], "External repos": [[1, "external-repos"]], "Authors": [[1, "authors"]], "tomopt.benchmarks package": [[3, "tomopt-benchmarks-package"]], "Subpackages": [[3, "subpackages"], [10, "subpackages"], [2, "subpackages"]], "tomopt.benchmarks.ladle_furnace package": [[4, "tomopt-benchmarks-ladle-furnace-package"]], "Submodules": [[4, "submodules"], [6, "submodules"], [7, "submodules"], [12, "submodules"], [13, "submodules"], [2, "submodules"], [5, "submodules"], [8, "submodules"], [9, "submodules"], [14, "submodules"], [15, "submodules"], [16, "submodules"], [11, "submodules"]], "tomopt.benchmarks.ladle_furnace.data module": [[4, "module-tomopt.benchmarks.ladle_furnace.data"]], "tomopt.benchmarks.ladle_furnace.inference module": [[4, "module-tomopt.benchmarks.ladle_furnace.inference"]], "tomopt.benchmarks.ladle_furnace.loss module": [[4, "module-tomopt.benchmarks.ladle_furnace.loss"]], "tomopt.benchmarks.small_walls package": [[6, "tomopt-benchmarks-small-walls-package"]], "tomopt.benchmarks.small_walls.data module": [[6, "module-tomopt.benchmarks.small_walls.data"]], "tomopt.benchmarks.small_walls.volume module": [[6, "module-tomopt.benchmarks.small_walls.volume"]], "tomopt.benchmarks.u_lorry package": [[7, "tomopt-benchmarks-u-lorry-package"]], "tomopt.benchmarks.u_lorry.data module": [[7, "module-tomopt.benchmarks.u_lorry.data"]], "tomopt.optimisation package": [[10, "tomopt-optimisation-package"]], "tomopt.optimisation.data package": [[12, "tomopt-optimisation-data-package"]], "tomopt.optimisation.data.passives module": [[12, "module-tomopt.optimisation.data.passives"]], "tomopt.optimisation.loss package": [[13, "tomopt-optimisation-loss-package"]], "tomopt.optimisation.loss.loss module": [[13, "module-tomopt.optimisation.loss.loss"]], "tomopt.optimisation.loss.sub_losses module": [[13, "module-tomopt.optimisation.loss.sub_losses"]], "tomopt package": [[2, "tomopt-package"]], "tomopt.core module": [[2, "module-tomopt.core"]], "tomopt.utils module": [[2, "module-tomopt.utils"]], "tomopt.version module": [[2, "module-tomopt.version"]], "tomopt.benchmarks.phi_detector package": [[5, "tomopt-benchmarks-phi-detector-package"]], "tomopt.benchmarks.phi_detector.detector module": [[5, "module-tomopt.benchmarks.phi_detector.detector"]], "tomopt.benchmarks.phi_detector.inference module": [[5, "module-tomopt.benchmarks.phi_detector.inference"]], "tomopt.inference package": [[8, "tomopt-inference-package"]], "tomopt.inference.scattering module": [[8, "module-tomopt.inference.scattering"]], "tomopt.inference.volume module": [[8, "module-tomopt.inference.volume"]], "tomopt.muon package": [[9, "tomopt-muon-package"]], "tomopt.muon.generation module": [[9, "module-tomopt.muon.generation"]], "tomopt.muon.muon_batch module": [[9, "module-tomopt.muon.muon_batch"]], "tomopt.optimisation.wrapper package": [[14, "tomopt-optimisation-wrapper-package"]], "tomopt.optimisation.wrapper.volume_wrapper module": [[14, "module-tomopt.optimisation.wrapper.volume_wrapper"]], "tomopt.plotting package": [[15, "tomopt-plotting-package"]], "tomopt.plotting.appearance module": [[15, "module-tomopt.plotting.appearance"]], "tomopt.plotting.diagnostics module": [[15, "module-tomopt.plotting.diagnostics"]], "tomopt.plotting.predictions module": [[15, "module-tomopt.plotting.predictions"]], "tomopt.volume package": [[16, "tomopt-volume-package"]], "tomopt.volume.heatmap module": [[16, "module-tomopt.volume.heatmap"]], "tomopt.volume.layer module": [[16, "module-tomopt.volume.layer"]], "tomopt.volume.panel module": [[16, "module-tomopt.volume.panel"]], "tomopt.volume.scatter_model module": [[16, "module-tomopt.volume.scatter_model"]], "tomopt.volume.volume module": [[16, "module-tomopt.volume.volume"]], "tomopt.optimisation.callbacks package": [[11, "tomopt-optimisation-callbacks-package"]], "tomopt.optimisation.callbacks.callback module": [[11, "module-tomopt.optimisation.callbacks.callback"]], "tomopt.optimisation.callbacks.cyclic_callbacks module": [[11, "module-tomopt.optimisation.callbacks.cyclic_callbacks"]], "tomopt.optimisation.callbacks.data_callbacks module": [[11, "module-tomopt.optimisation.callbacks.data_callbacks"]], "tomopt.optimisation.callbacks.diagnostic_callbacks module": [[11, "module-tomopt.optimisation.callbacks.diagnostic_callbacks"]], "tomopt.optimisation.callbacks.eval_metric module": [[11, "module-tomopt.optimisation.callbacks.eval_metric"]], "tomopt.optimisation.callbacks.grad_callbacks module": [[11, "module-tomopt.optimisation.callbacks.grad_callbacks"]], "tomopt.optimisation.callbacks.heatmap_gif module": [[11, "module-tomopt.optimisation.callbacks.heatmap_gif"]], "tomopt.optimisation.callbacks.loss_callbacks module": [[11, "tomopt-optimisation-callbacks-loss-callbacks-module"]], "tomopt.optimisation.callbacks.monitors module": [[11, "module-tomopt.optimisation.callbacks.monitors"]], "tomopt.optimisation.callbacks.opt_callbacks module": [[11, "module-tomopt.optimisation.callbacks.opt_callbacks"], [11, "id3"]], "tomopt.optimisation.callbacks.pred_callbacks module": [[11, "module-tomopt.optimisation.callbacks.pred_callbacks"]], "tomopt.optimisation.callbacks.warmup_callbacks module": [[11, "tomopt-optimisation-callbacks-warmup-callbacks-module"]], "tomopt.optimisation.callbacks.detector_callbacks module": [[11, "tomopt-optimisation-callbacks-detector-callbacks-module"]]}, "indexentries": {"callback (class in tomopt.optimisation.callbacks.callback)": [[11, "tomopt.optimisation.callbacks.callback.Callback"]], "costcoefwarmup (class in tomopt.optimisation.callbacks.warmup_callbacks)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup"]], "cycliccallback (class in tomopt.optimisation.callbacks.cyclic_callbacks)": [[11, "tomopt.optimisation.callbacks.cyclic_callbacks.CyclicCallback"]], "evalmetric (class in tomopt.optimisation.callbacks.eval_metric)": [[11, "tomopt.optimisation.callbacks.eval_metric.EvalMetric"]], "heatmapgif (class in tomopt.optimisation.callbacks.heatmap_gif)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif"]], "hitrecord (class in tomopt.optimisation.callbacks.diagnostic_callbacks)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord"]], "metriclogger (class in tomopt.optimisation.callbacks.monitors)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger"]], "muonresampler (class in tomopt.optimisation.callbacks.data_callbacks)": [[11, "tomopt.optimisation.callbacks.data_callbacks.MuonResampler"]], "nomorenans (class in tomopt.optimisation.callbacks.grad_callbacks)": [[11, "tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs"]], "onecycle (class in tomopt.optimisation.callbacks.opt_callbacks)": [[11, "id0"], [11, "tomopt.optimisation.callbacks.opt_callbacks.OneCycle"]], "panelmetriclogger (class in tomopt.optimisation.callbacks.monitors)": [[11, "tomopt.optimisation.callbacks.monitors.PanelMetricLogger"]], "paneloptconfig (class in tomopt.optimisation.callbacks.warmup_callbacks)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig"]], "panelupdatelimiter (class in tomopt.optimisation.callbacks.detector_callbacks)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.PanelUpdateLimiter"]], "postwarmupcallback (class in tomopt.optimisation.callbacks.warmup_callbacks)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback"]], "predhandler (class in tomopt.optimisation.callbacks.pred_callbacks)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.PredHandler"]], "save2hdf5predhandler (class in tomopt.optimisation.callbacks.pred_callbacks)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler"]], "scatterrecord (class in tomopt.optimisation.callbacks.diagnostic_callbacks)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord"]], "sigmoidpanelsmoothnessschedule (class in tomopt.optimisation.callbacks.detector_callbacks)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule"]], "volumetargetpredhandler (class in tomopt.optimisation.callbacks.pred_callbacks)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler"]], "warmupcallback (class in tomopt.optimisation.callbacks.warmup_callbacks)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback"]], "_abc_impl (tomopt.optimisation.callbacks.opt_callbacks.onecycle attribute)": [[11, "id4"], [11, "tomopt.optimisation.callbacks.opt_callbacks.OneCycle._abc_impl"]], "_activate() (tomopt.optimisation.callbacks.detector_callbacks.sigmoidpanelsmoothnessschedule method)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule._activate"]], "_activate() (tomopt.optimisation.callbacks.opt_callbacks.onecycle method)": [[11, "id5"], [11, "tomopt.optimisation.callbacks.opt_callbacks.OneCycle._activate"]], "_activate() (tomopt.optimisation.callbacks.warmup_callbacks.postwarmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback._activate"]], "_build_grid_spec() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger._build_grid_spec"]], "_build_grid_spec() (tomopt.optimisation.callbacks.monitors.panelmetriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.PanelMetricLogger._build_grid_spec"]], "_create_gif() (tomopt.optimisation.callbacks.heatmap_gif.heatmapgif method)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._create_gif"]], "_create_gif() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger._create_gif"]], "_open_file() (tomopt.optimisation.callbacks.pred_callbacks.save2hdf5predhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._open_file"]], "_plot_current() (tomopt.optimisation.callbacks.heatmap_gif.heatmapgif method)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._plot_current"]], "_prep_plots() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger._prep_plots"]], "_prep_plots() (tomopt.optimisation.callbacks.monitors.panelmetriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.PanelMetricLogger._prep_plots"]], "_reset() (tomopt.optimisation.callbacks.diagnostic_callbacks.scatterrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._reset"]], "_reset() (tomopt.optimisation.callbacks.heatmap_gif.heatmapgif method)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._reset"]], "_reset() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger._reset"]], "_reset() (tomopt.optimisation.callbacks.monitors.panelmetriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.PanelMetricLogger._reset"]], "_reset() (tomopt.optimisation.callbacks.warmup_callbacks.costcoefwarmup method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup._reset"]], "_reset() (tomopt.optimisation.callbacks.warmup_callbacks.paneloptconfig method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig._reset"]], "_reset() (tomopt.optimisation.callbacks.warmup_callbacks.warmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback._reset"]], "_set_axes_labels() (tomopt.optimisation.callbacks.monitors.panelmetriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.PanelMetricLogger._set_axes_labels"]], "_set_smooth() (tomopt.optimisation.callbacks.detector_callbacks.sigmoidpanelsmoothnessschedule method)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule._set_smooth"]], "_snapshot_monitor() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger._snapshot_monitor"]], "_to_df() (tomopt.optimisation.callbacks.diagnostic_callbacks.hitrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord._to_df"]], "_to_df() (tomopt.optimisation.callbacks.diagnostic_callbacks.scatterrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._to_df"]], "_write_data() (tomopt.optimisation.callbacks.pred_callbacks.save2hdf5predhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._write_data"]], "cat_palette (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.cat_palette"]], "check_mu_batch() (tomopt.optimisation.callbacks.data_callbacks.muonresampler static method)": [[11, "tomopt.optimisation.callbacks.data_callbacks.MuonResampler.check_mu_batch"]], "check_warmups() (tomopt.optimisation.callbacks.warmup_callbacks.postwarmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback.check_warmups"]], "check_warmups() (tomopt.optimisation.callbacks.warmup_callbacks.warmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.check_warmups"]], "get_loss_history() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.get_loss_history"]], "get_metric() (tomopt.optimisation.callbacks.eval_metric.evalmetric method)": [[11, "tomopt.optimisation.callbacks.eval_metric.EvalMetric.get_metric"]], "get_preds() (tomopt.optimisation.callbacks.pred_callbacks.predhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.PredHandler.get_preds"]], "get_record() (tomopt.optimisation.callbacks.diagnostic_callbacks.scatterrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.get_record"]], "get_results() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.get_results"]], "h_mid (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.h_mid"]], "lbl_col (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_col"]], "lbl_sz (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_sz"]], "leg_sz (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.leg_sz"]], "module": [[11, "module-0"], [11, "module-tomopt.optimisation.callbacks.callback"], [11, "module-tomopt.optimisation.callbacks.cyclic_callbacks"], [11, "module-tomopt.optimisation.callbacks.data_callbacks"], [11, "module-tomopt.optimisation.callbacks.detector_callbacks"], [11, "module-tomopt.optimisation.callbacks.diagnostic_callbacks"], [11, "module-tomopt.optimisation.callbacks.eval_metric"], [11, "module-tomopt.optimisation.callbacks.grad_callbacks"], [11, "module-tomopt.optimisation.callbacks.heatmap_gif"], [11, "module-tomopt.optimisation.callbacks.monitors"], [11, "module-tomopt.optimisation.callbacks.opt_callbacks"], [11, "module-tomopt.optimisation.callbacks.pred_callbacks"], [11, "module-tomopt.optimisation.callbacks.warmup_callbacks"]], "on_backwards_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_backwards_begin"]], "on_backwards_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_backwards_end"]], "on_backwards_end() (tomopt.optimisation.callbacks.detector_callbacks.panelupdatelimiter method)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.PanelUpdateLimiter.on_backwards_end"]], "on_backwards_end() (tomopt.optimisation.callbacks.grad_callbacks.nomorenans method)": [[11, "tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs.on_backwards_end"]], "on_backwards_end() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_backwards_end"]], "on_backwards_end() (tomopt.optimisation.callbacks.warmup_callbacks.paneloptconfig method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_backwards_end"]], "on_epoch_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_epoch_begin"]], "on_epoch_begin() (tomopt.optimisation.callbacks.detector_callbacks.sigmoidpanelsmoothnessschedule method)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule.on_epoch_begin"]], "on_epoch_begin() (tomopt.optimisation.callbacks.heatmap_gif.heatmapgif method)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_epoch_begin"]], "on_epoch_begin() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_begin"]], "on_epoch_begin() (tomopt.optimisation.callbacks.warmup_callbacks.postwarmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback.on_epoch_begin"]], "on_epoch_begin() (tomopt.optimisation.callbacks.warmup_callbacks.warmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_begin"]], "on_epoch_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_epoch_end"]], "on_epoch_end() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_end"]], "on_epoch_end() (tomopt.optimisation.callbacks.opt_callbacks.onecycle method)": [[11, "id6"], [11, "tomopt.optimisation.callbacks.opt_callbacks.OneCycle.on_epoch_end"]], "on_epoch_end() (tomopt.optimisation.callbacks.warmup_callbacks.costcoefwarmup method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_epoch_end"]], "on_epoch_end() (tomopt.optimisation.callbacks.warmup_callbacks.paneloptconfig method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_epoch_end"]], "on_epoch_end() (tomopt.optimisation.callbacks.warmup_callbacks.warmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_end"]], "on_mu_batch_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_begin"]], "on_mu_batch_begin() (tomopt.optimisation.callbacks.data_callbacks.muonresampler method)": [[11, "tomopt.optimisation.callbacks.data_callbacks.MuonResampler.on_mu_batch_begin"]], "on_mu_batch_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_end"]], "on_pred_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_pred_begin"]], "on_pred_begin() (tomopt.optimisation.callbacks.diagnostic_callbacks.scatterrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_pred_begin"]], "on_pred_begin() (tomopt.optimisation.callbacks.pred_callbacks.predhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_pred_begin"]], "on_pred_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_pred_end"]], "on_scatter_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_scatter_end"]], "on_scatter_end() (tomopt.optimisation.callbacks.diagnostic_callbacks.hitrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord.on_scatter_end"]], "on_scatter_end() (tomopt.optimisation.callbacks.diagnostic_callbacks.scatterrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_scatter_end"]], "on_step_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_step_end"]], "on_step_end() (tomopt.optimisation.callbacks.detector_callbacks.panelupdatelimiter method)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.PanelUpdateLimiter.on_step_end"]], "on_train_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.detector_callbacks.sigmoidpanelsmoothnessschedule method)": [[11, "tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.diagnostic_callbacks.scatterrecord method)": [[11, "tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.eval_metric.evalmetric method)": [[11, "tomopt.optimisation.callbacks.eval_metric.EvalMetric.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.heatmap_gif.heatmapgif method)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.warmup_callbacks.postwarmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.PostWarmupCallback.on_train_begin"]], "on_train_begin() (tomopt.optimisation.callbacks.warmup_callbacks.warmupcallback method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_train_begin"]], "on_train_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_train_end"]], "on_train_end() (tomopt.optimisation.callbacks.heatmap_gif.heatmapgif method)": [[11, "tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_end"]], "on_train_end() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_end"]], "on_volume_batch_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_begin"]], "on_volume_batch_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_end"]], "on_volume_batch_end() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_batch_end"]], "on_volume_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_volume_begin"]], "on_volume_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_volume_end"]], "on_volume_end() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_end"]], "on_volume_end() (tomopt.optimisation.callbacks.warmup_callbacks.costcoefwarmup method)": [[11, "tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_volume_end"]], "on_x0_pred_begin() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_begin"]], "on_x0_pred_end() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_end"]], "on_x0_pred_end() (tomopt.optimisation.callbacks.pred_callbacks.predhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_x0_pred_end"]], "on_x0_pred_end() (tomopt.optimisation.callbacks.pred_callbacks.save2hdf5predhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler.on_x0_pred_end"]], "on_x0_pred_end() (tomopt.optimisation.callbacks.pred_callbacks.volumetargetpredhandler method)": [[11, "tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler.on_x0_pred_end"]], "print_losses() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.print_losses"]], "resample() (tomopt.optimisation.callbacks.data_callbacks.muonresampler static method)": [[11, "tomopt.optimisation.callbacks.data_callbacks.MuonResampler.resample"]], "schedule() (tomopt.optimisation.callbacks.opt_callbacks.onecycle method)": [[11, "id7"], [11, "tomopt.optimisation.callbacks.opt_callbacks.OneCycle.schedule"]], "set_wrapper() (tomopt.optimisation.callbacks.callback.callback method)": [[11, "tomopt.optimisation.callbacks.callback.Callback.set_wrapper"]], "style (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.style"]], "tk_col (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.tk_col"]], "tk_sz (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.tk_sz"]], "tomopt.optimisation.callbacks.callback": [[11, "module-tomopt.optimisation.callbacks.callback"]], "tomopt.optimisation.callbacks.cyclic_callbacks": [[11, "module-tomopt.optimisation.callbacks.cyclic_callbacks"]], "tomopt.optimisation.callbacks.data_callbacks": [[11, "module-tomopt.optimisation.callbacks.data_callbacks"]], "tomopt.optimisation.callbacks.detector_callbacks": [[11, "module-tomopt.optimisation.callbacks.detector_callbacks"]], "tomopt.optimisation.callbacks.diagnostic_callbacks": [[11, "module-tomopt.optimisation.callbacks.diagnostic_callbacks"]], "tomopt.optimisation.callbacks.eval_metric": [[11, "module-tomopt.optimisation.callbacks.eval_metric"]], "tomopt.optimisation.callbacks.grad_callbacks": [[11, "module-tomopt.optimisation.callbacks.grad_callbacks"]], "tomopt.optimisation.callbacks.heatmap_gif": [[11, "module-tomopt.optimisation.callbacks.heatmap_gif"]], "tomopt.optimisation.callbacks.monitors": [[11, "module-tomopt.optimisation.callbacks.monitors"]], "tomopt.optimisation.callbacks.opt_callbacks": [[11, "module-0"], [11, "module-tomopt.optimisation.callbacks.opt_callbacks"]], "tomopt.optimisation.callbacks.pred_callbacks": [[11, "module-tomopt.optimisation.callbacks.pred_callbacks"]], "tomopt.optimisation.callbacks.warmup_callbacks": [[11, "module-tomopt.optimisation.callbacks.warmup_callbacks"]], "update_plot() (tomopt.optimisation.callbacks.monitors.metriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.update_plot"]], "update_plot() (tomopt.optimisation.callbacks.monitors.panelmetriclogger method)": [[11, "tomopt.optimisation.callbacks.monitors.PanelMetricLogger.update_plot"]], "w_mid (tomopt.optimisation.callbacks.monitors.metriclogger attribute)": [[11, "tomopt.optimisation.callbacks.monitors.MetricLogger.w_mid"]], "wrapper (tomopt.optimisation.callbacks.callback.callback attribute)": [[11, "tomopt.optimisation.callbacks.callback.Callback.wrapper"]]}})