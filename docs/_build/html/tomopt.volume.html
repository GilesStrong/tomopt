


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tomopt.volume package &mdash; TomOpt  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/tomopt_logo.png"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="tomopt.plotting package" href="tomopt.plotting.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://tomopt.readthedocs.io/en/stable" aria-label="TomOpt"></a>

      <div class="main-menu">
        <ul>
          <!-- <li>
            <a href="">Get Started</a>
          </li> -->

          <!-- <li>
            <a href="">Features</a>
          </li> -->

          <!-- <li>
            <a href="">Ecosystem</a>
          </li> -->

          <!-- <li>
            <a href="">Blog</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a>
          </li>

          <li>
            <a href="https://tomopt.readthedocs.io/en/stable">Docs</a>
          </li>

          <!-- <li>
            <a href="">Resources</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#external-repos">External repos</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#authors">Authors</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tomopt.html">tomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.muon.html">tomopt.muon package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tomopt.volume package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.inference.html">tomopt.inference package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.optimisation.html">tomopt.optimisation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.plotting.html">tomopt.plotting package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.benchmarks.html">tomopt.benchmarks package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="tomopt.html">tomopt package</a> &gt;</li>
        
      <li>tomopt.volume package</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/tomopt.volume.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <section id="tomopt-volume-package">
<h1>tomopt.volume package<a class="headerlink" href="#tomopt-volume-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-tomopt.volume.heatmap">
<span id="tomopt-volume-heatmap-module"></span><h2>tomopt.volume.heatmap module<a class="headerlink" href="#module-tomopt.volume.heatmap" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.heatmap.</span></span><span class="sig-name descname"><span class="pre">DetectorHeatMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_xy_span</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">realistic_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.assign_budget">
<span class="sig-name descname"><span class="pre">assign_budget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.assign_budget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.assign_budget" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.clamp_params">
<span class="sig-name descname"><span class="pre">clamp_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">musigz_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">musigz_high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.clamp_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.clamp_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.get_cost">
<span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.get_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.get_cost" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.get_efficiency">
<span class="sig-name descname"><span class="pre">get_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.get_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.get_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.get_hits">
<span class="sig-name descname"><span class="pre">get_hits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.get_hits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.get_hits" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.get_resolution">
<span class="sig-name descname"><span class="pre">get_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.get_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.get_resolution" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.get_xy_mask">
<span class="sig-name descname"><span class="pre">get_xy_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.get_xy_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.get_xy_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.plot_map">
<span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bpixelate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bsavefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/heatmap.html#DetectorHeatMap.plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.plot_map" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.x" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.heatmap.DetectorHeatMap.y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.heatmap.DetectorHeatMap.y" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.volume.layer">
<span id="tomopt-volume-layer-module"></span><h2>tomopt.volume.layer module<a class="headerlink" href="#module-tomopt.volume.layer" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.layer.</span></span><span class="sig-name descname"><span class="pre">AbsDetectorLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsDetectorLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.volume.layer.AbsLayer" title="tomopt.volume.layer.AbsLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsLayer</span></code></a></p>
<p>Abstract base class for layers designed to record muon positions (hits) using detectors.
Inheriting classes should override a number methods to do with costs/budgets, and hit recording.</p>
<p>When optimisation of operating in ‘fixed budget’ mode, the <a class="reference internal" href="#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> will check the <cite>_n_costs</cite> class attribute of the layer
and will add this to the total number of learnable budget assignments, and pass that number of budgets as an (_n_costs) tensor.
By default this is zero, and inheriting classes should set the correct number during initialisation, or via a new default value.</p>
<p>Some parts of TomOpt act differently on detector layers, according to how the detectors are modelled.
A <cite>type_label</cite> attribute is used to encode extra information, rather than relying purely on the object-instance type.</p>
<p>Multiple detection layers can be grouped together, via their <cite>pos</cite> attribute (position); a string-encoded value.
By default, the inference methods expect detectors above the passive layer to have <cite>pos==’above’</cite>,
and those below the passive volume to have <cite>pos==’below’</cite>.
When retrieving hits from the muon batch, hits will be stacked together with other hits from the same <cite>pos</cite>.</p>
<p>The length and width (<cite>lw</cite>) is the spans of the layer in metres in x and y, and the layer begins at x=0, y=0.
z indicates the position of the top of the layer, in meters, and size is the distance from the top of the layer to the bottom.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By default, the detectors will not scatter muons.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – string-encoding of the detector-layer group</p></li>
<li><p><strong>lw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the length and width of the layer in the x and y axes in metres, starting from (x,y)=(0,0).</p></li>
<li><p><strong>z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the z position of the top of layer in metres. The bottom of the layer will be located at z-size</p></li>
<li><p><strong>size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the voxel size in metres. Must be such that lw is divisible by the specified size.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>) – device on which to place tensors</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer._n_costs">
<span class="sig-name descname"><span class="pre">_n_costs</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer._n_costs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer.assign_budget">
<span class="sig-name descname"><span class="pre">assign_budget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">budget</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsDetectorLayer.assign_budget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer.assign_budget" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes should override this method to correctly assign elements of an (_n_costs) tensor to the parts of the detector to which they relate.
All ordering of the tensor is defined using the function,
but proper optimisation of the budgets may require that the same ordering is used, or that it is deterministic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>budget</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – (_n_costs) tensor of budget assignments in unit currency</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer.conform_detector">
<span class="sig-name descname"><span class="pre">conform_detector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsDetectorLayer.conform_detector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer.conform_detector" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional method designed to ensure that the detector parameters lie within any require boundaries, etc.
It will be called via the <code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeWrapper</span></code> after any update to the detector layers, but by default does nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsDetectorLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes should override this method to implement the passage of the muons through the layer,
and record muon positions (hits) according to the detector model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – the incoming batch of muons</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer.get_cost">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsDetectorLayer.get_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer.get_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes should override this method to return the total, current cost of the detector(s) in the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Single-element tensor with the current total cost of the detector in the layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsDetectorLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.layer.AbsDetectorLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.layer.</span></span><span class="sig-name descname"><span class="pre">AbsLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Abstract base class for volume layers.
The length and width (<cite>lw</cite>) is the spans of the layer in metres in x and y, and the layer begins at x=0, y=0.
z indicates the position of the top of the layer, in meters, and size is the distance from the top of the layer to the bottom.
size is also used to set the length, width, and height of the voxels that make up the layer.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Users must ensure that both the length and width of the layer are divisible by size</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the length and width of the layer in the x and y axes in metres, starting from (x,y)=(0,0).</p></li>
<li><p><strong>z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the z position of the top of layer in metres. The bottom of the layer will be located at z-size</p></li>
<li><p><strong>size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the voxel size in metres. Must be such that lw is divisible by the specified size.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>) – device on which to place tensors</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsLayer._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#tomopt.volume.layer.AbsLayer._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsLayer._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.AbsLayer._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsLayer.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes should override this method to implement the passage of the muons through the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – the incoming batch of muons</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsLayer.get_lw_z_size">
<span class="sig-name descname"><span class="pre">get_lw_z_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#AbsLayer.get_lw_z_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.AbsLayer.get_lw_z_size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The length and width of the layer in the x and y axes in metres, starting from (x,y)=(0,0), the z position of the top of layer in metres, and the voxel size in metres.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.AbsLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.layer.AbsLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.layer.</span></span><span class="sig-name descname"><span class="pre">PanelDetectorLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">panels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer" title="tomopt.volume.layer.AbsDetectorLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsDetectorLayer</span></code></a></p>
<p>A detector layer class that uses multiple “panels” to record muon positions (hits).
Currently, two “panel” types are available: <a class="reference internal" href="#tomopt.volume.panel.DetectorPanel" title="tomopt.volume.panel.DetectorPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorPanel</span></code></a> and <a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap" title="tomopt.volume.heatmap.DetectorHeatMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorHeatMap</span></code></a>
Each detector layer, however, should contain the same type of panel, as this is used to set the <cite>type_label</cite> of the layer.</p>
<p>When optimisation of operating in ‘fixed budget’ mode, the <a class="reference internal" href="#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> will check the <cite>_n_costs</cite> class attribute of the layer
and will add this to the total number of learnable budget assignments, and pass that number of budgets as an (_n_costs) tensor.
During initialisation, this is set to the number of panels in the layer, at time of initialisation.</p>
<p>Multiple detection layers can be grouped together, via their <cite>pos</cite> attribute (position); a string-encoded value.
By default, the inference methods expect detectors above the passive layer to have <cite>pos==’above’</cite>,
and those below the passive volume to have <cite>pos==’below’</cite>.
When retrieving hits from the muon batch, hits will be stacked together with other hits from the same <cite>pos</cite>.</p>
<p>The length and width (<cite>lw</cite>) is the spans of the layer in metres in x and y, and the layer begins at x=0, y=0.
z indicates the position of the top of the layer, in meters, and size is the distance from the top of the layer to the bottom.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The detector panels do not scatter muons.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – string-encoding of the detector-layer group</p></li>
<li><p><strong>lw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the length and width of the layer in the x and y axes in metres, starting from (x,y)=(0,0).</p></li>
<li><p><strong>z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the z position of the top of layer in metres. The bottom of the layer will be located at z-size</p></li>
<li><p><strong>size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the voxel size in metres. Must be such that lw is divisible by the specified size.</p></li>
<li><p><strong>panels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#tomopt.volume.panel.DetectorPanel" title="tomopt.volume.panel.DetectorPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorPanel</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap" title="tomopt.volume.heatmap.DetectorHeatMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorHeatMap</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleList</span></code>]) – The set of initialised panels to contain in the detector layer</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._backward_hooks">
<span class="sig-name descname"><span class="pre">_backward_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._backward_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._buffers">
<span class="sig-name descname"><span class="pre">_buffers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._buffers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._forward_hooks">
<span class="sig-name descname"><span class="pre">_forward_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._forward_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._forward_pre_hooks">
<span class="sig-name descname"><span class="pre">_forward_pre_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._forward_pre_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._load_state_dict_pre_hooks">
<span class="sig-name descname"><span class="pre">_load_state_dict_pre_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._load_state_dict_pre_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._modules">
<span class="sig-name descname"><span class="pre">_modules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Module'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._modules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._non_persistent_buffers_set">
<span class="sig-name descname"><span class="pre">_non_persistent_buffers_set</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._non_persistent_buffers_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._parameters">
<span class="sig-name descname"><span class="pre">_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer._state_dict_hooks">
<span class="sig-name descname"><span class="pre">_state_dict_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer._state_dict_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.assign_budget">
<span class="sig-name descname"><span class="pre">assign_budget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">budget</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.assign_budget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.assign_budget" title="Permalink to this definition">¶</a></dt>
<dd><p>Passes elements of an (_n_costs) tensor to each of the panels’ <cite>assign_budget</cite> method.
Panels are ordered by decreasing z-position, i.e. the zeroth budget element will relate always to the highest panel,
rather than necessarily to the same panel through the optimisation process</p>
<p># TODO investigate whether it would be better to instead assign budgets based on a fixed ordering, rather than the z-order of the panels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>budget</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – (_n_costs) tensor of budget assignments in unit currency</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.conform_detector">
<span class="sig-name descname"><span class="pre">conform_detector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.conform_detector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.conform_detector" title="Permalink to this definition">¶</a></dt>
<dd><p>Loops through panels and calls their <cite>clamp_params</cite> method, to ensure that panels are located within the bounds of the detector layer.
It will be called via the <code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeWrapper</span></code> after any update to the detector layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates muons to each detector panel, in order of decreasing z-position, and calls their <cite>get_hits</cite> method to record hits to the muon batch.
After this, the muons will be propagated to the bottom of the detector layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – the incoming batch of muons</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.get_cost">
<span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.get_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.get_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total, current cost of the detector(s) in the layer, as computed by looping over the panels and summing the returned values of calls to
their <cite>get_cost</cite> methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Single-element tensor with the current total cost of the detector in the layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.get_device">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">panels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.get_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to ensure that all panels are on the same device, and return that device.
If not all the panels are on the same device, then an exception will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>panels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleList</span></code>) – ModuleLists of either <a class="reference internal" href="#tomopt.volume.panel.DetectorPanel" title="tomopt.volume.panel.DetectorPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorPanel</span></code></a> or <a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap" title="tomopt.volume.heatmap.DetectorHeatMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorHeatMap</span></code></a> objects on device</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Device on which all the panels are.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.get_panel_zorder">
<span class="sig-name descname"><span class="pre">get_panel_zorder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.get_panel_zorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.get_panel_zorder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The indices of the panels in order of decreasing z-position.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.rad_length">
<span class="sig-name descname"><span class="pre">rad_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.rad_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PanelDetectorLayer.yield_zordered_panels">
<span class="sig-name descname"><span class="pre">yield_zordered_panels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PanelDetectorLayer.yield_zordered_panels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PanelDetectorLayer.yield_zordered_panels" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the index of the panel, and the panel, in order of decreasing z-position.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <a class="reference internal" href="#tomopt.volume.panel.DetectorPanel" title="tomopt.volume.panel.DetectorPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorPanel</span></code></a>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap" title="tomopt.volume.heatmap.DetectorHeatMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorHeatMap</span></code></a>]]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterator yielding panel indices and panels in order of decreasing z-position.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.layer.</span></span><span class="sig-name descname"><span class="pre">PassiveLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad_length_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.volume.layer.AbsLayer" title="tomopt.volume.layer.AbsLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsLayer</span></code></a></p>
<p>Default layer of containing passive material that scatters the muons.
The length and width (<cite>lw</cite>) is the spans of the layer in metres in x and y, and the layer begins at x=0, y=0.
z indicates the position of the top of the layer, in meters, and size is the distance from the top of the layer to the bottom.
size is also used to set the length, width, and height of the voxels that make up the layer.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Users must ensure that both the length and width of the layer are divisible by size</p>
</div>
<dl class="simple">
<dt>If the layer is set to scatter muons (<cite>rad_length</cite> is not None), then two scattering models are available:</dt><dd><ul class="simple">
<li><p>‘pdg’: The default and currently recommended model based on the Gaussian scattering model described in <a class="reference external" href="https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf">https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf</a></p></li>
<li><p>‘pgeant’: An under-development model based on a parameterised fit to data sampled from GEANT 4</p></li>
</ul>
</dd>
</dl>
<p>The X0 values of each voxel is defined via a “radiation-length function”, which should return an (n_x,n_y) tensor of voxel X0 values,
when called with the <cite>z</cite>, <cite>lw</cite>, and <cite>size</cite> of the layer. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arb_rad_length</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">rad_length</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">list</span><span class="p">((</span><span class="n">lw</span> <span class="o">/</span> <span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">()))</span> <span class="o">*</span> <span class="n">X0</span><span class="p">[</span><span class="s2">&quot;lead&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">rad_length</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">X0</span><span class="p">[</span><span class="s2">&quot;beryllium&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rad_length</span>
</pre></div>
</div>
<p>This function can either be supplied during initialisation, or later via the <cite>load_rad_length</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the length and width of the layer in the x and y axes in metres, starting from (x,y)=(0,0).</p></li>
<li><p><strong>z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the z position of the top of layer in metres. The bottom of the layer will be located at z-size</p></li>
<li><p><strong>size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the voxel size in metres. Must be such that lw is divisible by the specified size.</p></li>
<li><p><strong>rad_length_func</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]) – lookup function that returns an (n_x,n_y) tensor of voxel X0 values for the layer.
After initialisation, the <cite>load_rad_length</cite> method may be used to load X0 layouts.</p></li>
<li><p><strong>step_sz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The step size in metres over which to compute muon propagation and scattering.</p></li>
<li><p><strong>scatter_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – String selection for the scattering model to use. Currently either ‘pdg’ or ‘pgeant’.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>) – device on which to place tensors</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._backward_hooks">
<span class="sig-name descname"><span class="pre">_backward_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._backward_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._buffers">
<span class="sig-name descname"><span class="pre">_buffers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._buffers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._compute_scattering">
<span class="sig-name descname"><span class="pre">_compute_scattering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer._compute_scattering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._compute_scattering" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scattering of the muons using the chosen model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the X0 of the voxel each muon is traversing</p></li>
<li><p><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta angles of the muons. This is used to compute the total flight path of the muons</p></li>
<li><p><strong>theta_x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta_x angles of the muons. This is used to map the dx displacements from the muons’ frames to the volume’s</p></li>
<li><p><strong>theta_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta_y angles of the muons. This is used to map the dy displacements from the muons’ frames to the volume’s</p></li>
<li><p><strong>mom</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the absolute value of the momentum of each muon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dtheta_vol, dphi_vol, dx_vol, &amp; dy_vol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of muon scattering variables in the volume reference frame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._forward_hooks">
<span class="sig-name descname"><span class="pre">_forward_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._forward_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._forward_pre_hooks">
<span class="sig-name descname"><span class="pre">_forward_pre_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._forward_pre_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._load_state_dict_pre_hooks">
<span class="sig-name descname"><span class="pre">_load_state_dict_pre_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._load_state_dict_pre_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._modules">
<span class="sig-name descname"><span class="pre">_modules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Module'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._modules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._non_persistent_buffers_set">
<span class="sig-name descname"><span class="pre">_non_persistent_buffers_set</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._non_persistent_buffers_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._parameters">
<span class="sig-name descname"><span class="pre">_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._pdg_scatter">
<span class="sig-name descname"><span class="pre">_pdg_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_term</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer._pdg_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._pdg_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scattering of the muons using the PDG model <a class="reference external" href="https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf">https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the X0 of the voxel each muon is traversing</p></li>
<li><p><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta angles of the muons. This is used to compute the total flight path of the muons</p></li>
<li><p><strong>theta_x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta_x angles of the muons. This is used to map the dx displacements from the muons’ frames to the volume’s</p></li>
<li><p><strong>theta_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta_y angles of the muons. This is used to map the dy displacements from the muons’ frames to the volume’s</p></li>
<li><p><strong>mom</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the absolute value of the momentum of each muon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dtheta_vol, dphi_vol, dx_vol, &amp; dy_vol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of muon scattering variables in the volume reference frame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._pgeant_scatter">
<span class="sig-name descname"><span class="pre">_pgeant_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer._pgeant_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._pgeant_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scattering of the muons using the parameterised GEANT 4 model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the X0 of the voxel each muon is traversing</p></li>
<li><p><strong>theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta angles of the muons. This is used to compute the total flight path of the muons</p></li>
<li><p><strong>theta_x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta_x angles of the muons. This is used to map the dx displacements from the muons’ frame to the volume’s</p></li>
<li><p><strong>theta_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the theta_y angles of the muons. This is used to map the dy displacements from the muons’ frame to the volume’s</p></li>
<li><p><strong>mom</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) tensor of the absolute value of the momentum of each muon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dtheta_vol, dphi_vol, dx_vol, &amp; dy_vol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of muon scattering variables in the volume reference frame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer._state_dict_hooks">
<span class="sig-name descname"><span class="pre">_state_dict_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer._state_dict_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.abs2idx">
<span class="sig-name descname"><span class="pre">abs2idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer.abs2idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.abs2idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to return the voxel indices in the layer of the supplied tensor of xy positions.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method does NOT account for the possibility of positions may be outside the layer.
Please ensure that positions are inside the layer.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,xy) tensor of absolute xy positions in metres in the volume frame</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(N,xy) tensor of voxel indices in x,y</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates the muons through the layer to the bottom in a series of scattering steps.
If the ‘pdg’ model is used, then the step size is the <cite>step_sz</cite> of the layer, as supplied during initialisation.
If the ‘pgeant’ model is used, the the step size specified as part of the fitting of the scattering model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – the incoming batch of muons</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.load_rad_length">
<span class="sig-name descname"><span class="pre">load_rad_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad_length_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer.load_rad_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.load_rad_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a new X0 layout into the layer voxels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rad_length_func</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – lookup function that returns an (n_x,n_y) tensor of voxel X0 values for the layer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.mu_abs2idx">
<span class="sig-name descname"><span class="pre">mu_abs2idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer.mu_abs2idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.mu_abs2idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to return the voxel indices in the layer that muons currently occupy.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method does NOT account for the possibility of muons being outside the layer.
Please also supply a mask, to only select muons inside the layer.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – muons to look up</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – Optional (muons) Boolean tensor where True indicates that the muon position should be checked</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(muons,2) tensor of voxel indices in x,y</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.rad_length">
<span class="sig-name descname"><span class="pre">rad_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.rad_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.scatter_and_propagate">
<span class="sig-name descname"><span class="pre">scatter_and_propagate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/layer.html#PassiveLayer.scatter_and_propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.scatter_and_propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates the muons through (part of) the layer by the prespecified <cite>step_sz</cite>.
If the layer is set to scatter muons (<cite>rad_length</cite> is not None),
then the muons will also undergo scattering (changes in their trajectories and positions) according to the scatter model of the layer.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When computing scatterings, the X0 used for each muon is that of the starting voxel:
If a muon moves into a neighbouring voxel of differing X0, then this will only be accounted for in the next step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – muons to propagate</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – Optional (N,) Boolean mask. Only muons with True values will be scattered and propagated</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.layer.PassiveLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.layer.PassiveLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.volume.panel">
<span id="tomopt-volume-panel-module"></span><h2>tomopt.volume.panel module<a class="headerlink" href="#module-tomopt.volume.panel" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.panel.</span></span><span class="sig-name descname"><span class="pre">DetectorPanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_xy_span</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">realistic_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Provides an infinitely thin, rectangular panel in the xy plane, centred at a learnable xyz position (metres, in absolute position in the volume frame),
with a learnable width in x and y (<cite>xy_span</cite>).
Whilst this class can be used manually, it is designed to be used by the <a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer" title="tomopt.volume.layer.PanelDetectorLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PanelDetectorLayer</span></code></a> class.</p>
<p>Despite inheriting from <cite>nn.Module</cite>, the <cite>forward</cite> method should not be called, instead passing a <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a> to the
<cite>get_hits</cite> method will return hits corresponding to the muons.</p>
<p>During training model (<cite>.train()</cite> or <cite>.training</cite> is True), a continuous model of the resolution and efficiency will be used, such that hits are differentiable w.r.t.
the learnable parameters of the panel. This means that muons outside of the physical panel will have hits at non-zero resolution.
The current model is a 2D uncorrelated Gaussian in xy, centred over the panel, with width parameters equal to the xy_spans/4,
i.e. the panel is 4-sigma across.</p>
<p>Efficiency is accounted for via a weighting approach, rather than deciding whether to record hits or not, i.e. muons will always record hits,
but the probability of the hit actually being recorded is computable.</p>
<p>During evaluation mode (<cite>.eval()</cite> or <cite>.training</cite> is False), if the panel is set to use <cite>realistic_validation</cite>, then the physical panel will be simulated:
Muons outside the panel have zero resolution and efficiency, resulting in NaN hits positions.
Muons inside the panel will have the full resolution and efficiency of the panel,
but hits will not be differentiable w.r.t. the panel xy-position or xy-span.
If <cite>realistic_validation</cite> is False, then the continuous model will be used also in evaluation mode.</p>
<p>The cost of the panel is based on the supplied cost per metre squared, and the current area of the panel, according to its learnt xy-span.
Panels can also be run in “fixed-budget” mode, in which a cost of the panel is specified via the <cite>.assign_budget</cite> method.
Based on the cost per m^2, the panel will change in effective width, based on its learn xy_span (now an aspect ratio), such that its area results in a cost
equal to the specified cost of the panel.</p>
<p>The resolution and efficiency remain fixed at the specified values.
If intending to run in “fixed-budget” mode, then a budget can be specified here,
however the :class”<cite>~tomopt.volume.volume.Volume</cite> class will pass through all panels and initialise their budgets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – resolution of the panel in m^-1, i.e. a higher value improves the precision on the hit recording</p></li>
<li><p><strong>eff</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – efficiency of the hit recording of the panel, indicated as a probability [0,1]</p></li>
<li><p><strong>init_xyz</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – initial xyz position of the panel in metres in the volume frame</p></li>
<li><p><strong>init_xy_span</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – initial xy-span (total width) of the panel in metres</p></li>
<li><p><strong>m2_cost</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the cost in unit currency of the 1 square metre of detector</p></li>
<li><p><strong>budget</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional required cost of the panel. Based on the span and cost per m^2, the panel will resize to meet the required cost</p></li>
<li><p><strong>realistic_validation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, will use the physical interpretation of the panel during evaluation</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>) – device on which to place tensors</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.assign_budget">
<span class="sig-name descname"><span class="pre">assign_budget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.assign_budget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.assign_budget" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the budget for the panel. This is then used to set a multiplicative coefficient, <cite>budget_scale</cite>, based on the <cite>m2_cost</cite>
which rescales the <cite>xy_span</cite> such that the area of the resulting panel matches the assigned budget.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>budget</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – required cost of the panel in unit currency</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.clamp_params">
<span class="sig-name descname"><span class="pre">clamp_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.clamp_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.clamp_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that the panel is centred within the supplied xyz range,
and that the span of the panel is between xyz_high/20 and xyz_high*10.
A small random number &lt; 1e-3 is added/subtracted to the min/max z position of the panel, to ensure it doesn’t overlap with other panels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz_low</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – minimum x,y,z values for the panel centre in metres</p></li>
<li><p><strong>xyz_high</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – maximum x,y,z values for the panel centre in metres</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_cost">
<span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_cost" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>current cost of the panel according to its area and m2_cost</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_efficiency">
<span class="sig-name descname"><span class="pre">get_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the efficiency of panel at the supplied list of xy points.
If running in evaluation mode with <cite>realistic_validation</cite>,
then these will be the full efficiency of the panel for points inside the panel (indicated by the mask), and zero outside.
Otherwise, the Gaussian model will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) or (N,xy) tensor of positions</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional pre-computed (N,) Boolean mask, where True indicates that the xy point is inside the panel.
Only used in evaluation mode and if <cite>realistic_validation</cite> is True.
If required, but not supplied, than will be computed automatically.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>eff, a (N,)tensor of the efficiency at the xy points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_gauss">
<span class="sig-name descname"><span class="pre">get_gauss</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_gauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_gauss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Normal</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Gaussian distribution, with 2 uncorrelated components corresponding to x and y, centred at the xy position of the panel, and sigma = panel span/4</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_hits">
<span class="sig-name descname"><span class="pre">get_hits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_hits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>The main interaction method with the panel: returns hits for the supplied muons.
Hits consist of:</p>
<blockquote>
<div><p>reco_xy: (muons,xy) tensor of reconstructed xy positions of muons included simulated resolution
gen_xy: (muons,xy) tensor of generator-level (true) xy positions of muons
z: z position of the panel</p>
</div></blockquote>
<p>If running in evaluation mode with <cite>realistic_validation</cite>,
then these will be the full resolution of the panel for points inside the panel (indicated by the mask), and zero outside.
Otherwise, the Gaussian model will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_resolution">
<span class="sig-name descname"><span class="pre">get_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the xy resolutions of panel at the supplied list of xy points.
If running in evaluation mode with <cite>realistic_validation</cite>,
then these will be the full resolution of the panel for points inside the panel (indicated by the mask), and zero outside.
Otherwise, the Gaussian model will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,xy) tensor of positions</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional pre-computed (N,) Boolean mask, where True indicates that the xy point is inside the panel.
Only used in evaluation mode and if <cite>realistic_validation</cite> is True.
If required, but not supplied, than will be computed automatically.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>res, a (N,xy) tensor of the resolution at the xy points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_scaled_xy_span">
<span class="sig-name descname"><span class="pre">get_scaled_xy_span</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_scaled_xy_span"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_scaled_xy_span" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the effective size of the panel by rescaling based on the xy-span, cost per m^2, and budget.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rescaled xy-span such that the panel has a cost equal to the specified budget</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.get_xy_mask">
<span class="sig-name descname"><span class="pre">get_xy_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#DetectorPanel.get_xy_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.get_xy_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes which of the xy points lie inside the physical panel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – xy2) tensor of points</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(N,) Boolean mask, where True indicates the point lies inside the panel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.x" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.panel.DetectorPanel.y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.panel.DetectorPanel.y" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.panel.</span></span><span class="sig-name descname"><span class="pre">SigmoidDetectorPanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_xy_span</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">realistic_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#SigmoidDetectorPanel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.volume.panel.DetectorPanel" title="tomopt.volume.panel.DetectorPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DetectorPanel</span></code></a></p>
<p>Provides an infinitely thin, rectangular panel in the xy plane, centred at a learnable xyz position (metres, in absolute position in the volume frame),
with a learnable width in x and y (<cite>xy_span</cite>).
Whilst this class can be used manually, it is designed to be used by the <a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer" title="tomopt.volume.layer.PanelDetectorLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PanelDetectorLayer</span></code></a> class.</p>
<p>Despite inheriting from <cite>nn.Module</cite>, the <cite>forward</cite> method should not be called, instead passing a <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a> to the
<cite>get_hits</cite> method will return hits corresponding to the muons.</p>
<p>During training model (<cite>.train()</cite> or <cite>.training</cite> is True), a continuous model of the resolution and efficiency will be used, such that hits are
differentiable w.r.t. the learnable parameters of the panel. This means that muons outside of the physical panel will have hits at non-zero resolution.
The model is a 2D uncorrelated Sigmoid in xy, centred over the panel, which pass 0.5 at the xy_spans/2.
The smoothness of the sigmoid affects the rate of change of resolution|efficiency near the edge of the physical border:
A higher smooth value provides a slower change, with higher resolution|efficiency outside the physical panel, whereas a lower smooth value provides a
sharper transition, with lower sensitivity to muons outside the panel (and therefore more strongly approximated a physical panel).
The <a class="reference internal" href="tomopt.optimisation.callbacks.html#tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule" title="tomopt.optimisation.callbacks.detector_callbacks.SigmoidPanelSmoothnessSchedule"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigmoidPanelSmoothnessSchedule</span></code></a> can be used to anneal this smoothness during optimisation.</p>
<p>Efficiency is accounted for via a weighting approach, rather than deciding whether to record hits or not, i.e. muons will always record hits,
but the probability of the hit actually being recorded is computable.</p>
<p>During evaluation mode (<cite>.eval()</cite> or <cite>.training</cite> is False), if the panel is set to use <cite>realistic_validation</cite>, then the physical panel will be simulated:
Muons outside the panel have zero resolution and efficiency, resulting in NaN hits positions.
Muons inside the panel will have the full resolution and efficiency of the panel,
but hits will not be differentiable w.r.t. the panel xy-position or xy-span.
If <cite>realistic_validation</cite> is False, then the continuous model will be used also in evaluation mode.</p>
<p>The cost of the panel is based on the supplied cost per metre squared, and the current area of the panel, according to its learnt xy-span.
Panels can also be run in “fixed-budget” mode, in which a cost of the panel is specified via the <cite>.assign_budget</cite> method.
Based on the cost per m^2, the panel will change in effective width, based on its learn xy_span (now an aspect ratio), such that its area results in a cost
equal to the specified cost of the panel.</p>
<p>The resolution and efficiency remain fixed at the specified values.
If intending to run in “fixed-budget” mode, then a budget can be specified here,
however the :class”<cite>~tomopt.volume.volume.Volume</cite> class will pass through all panels and initialise their budgets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smooth</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – smoothness of the sigmoid: A higher smooth value provides a slower change, with higher resolution|efficiency outside the physical panel,
whereas a lower smooth value provides a sharper transition, with lower sensitivity to muons outside the panel
(and therefore more strongly approximated a physical panel).</p></li>
<li><p><strong>res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – resolution of the panel in m^-1, i.e. a higher value improves the precision on the hit recording</p></li>
<li><p><strong>eff</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – efficiency of the hit recording of the panel, indicated as a probability [0,1]</p></li>
<li><p><strong>init_xyz</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – initial xyz position of the panel in metres in the volume frame</p></li>
<li><p><strong>init_xy_span</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – initial xy-span (total width) of the panel in metres</p></li>
<li><p><strong>m2_cost</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the cost in unit currency of the 1 square metre of detector</p></li>
<li><p><strong>budget</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional required cost of the panel. Based on the span and cost per m^2, the panel will resize to meet the required cost</p></li>
<li><p><strong>realistic_validation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, will use the physical interpretation of the panel during evaluation</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>) – device on which to place tensors</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._backward_hooks">
<span class="sig-name descname"><span class="pre">_backward_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._backward_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._buffers">
<span class="sig-name descname"><span class="pre">_buffers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._buffers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._forward_hooks">
<span class="sig-name descname"><span class="pre">_forward_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._forward_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._forward_pre_hooks">
<span class="sig-name descname"><span class="pre">_forward_pre_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._forward_pre_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._load_state_dict_pre_hooks">
<span class="sig-name descname"><span class="pre">_load_state_dict_pre_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._load_state_dict_pre_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._modules">
<span class="sig-name descname"><span class="pre">_modules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Module'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._modules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._non_persistent_buffers_set">
<span class="sig-name descname"><span class="pre">_non_persistent_buffers_set</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._non_persistent_buffers_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._parameters">
<span class="sig-name descname"><span class="pre">_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel._state_dict_hooks">
<span class="sig-name descname"><span class="pre">_state_dict_hooks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel._state_dict_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel.get_efficiency">
<span class="sig-name descname"><span class="pre">get_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#SigmoidDetectorPanel.get_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel.get_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the efficiency of panel at the supplied list of xy points.
If running in evaluation mode with <cite>realistic_validation</cite>,
then these will be the full efficiency of the panel for points inside the panel (indicated by the mask), and zero outside.
Otherwise, the Sigmoid model will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,) or (N,xy) tensor of positions</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional pre-computed (N,) Boolean mask, where True indicates that the xy point is inside the panel.
Only used in evaluation mode and if <cite>realistic_validation</cite> is True.
If required, but not supplied, than will be computed automatically.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>eff, a (N,)tensor of the efficiency at the xy points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel.get_resolution">
<span class="sig-name descname"><span class="pre">get_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#SigmoidDetectorPanel.get_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel.get_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the xy resolutions of panel at the supplied list of xy points.
If running in evaluation mode with <cite>realistic_validation</cite>,
then these will be the full resolution of the panel for points inside the panel (indicated by the mask), and zero outside.
Otherwise, the Sigmoid model will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,xy) tensor of positions</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional pre-computed (N,) Boolean mask, where True indicates that the xy point is inside the panel.
Only used in evaluation mode and if <cite>realistic_validation</cite> is True.
If required, but not supplied, than will be computed automatically.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>res, a (N,xy) tensor of the resolution at the xy points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel.sig_model">
<span class="sig-name descname"><span class="pre">sig_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/panel.html#SigmoidDetectorPanel.sig_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel.sig_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Models fractional resolution and efficiency from a sigmoid-based model to provide a smooth and differentiable model of a physical detector-panel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,xy) tensor of positions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Multiplicative coefficients for the nominal resolution or efficiency of the panel based on the xy position relative to the panel position and size</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel.smooth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">smooth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel.smooth" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.panel.SigmoidDetectorPanel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.panel.SigmoidDetectorPanel.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.volume.scatter_model">
<span id="tomopt-volume-scatter-model-module"></span><h2>tomopt.volume.scatter_model module<a class="headerlink" href="#module-tomopt.volume.scatter_model" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-tomopt.volume.volume">
<span id="tomopt-volume-volume-module"></span><h2>tomopt.volume.volume module<a class="headerlink" href="#module-tomopt.volume.volume" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.volume.volume.</span></span><span class="sig-name descname"><span class="pre">Volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The <cite>Volume</cite> class is used to contain both passive layers and detector layers.
It is designed to act as an interface to them for the convenience of e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">VolumeWrapper</span></code>,
and to allow new passive-volume layouts to be loaded.</p>
<p>When optimisation is acting in <cite>fixed-budget</cite> mode, the volume is also responsible for learning the optimal assignments of the budget to detector parts.</p>
<p>Volumes can also have a “target” value. This could be e.g. the class ID of the passive-volume configuration which is currently loaded.
See e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">VolumeClassLoss</span></code>.
The target can be set as part of the call to <a class="reference internal" href="#tomopt.volume.volume.Volume.load_rad_length" title="tomopt.volume.volume.Volume.load_rad_length"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_rad_length()</span></code></a></p>
<p>The volume is expected to have its low-left-front (zxy) corner located at (0,0,0) metres.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Currently this class expects that all <a class="reference internal" href="#tomopt.volume.layer.PassiveLayer" title="tomopt.volume.layer.PassiveLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PassiveLayer</span></code></a> s form a single contiguous block,
i.e. it does not currently support sparse, or multiple, passive volumes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleList</span></code>) – <cite>torch.nn.ModuleList</cite> of instantiated <a class="reference internal" href="#tomopt.volume.layer.AbsLayer" title="tomopt.volume.layer.AbsLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsLayer</span></code></a> s, ordered in decreasing z position.</p></li>
<li><p><strong>budget</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – optional budget of the detector in currency units.
Supplying a value for the optional budget, here, will prepare the volume to learn budget assignments to the detectors,
and configure the detectors for the budget.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume._check_passives">
<span class="sig-name descname"><span class="pre">_check_passives</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume._check_passives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume._check_passives" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that all <a class="reference internal" href="#tomopt.volume.layer.PassiveLayer" title="tomopt.volume.layer.PassiveLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PassiveLayer</span></code></a> s have the same sizes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume._configure_budget">
<span class="sig-name descname"><span class="pre">_configure_budget</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume._configure_budget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume._configure_budget" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a list of learnable parameters, which acts as the fractional assignment of the total budget to various parts of the detectors.
The <cite>budget_weights</cite> contains all these assignments with no explicit hierarchy.</p>
<dl>
<dt>Ordering of the elements is thus:</dt><dd><dl class="simple">
<dt>Each layer, as ordered in <cite>layers</cite> is checked for a <cite>get_cost</cite> attribute.</dt><dd><p>If the layer has this attribute, then the number of costs that that layer has <cite>layer._n_costs</cite> is appended to a list, <cite>_n_layer_costs</cite></p>
</dd>
</dl>
<p>A tensor, <cite>budget_weights</cite>, is then instantiated with a number of zero-valued elements equal to the total number of individual detector costs</p>
</dd>
</dl>
<p>When assigning budgets to layers, the budget weights are softmax-normalised to one, and multiplied by the total budget.
Slices of these budgets are then passed to the layers, with the length of the slices being taken from <cite>_n_layer_costs</cite>.</p>
<p>After the <cite>budget_weights</cite> are initialised, the <a class="reference internal" href="#tomopt.volume.volume.Volume.assign_budget" title="tomopt.volume.volume.Volume.assign_budget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_budget()</span></code></a> is called automatically.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume._get_device">
<span class="sig-name descname"><span class="pre">_get_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume._get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume._get_device" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume._is_full_backward_hook">
<span class="sig-name descname"><span class="pre">_is_full_backward_hook</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.volume.Volume._is_full_backward_hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.assign_budget">
<span class="sig-name descname"><span class="pre">assign_budget</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.assign_budget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.assign_budget" title="Permalink to this definition">¶</a></dt>
<dd><p>Distributed the total budget for the detector system amongst the various sub-detectors.
When assigning budgets to layers, the budget weights are softmax-normalised to one, and multiplied by the total budget.
Slices of these budgets are then passed to the layers, with the length of the slices being taken from <cite>_n_layer_costs</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.build_edges">
<span class="sig-name descname"><span class="pre">build_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.build_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.build_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the zxy locations of low-left-front edges of voxels in the passive layers of the volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.centres">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">centres</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.centres" title="Permalink to this definition">¶</a></dt>
<dd><p>zxy locations of the centres of voxels in the passive layers of the volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.device" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.draw">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws the layers/panels pertaining to the volume.
When using this in a jupyter notebook, use “%matplotlib notebook” to have an interactive plot that you can rotate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – the x axis range for the three-dimensional plot.</p></li>
<li><p><strong>ylim</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – the y axis range for the three-dimensional plot.</p></li>
<li><p><strong>zlim</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – the z axis range for the three-dimensional plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.edges">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.edges" title="Permalink to this definition">¶</a></dt>
<dd><p>zxy locations of low-left-front edges of voxels in the passive layers of the volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates muons through each layer in turn.
Prior to propagating muons, the <a class="reference internal" href="#tomopt.volume.volume.Volume.assign_budget" title="tomopt.volume.volume.Volume.assign_budget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_budget()</span></code></a> method is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – the incoming batch of muons</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.get_cost">
<span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.get_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.get_cost" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The total, current cost of the layers in the volume,</dt><dd><p>or the assigned budget for the volume (these two values should be the same but, the actual cost won’t be evaluated explicitly)</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.get_detectors">
<span class="sig-name descname"><span class="pre">get_detectors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.get_detectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.get_detectors" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer" title="tomopt.volume.layer.AbsDetectorLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsDetectorLayer</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of all <a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer" title="tomopt.volume.layer.AbsDetectorLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsDetectorLayer</span></code></a> s in the volume, in the order of <cite>layers</cite> (normally decreasing z position)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.get_passive_z_range">
<span class="sig-name descname"><span class="pre">get_passive_z_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.get_passive_z_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.get_passive_z_range" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The z position of the bottom of the lowest passive layer, and the z position of the top of the highest passive layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.get_passives">
<span class="sig-name descname"><span class="pre">get_passives</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.get_passives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.get_passives" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#tomopt.volume.layer.PassiveLayer" title="tomopt.volume.layer.PassiveLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PassiveLayer</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of all <a class="reference internal" href="#tomopt.volume.layer.PassiveLayer" title="tomopt.volume.layer.PassiveLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PassiveLayer</span></code></a> s in the volume, in the order of <cite>layers</cite> (normally decreasing z position)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.get_rad_cube">
<span class="sig-name descname"><span class="pre">get_rad_cube</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.get_rad_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.get_rad_cube" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>zxy tensor of the values stored in the voxels of the passive volume, with the lowest layer being found in the zeroth z index position.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.h">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.h" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
The height of the volume (including both passive and detector layers), as computed from the z position of the zeroth layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.load_rad_length">
<span class="sig-name descname"><span class="pre">load_rad_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad_length_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.load_rad_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.load_rad_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a new passive-volume configuration.
Optionally, a “target” for the configuration may also be supplied.
This could be e.g. the class ID of the passive-volume configuration which is currently loaded.
See e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">VolumeClassLoss</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad_length_func</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – lookup function that returns an (n_x,n_y) tensor of voxel X0 values for the layer.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – optional target for the new layout</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.lookup_passive_xyz_coords">
<span class="sig-name descname"><span class="pre">lookup_passive_xyz_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/volume/volume.html#Volume.lookup_passive_xyz_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.volume.volume.Volume.lookup_passive_xyz_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks up the voxel indices of the supplied list of absolute positions in the volume frame</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Assumes the same size for all passive layers, and that they form a single contiguous block</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – an (N,xyz) tensor of absolute positions in the volume frame</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>an (N,xyz) tensor of zero-ordered voxel indices, which correspond to the supplied positions</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.lw">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.lw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
The length and width of the passive volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.passive_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">passive_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.passive_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
The size of voxels in the passive volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.target">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.target" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
The “target” value of the volume. This could be e.g. the class ID of the passive-volume configuration which is currently loaded.
See e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">VolumeClassLoss</span></code>.
The target can be set as part of the call to <a class="reference internal" href="#tomopt.volume.volume.Volume.load_rad_length" title="tomopt.volume.volume.Volume.load_rad_length"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_rad_length()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.volume.volume.Volume.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#tomopt.volume.volume.Volume.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="tomopt.plotting.html" class="btn btn-neutral" title="tomopt.plotting package" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021-2022, TomOpt Authors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/GilesStrong/tomopt_sphinx_theme">theme</a> based on a <a href="https://github.com/pytorch/pytorch_sphinx_theme">theme</a> provided by <a href="https://pytorch.org/">PyTorch</a> based on a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">tomopt.volume package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tomopt.volume.heatmap">tomopt.volume.heatmap module</a><ul>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.assign_budget"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.assign_budget()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.clamp_params"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.clamp_params()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.get_cost"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.get_cost()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.get_efficiency"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.get_efficiency()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.get_hits"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.get_hits()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.get_resolution"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.get_resolution()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.get_xy_mask"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.get_xy_mask()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.plot_map"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.plot_map()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.training"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.training</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.x"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.x</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.heatmap.DetectorHeatMap.y"><code class="docutils literal notranslate"><span class="pre">DetectorHeatMap.y</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.volume.layer">tomopt.volume.layer module</a><ul>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer._abc_impl"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer._abc_impl</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer._n_costs"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer._n_costs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer.assign_budget"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer.assign_budget()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer.conform_detector"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer.conform_detector()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer.forward"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer.forward()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer.get_cost"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer.get_cost()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsDetectorLayer.training"><code class="docutils literal notranslate"><span class="pre">AbsDetectorLayer.training</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsLayer"><code class="docutils literal notranslate"><span class="pre">AbsLayer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsLayer._abc_impl"><code class="docutils literal notranslate"><span class="pre">AbsLayer._abc_impl</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsLayer._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">AbsLayer._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsLayer.forward"><code class="docutils literal notranslate"><span class="pre">AbsLayer.forward()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsLayer.get_lw_z_size"><code class="docutils literal notranslate"><span class="pre">AbsLayer.get_lw_z_size()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.AbsLayer.training"><code class="docutils literal notranslate"><span class="pre">AbsLayer.training</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._abc_impl"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._abc_impl</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._backward_hooks"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._backward_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._buffers"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._buffers</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._forward_hooks"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._forward_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._forward_pre_hooks"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._forward_pre_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._load_state_dict_pre_hooks"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._load_state_dict_pre_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._modules"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._modules</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._non_persistent_buffers_set"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._non_persistent_buffers_set</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._parameters"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._parameters</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer._state_dict_hooks"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer._state_dict_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.assign_budget"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.assign_budget()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.conform_detector"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.conform_detector()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.forward"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.forward()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.get_cost"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.get_cost()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.get_device"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.get_device()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.get_panel_zorder"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.get_panel_zorder()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.rad_length"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.rad_length</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.training"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.training</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PanelDetectorLayer.yield_zordered_panels"><code class="docutils literal notranslate"><span class="pre">PanelDetectorLayer.yield_zordered_panels()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer"><code class="docutils literal notranslate"><span class="pre">PassiveLayer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._abc_impl"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._abc_impl</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._backward_hooks"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._backward_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._buffers"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._buffers</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._compute_scattering"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._compute_scattering()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._forward_hooks"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._forward_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._forward_pre_hooks"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._forward_pre_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._load_state_dict_pre_hooks"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._load_state_dict_pre_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._modules"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._modules</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._non_persistent_buffers_set"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._non_persistent_buffers_set</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._parameters"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._parameters</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._pdg_scatter"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._pdg_scatter()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._pgeant_scatter"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._pgeant_scatter()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer._state_dict_hooks"><code class="docutils literal notranslate"><span class="pre">PassiveLayer._state_dict_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.abs2idx"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.abs2idx()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.forward"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.forward()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.load_rad_length"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.load_rad_length()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.mu_abs2idx"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.mu_abs2idx()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.rad_length"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.rad_length</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.scatter_and_propagate"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.scatter_and_propagate()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.layer.PassiveLayer.training"><code class="docutils literal notranslate"><span class="pre">PassiveLayer.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.volume.panel">tomopt.volume.panel module</a><ul>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel"><code class="docutils literal notranslate"><span class="pre">DetectorPanel</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">DetectorPanel._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.assign_budget"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.assign_budget()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.clamp_params"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.clamp_params()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.forward"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.forward()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_cost"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_cost()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_efficiency"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_efficiency()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_gauss"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_gauss()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_hits"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_hits()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_resolution"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_resolution()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_scaled_xy_span"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_scaled_xy_span()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.get_xy_mask"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.get_xy_mask()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.training"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.training</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.x"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.x</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.DetectorPanel.y"><code class="docutils literal notranslate"><span class="pre">DetectorPanel.y</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._backward_hooks"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._backward_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._buffers"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._buffers</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._forward_hooks"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._forward_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._forward_pre_hooks"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._forward_pre_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._load_state_dict_pre_hooks"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._load_state_dict_pre_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._modules"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._modules</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._non_persistent_buffers_set"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._non_persistent_buffers_set</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._parameters"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._parameters</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel._state_dict_hooks"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel._state_dict_hooks</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel.get_efficiency"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel.get_efficiency()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel.get_resolution"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel.get_resolution()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel.sig_model"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel.sig_model()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel.smooth"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel.smooth</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.panel.SigmoidDetectorPanel.training"><code class="docutils literal notranslate"><span class="pre">SigmoidDetectorPanel.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.volume.scatter_model">tomopt.volume.scatter_model module</a></li>
<li><a class="reference internal" href="#module-tomopt.volume.volume">tomopt.volume.volume module</a><ul>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume"><code class="docutils literal notranslate"><span class="pre">Volume</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume._check_passives"><code class="docutils literal notranslate"><span class="pre">Volume._check_passives()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume._configure_budget"><code class="docutils literal notranslate"><span class="pre">Volume._configure_budget()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume._get_device"><code class="docutils literal notranslate"><span class="pre">Volume._get_device()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume._is_full_backward_hook"><code class="docutils literal notranslate"><span class="pre">Volume._is_full_backward_hook</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.assign_budget"><code class="docutils literal notranslate"><span class="pre">Volume.assign_budget()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.build_edges"><code class="docutils literal notranslate"><span class="pre">Volume.build_edges()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.centres"><code class="docutils literal notranslate"><span class="pre">Volume.centres</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.device"><code class="docutils literal notranslate"><span class="pre">Volume.device</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.draw"><code class="docutils literal notranslate"><span class="pre">Volume.draw()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.edges"><code class="docutils literal notranslate"><span class="pre">Volume.edges</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.forward"><code class="docutils literal notranslate"><span class="pre">Volume.forward()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.get_cost"><code class="docutils literal notranslate"><span class="pre">Volume.get_cost()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.get_detectors"><code class="docutils literal notranslate"><span class="pre">Volume.get_detectors()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.get_passive_z_range"><code class="docutils literal notranslate"><span class="pre">Volume.get_passive_z_range()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.get_passives"><code class="docutils literal notranslate"><span class="pre">Volume.get_passives()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.get_rad_cube"><code class="docutils literal notranslate"><span class="pre">Volume.get_rad_cube()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.h"><code class="docutils literal notranslate"><span class="pre">Volume.h</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.load_rad_length"><code class="docutils literal notranslate"><span class="pre">Volume.load_rad_length()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.lookup_passive_xyz_coords"><code class="docutils literal notranslate"><span class="pre">Volume.lookup_passive_xyz_coords()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.lw"><code class="docutils literal notranslate"><span class="pre">Volume.lw</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.passive_size"><code class="docutils literal notranslate"><span class="pre">Volume.passive_size</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.target"><code class="docutils literal notranslate"><span class="pre">Volume.target</span></code></a></li>
<li><a class="reference internal" href="#tomopt.volume.volume.Volume.training"><code class="docutils literal notranslate"><span class="pre">Volume.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/sphinx_highlight.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-6 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer and user documentation for TomOpt</p>
          <a class="with-right-arrow" href="https://tomopt.readthedocs.io/en/stable">View Docs</a>
        </div>

        <div class="col-md-6 text-center">
          <h2>Tutorials</h2>
          <p>Get tutorials for beginner and advanced researchers demonstrating many of the features of TomOpt</p>
          <a class="with-right-arrow" href="https://github.com/GilesStrong/mode_muon_tomography#examples">View Tutorials</a>
        </div>

        <!-- <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="">View Resources</a>
        </div> -->
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://tomopt.readthedocs.io/en/stable" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <!-- <li class="list-title"><a href="https://tomopt.readthedocs.io/en/stable">TomOpt</a></li> -->
            <!-- <li><a href="">Get Started</a></li> -->
            <!-- <li><a href="">Features</a></li> -->
            <!-- <li><a href="">Ecosystem</a></li> -->
            <!-- <li><a href="">Blog</a></li> -->
            <!-- <li><a href="">Resources</a></li> -->
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Support</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a></li>
            <li><a href="https://tomopt.readthedocs.io/en/stable">Docs</a></li>
            <!-- <li><a href="" target="_blank">Discuss</a></li> -->
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CHANGES.md" target="_blank">Change Log</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CITATION.md" target="_blank">Citation</a></li>
            <!-- <li><a href="" target="_blank">Slack</a></li> -->
            <!-- <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CONTRIBUTING.md" target="_blank">Contributing</a></li> -->
          </ul>
        </div>

        <!-- <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    real people should not fill this in and expect good things - do not remove this or risk form bot signups

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="" target="_blank" class="facebook"></a>
            <a href="" target="_blank" class="twitter"></a>
          </div>
        </div> -->
      </div>
    </div>
  </footer>

  <!-- <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div> -->

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://tomopt.readthedocs.io/en/stable" aria-label="TomOpt"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <!-- <li>
            <a href="#">Get Started</a>
          </li> -->

          <!-- <li>
            <a href="#">Features</a>
          </li> -->

          <!-- <li>
            <a href="#">Ecosystem</a>
          </li> -->

          <!-- <li>
            <a href="">Blog</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a>
          </li>

          <li>
            <a href="https://tomopt.readthedocs.io/en/stable">Docs</a>
          </li>

          <!-- <li>
            <a href="">Resources</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>