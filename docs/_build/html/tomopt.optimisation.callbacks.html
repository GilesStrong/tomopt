


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tomopt.optimisation.callbacks package &mdash; TomOpt  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tomopt.optimisation.data package" href="tomopt.optimisation.data.html" />
    <link rel="prev" title="tomopt.optimisation package" href="tomopt.optimisation.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://tomopt.readthedocs.io/en/stable" aria-label="TomOpt"></a>

      <div class="main-menu">
        <ul>
          <!-- <li>
            <a href="">Get Started</a>
          </li> -->

          <!-- <li>
            <a href="">Features</a>
          </li> -->

          <!-- <li>
            <a href="">Ecosystem</a>
          </li> -->

          <!-- <li>
            <a href="">Blog</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a>
          </li>

          <li>
            <a href="https://tomopt.readthedocs.io/en/stable">Docs</a>
          </li>

          <!-- <li>
            <a href="">Resources</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#external-repos">External repos</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#authors">Authors</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tomopt.html">tomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.muon.html">tomopt.muon package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.volume.html">tomopt.volume package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.inference.html">tomopt.inference package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tomopt.optimisation.html">tomopt.optimisation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.plotting.html">tomopt.plotting package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.benchmarks.html">tomopt.benchmarks package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="tomopt.html">tomopt package</a> &gt;</li>
        
          <li><a href="tomopt.optimisation.html">tomopt.optimisation package</a> &gt;</li>
        
      <li>tomopt.optimisation.callbacks package</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/tomopt.optimisation.callbacks.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <section id="tomopt-optimisation-callbacks-package">
<h1>tomopt.optimisation.callbacks package<a class="headerlink" href="#tomopt-optimisation-callbacks-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-tomopt.optimisation.callbacks.callback">
<span id="tomopt-optimisation-callbacks-callback-module"></span><h2>tomopt.optimisation.callbacks.callback module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.callback" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.callback.</span></span><span class="sig-name descname"><span class="pre">Callback</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements the base class from which all callback should inherit.
Callbacks are used as part of the fitting, validation, and prediction methods of <a class="reference internal" href="tomopt.optimisation.wrapper.html#tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper" title="tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeWrapper</span></code></a>.
They can interject at various points, but by default do nothing. Please check in the <a class="reference internal" href="tomopt.optimisation.wrapper.html#tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper" title="tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeWrapper</span></code></a>
to see when exactly their interjections are called.</p>
<p>When writing new callbacks, the <code class="xref py py-class docutils literal notranslate"><span class="pre">VolumeWrapper</span></code>
they are associated with will be their <cite>wrapper</cite> attribute.
Their wrapper will have a <cite>fit_params</cite> attribute (<a class="reference internal" href="tomopt.optimisation.wrapper.html#tomopt.optimisation.wrapper.volume_wrapper.FitParams" title="tomopt.optimisation.wrapper.volume_wrapper.FitParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">FitParams</span></code></a>) which is a data-class style object.
It contains all the objects associated with the fit and predictions, including other callbacks.
Callback interjections should read/write to <cite>wrapper.fit_params</cite>, rather than returning values.</p>
<p>Accounting for the interjection calls (<cite>on_*_begin</cite> &amp; <cite>on_*_end</cite>), the full optimisation loop is:</p>
<ol class="arabic">
<li><p>Associate callbacks with wrapper (<cite>set_wrapper</cite>)</p></li>
<li><p><cite>on_train_begin</cite></p></li>
<li><dl>
<dt>for epoch in <cite>n_epochs</cite>:</dt><dd><ol class="upperalpha">
<li><p><cite>state</cite> = “train”</p></li>
<li><p><cite>on_epoch_begin</cite></p></li>
<li><dl>
<dt>for <cite>p</cite>, <cite>passive</cite> in enumerate(<cite>trn_passives</cite>):</dt><dd><ol class="loweralpha">
<li><dl class="simple">
<dt>if <cite>p</cite> % <cite>passive_bs</cite> == 0:</dt><dd><ol class="lowerroman simple">
<li><p><cite>on_volume_batch_begin</cite></p></li>
<li><p><cite>loss</cite> = 0</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>load <cite>passive</cite> into passive volume</p></li>
<li><p><cite>on_volume_begin</cite></p></li>
<li><dl class="simple">
<dt>for muon_batch in range(<cite>n_mu_per_volume</cite>//<cite>mu_bs</cite>):</dt><dd><ol class="lowerroman simple">
<li><p><cite>on_mu_batch_begin</cite></p></li>
<li><p>Irradiate volume with <cite>mu_bs</cite> muons</p></li>
<li><p>Infer scatter locations</p></li>
<li><p><cite>on_scatter_end</cite></p></li>
<li><p>Infer x0 and append to list of x0 predictions</p></li>
<li><p><cite>on_mu_batch_end</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><p><cite>on_x0_pred_begin</cite></p></li>
<li><p>Compute overall x0 prediction</p></li>
<li><p><cite>on_x0_pred_end</cite></p></li>
<li><p>Compute loss based on precision and cost, and add to <cite>loss</cite></p></li>
<li><dl>
<dt>if <cite>p`+1 % `passive_bs</cite> == 0:</dt><dd><ol class="lowerroman simple">
<li><p><cite>loss</cite> = <cite>loss</cite>/<cite>passive_bs</cite></p></li>
<li><p><cite>on_volume_batch_end</cite></p></li>
<li><p>Zero parameter gradients</p></li>
<li><p><cite>on_backwards_begin</cite></p></li>
<li><p>Backpropagate <cite>loss</cite> and compute parameter gradients</p></li>
<li><p><cite>on_backwards_end</cite></p></li>
<li><p>Update detector parameters</p></li>
</ol>
<p>viii. Ensure detector parameters are within physical boundaries (<cite>AbsDetectorLayer.conform_detector</cite>)
viv. <cite>loss</cite> = 0</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if len(<cite>trn_passives</cite>)-(<cite>p`+1) &lt; `passive_bs</cite>:</dt><dd><ol class="lowerroman simple">
<li><p>Break</p></li>
</ol>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</li>
<li><p><cite>on_epoch_end</cite></p></li>
<li><p><cite>state</cite> = “valid”</p></li>
<li><p><cite>on_epoch_begin</cite></p></li>
<li><dl class="simple">
<dt>for <cite>p</cite>, <cite>passive</cite> in enumerate(<cite>val_passives</cite>):</dt><dd><ol class="loweralpha simple">
<li><dl class="simple">
<dt>if <cite>p</cite> % <cite>passive_bs</cite> == 0:</dt><dd><ol class="lowerroman simple">
<li><p><cite>on_volume_batch_begin</cite></p></li>
<li><p><cite>loss</cite> = 0</p></li>
</ol>
</dd>
</dl>
</li>
<li><p><cite>on_volume_begin</cite></p></li>
<li><dl class="simple">
<dt>for muon_batch in range(<cite>n_mu_per_volume</cite>//<cite>mu_bs</cite>):</dt><dd><ol class="lowerroman simple">
<li><p><cite>on_mu_batch_begin</cite></p></li>
<li><p>Irradiate volume with <cite>mu_bs</cite> muons</p></li>
<li><p>Infer scatter locations</p></li>
<li><p><cite>on_scatter_end</cite></p></li>
<li><p>Infer x0 and append to list of x0 predictions</p></li>
<li><p><cite>on_mu_batch_end</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><p><cite>on_x0_pred_begin</cite></p></li>
<li><p>Compute overall x0 prediction</p></li>
<li><p><cite>on_x0_pred_end</cite></p></li>
<li><p>Compute loss based on precision and cost, and add to <cite>loss</cite></p></li>
<li><dl class="simple">
<dt>if <cite>p`+1 % `passive_bs</cite> == 0:</dt><dd><ol class="lowerroman simple">
<li><p><cite>loss</cite> = <cite>loss</cite>/<cite>passive_bs</cite></p></li>
<li><p><cite>on_volume_batch_end</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if len(<cite>val_passives</cite>)-(<cite>p`+1) &lt; `passive_bs</cite>:</dt><dd><ol class="lowerroman simple">
<li><p>Break</p></li>
</ol>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</li>
<li><p><cite>on_epoch_end</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><p><cite>on_train_end</cite></p></li>
</ol>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_backwards_begin">
<span class="sig-name descname"><span class="pre">on_backwards_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_backwards_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_backwards_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when the loss for a batch of passive volumes has been computed, but not yet backpropagated.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_backwards_end">
<span class="sig-name descname"><span class="pre">on_backwards_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_backwards_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_backwards_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when the loss for a batch of passive volumes has been backpropagated, but parameters have not yet been updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_epoch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_epoch_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a new training or validations epoch begins.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a training or validations epoch ends.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_begin">
<span class="sig-name descname"><span class="pre">on_mu_batch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_mu_batch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a new batch of muons begins.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_end">
<span class="sig-name descname"><span class="pre">on_mu_batch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_mu_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a batch muons ends and scatters have been added to the volume inferrer.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_pred_begin">
<span class="sig-name descname"><span class="pre">on_pred_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_pred_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_pred_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when the wrapper is about to begin in prediction mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_pred_end">
<span class="sig-name descname"><span class="pre">on_pred_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_pred_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_pred_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when the wrapper has finished in prediction mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_scatter_end">
<span class="sig-name descname"><span class="pre">on_scatter_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_scatter_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_scatter_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a scatters for the latest muon batch have been computed, but not yet added to the volume inferrer.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when detector fitting begins.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_train_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when detector fitting ends.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_begin">
<span class="sig-name descname"><span class="pre">on_volume_batch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_volume_batch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a new batch of passive volume layouts is begins.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_end">
<span class="sig-name descname"><span class="pre">on_volume_batch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_volume_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a batch of passive volume layouts is ends.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_volume_begin">
<span class="sig-name descname"><span class="pre">on_volume_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_volume_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a new passive volume layout is loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_volume_end">
<span class="sig-name descname"><span class="pre">on_volume_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_volume_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs when a passive volume layout has been predicted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_begin">
<span class="sig-name descname"><span class="pre">on_x0_pred_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_x0_pred_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_begin" title="Permalink to this definition"></a></dt>
<dd><p>Runs when the all the muons for a volume have propagated, and the volume inferrer is about to make its final prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_end">
<span class="sig-name descname"><span class="pre">on_x0_pred_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.on_x0_pred_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_end" title="Permalink to this definition"></a></dt>
<dd><p>Runs after the volume inferrer has made its final prediction, but before the loss is computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.set_wrapper">
<span class="sig-name descname"><span class="pre">set_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/callback.html#Callback.set_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.set_wrapper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wrapper</strong> (<a class="reference internal" href="tomopt.optimisation.wrapper.html#tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper" title="tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeWrapper</span></code></a>) – Volume wrapper to associate with the callback</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.callback.Callback.wrapper">
<span class="sig-name descname"><span class="pre">wrapper</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="tomopt.optimisation.wrapper.html#tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper" title="tomopt.optimisation.wrapper.volume_wrapper.AbsVolumeWrapper"><span class="pre">AbsVolumeWrapper</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.callback.Callback.wrapper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.optimisation.callbacks.cyclic_callbacks">
<span id="tomopt-optimisation-callbacks-cyclic-callbacks-module"></span><h2>tomopt.optimisation.callbacks.cyclic_callbacks module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.cyclic_callbacks" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.cyclic_callbacks.CyclicCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.cyclic_callbacks.</span></span><span class="sig-name descname"><span class="pre">CyclicCallback</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/cyclic_callbacks.html#CyclicCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.cyclic_callbacks.CyclicCallback" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
</dd></dl>

</section>
<section id="module-tomopt.optimisation.callbacks.data_callbacks">
<span id="tomopt-optimisation-callbacks-data-callbacks-module"></span><h2>tomopt.optimisation.callbacks.data_callbacks module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.data_callbacks" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.data_callbacks.MuonResampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.data_callbacks.</span></span><span class="sig-name descname"><span class="pre">MuonResampler</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/data_callbacks.html#MuonResampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Resamples muons to only include those which will impact the passive volume at some point, even if they only hit the bottom layer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.data_callbacks.MuonResampler.check_mu_batch">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_mu_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/data_callbacks.html#MuonResampler.check_mu_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler.check_mu_batch" title="Permalink to this definition"></a></dt>
<dd><p>Checks the provided muon batch to determine which muons will impact the passive volume at any point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – incoming batch of muons</p></li>
<li><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – Volume containing the passive volume to test against</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(muons) Boolean tensor where True indicates that the muon will hit the passive volume</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.data_callbacks.MuonResampler.on_mu_batch_begin">
<span class="sig-name descname"><span class="pre">on_mu_batch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/data_callbacks.html#MuonResampler.on_mu_batch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler.on_mu_batch_begin" title="Permalink to this definition"></a></dt>
<dd><p>Resamples muons prior to propagation through the volume such that all muons will hit the passive volume.</p>
<p># TODO Add check for realistic validation</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.data_callbacks.MuonResampler.resample">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/data_callbacks.html#MuonResampler.resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler.resample" title="Permalink to this definition"></a></dt>
<dd><p>Resamples muons until all muons will hit the passive volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – xy_p_theta_phi tensor designed to initialise a <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a></p></li>
<li><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – Volume containing the passive volume to test against</p></li>
<li><p><strong>gen</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.generation.AbsMuonGenerator" title="tomopt.muon.generation.AbsMuonGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsMuonGenerator</span></code></a>) – Muon generator for sampling replacement muons</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>xy_p_theta_phi tensor designed to initialise a <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.optimisation.callbacks.diagnostic_callbacks">
<span id="tomopt-optimisation-callbacks-diagnostic-callbacks-module"></span><h2>tomopt.optimisation.callbacks.diagnostic_callbacks module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.diagnostic_callbacks" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.diagnostic_callbacks.</span></span><span class="sig-name descname"><span class="pre">HitRecord</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#HitRecord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord" title="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterRecord</span></code></a></p>
<p>Records the hits of the muons.
Once recorded, the hits can be retrieved via the <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_record()</span></code> method.
<a class="reference internal" href="tomopt.plotting.html#tomopt.plotting.diagnostics.plot_hit_density" title="tomopt.plotting.diagnostics.plot_hit_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_hit_density()</span></code></a> may be used to plot the hit record.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently this callback makes no distinction between different volume layouts, and is designed to used over a single volume layout.</p>
</div>
<p># TODO extend these to create one record per volume</p>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord._to_df">
<span class="sig-name descname"><span class="pre">_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#HitRecord._to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord._to_df" title="Permalink to this definition"></a></dt>
<dd><p>Converts the saved hits to a Pandas DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,xyz) tensor of hits</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of hits</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord.on_scatter_end">
<span class="sig-name descname"><span class="pre">on_scatter_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#HitRecord.on_scatter_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord.on_scatter_end" title="Permalink to this definition"></a></dt>
<dd><p>Saves the hits of the latest muon batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.diagnostic_callbacks.</span></span><span class="sig-name descname"><span class="pre">ScatterRecord</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Records the PoCAs of the muons which are located inside the passive volume.
Once recorded, the PoCAs can be retrieved via the <a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.get_record" title="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.get_record"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_record()</span></code></a> method.
<a class="reference internal" href="tomopt.plotting.html#tomopt.plotting.diagnostics.plot_scatter_density" title="tomopt.plotting.diagnostics.plot_scatter_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_scatter_density()</span></code></a> may be used to plot the scatter record.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently this callback makes no distinction between different volume layouts, and is designed to used over a single volume layout.</p>
</div>
<p># TODO extend these to create one record per volume</p>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._reset" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to record scatters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._to_df">
<span class="sig-name descname"><span class="pre">_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord._to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._to_df" title="Permalink to this definition"></a></dt>
<dd><p>Converts the saved PoCAs to a Pandas DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (N,xyz) tensor of PoCAs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of PoCAs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.get_record">
<span class="sig-name descname"><span class="pre">get_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord.get_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.get_record" title="Permalink to this definition"></a></dt>
<dd><p>Access the recorded PoCAs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>as_df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, will return a Pandas DataFrame, otherwise will return a Tensor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a Pandas DataFrame or a Tensor of recorded PoCAs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_pred_begin">
<span class="sig-name descname"><span class="pre">on_pred_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord.on_pred_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_pred_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to record scatters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_scatter_end">
<span class="sig-name descname"><span class="pre">on_scatter_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord.on_scatter_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_scatter_end" title="Permalink to this definition"></a></dt>
<dd><p>Saves the PoCAs of the latest muon batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/diagnostic_callbacks.html#ScatterRecord.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to record scatters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.optimisation.callbacks.eval_metric">
<span id="tomopt-optimisation-callbacks-eval-metric-module"></span><h2>tomopt.optimisation.callbacks.eval_metric module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.eval_metric" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.eval_metric.EvalMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.eval_metric.</span></span><span class="sig-name descname"><span class="pre">EvalMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lower_metric_better</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">main_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/eval_metric.html#EvalMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.eval_metric.EvalMetric" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Base class from which metric should inherit and implement the computation of their metric values.
Inheriting classes will automatically be detected by <a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger" title="tomopt.optimisation.callbacks.monitors.MetricLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetricLogger</span></code></a>
and included in live feedback if it is the “main metric”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lower_metric_better</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, a lower value of the metric should be considered better than a higher value</p></li>
<li><p><strong>name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – name to associate with the metric</p></li>
<li><p><strong>main_metric</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether this metric should be considered the “main metric”</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.eval_metric.EvalMetric.get_metric">
<span class="sig-name descname"><span class="pre">get_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/eval_metric.html#EvalMetric.get_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.eval_metric.EvalMetric.get_metric" title="Permalink to this definition"></a></dt>
<dd><p>This will be called by <a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_end" title="tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">on_epoch_end()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>metric value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.eval_metric.EvalMetric.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/eval_metric.html#EvalMetric.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.eval_metric.EvalMetric.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that only one main metric is used</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.optimisation.callbacks.grad_callbacks">
<span id="tomopt-optimisation-callbacks-grad-callbacks-module"></span><h2>tomopt.optimisation.callbacks.grad_callbacks module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.grad_callbacks" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.grad_callbacks.</span></span><span class="sig-name descname"><span class="pre">NoMoreNaNs</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/grad_callbacks.html#NoMoreNaNs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Prior to parameter updates, this callback will check and set any NaN gradients to zero.
Updates based on NaN gradients will set the parameter value to NaN.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>As new parameters are introduced, e.g. through new detector models, this callback will need to be updated.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs.on_backwards_end">
<span class="sig-name descname"><span class="pre">on_backwards_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/grad_callbacks.html#NoMoreNaNs.on_backwards_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs.on_backwards_end" title="Permalink to this definition"></a></dt>
<dd><p>Prior to optimiser updates, parameter gradients are checked for NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.optimisation.callbacks.heatmap_gif">
<span id="tomopt-optimisation-callbacks-heatmap-gif-module"></span><h2>tomopt.optimisation.callbacks.heatmap_gif module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.heatmap_gif" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.heatmap_gif.</span></span><span class="sig-name descname"><span class="pre">HeatMapGif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gif_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'heatmap.gif'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Records a gif of the first heatmap in the first detector layer during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gif_filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – savename for the gif (will be appended to the callback savepath)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._create_gif">
<span class="sig-name descname"><span class="pre">_create_gif</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif._create_gif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._create_gif" title="Permalink to this definition"></a></dt>
<dd><p>Combines recorded images into a gif</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._plot_current">
<span class="sig-name descname"><span class="pre">_plot_current</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif._plot_current"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._plot_current" title="Permalink to this definition"></a></dt>
<dd><p>Saves an image of the current layout of the first heatmap in the first detector layer</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._reset" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to record a new gif</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif.on_epoch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_epoch_begin" title="Permalink to this definition"></a></dt>
<dd><p>When a new training epoch begins, saves an image of the current layout of the first heatmap in the first detector layer</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to record a new gif</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/heatmap_gif.html#HeatMapGif.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_end" title="Permalink to this definition"></a></dt>
<dd><p>When training, saves an image of the current layout of the first heatmap in the first detector layer
and then combines all images into a gif</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="tomopt-optimisation-callbacks-loss-callbacks-module">
<h2>tomopt.optimisation.callbacks.loss_callbacks module<a class="headerlink" href="#tomopt-optimisation-callbacks-loss-callbacks-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-tomopt.optimisation.callbacks.monitors">
<span id="tomopt-optimisation-callbacks-monitors-module"></span><h2>tomopt.optimisation.callbacks.monitors module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.monitors" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.monitors.</span></span><span class="sig-name descname"><span class="pre">MetricLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gif_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'optimisation_history.gif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Provides live feedback during training showing a variety of metrics to help highlight problems or test hyper-parameters without completing a full training.
If <cite>show_plots</cite> is false, will instead print training and validation losses at the end of each epoch.
The full history is available as a dictionary by calling <a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.get_loss_history" title="tomopt.optimisation.callbacks.monitors.MetricLogger.get_loss_history"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_loss_history()</span></code></a>.
Additionally, a gif of the optimisation can be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gif_filename</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – optional savename for recording a gif of the optimisation process (None -&gt; no gif)
The savename will be appended to the callback savepath</p></li>
<li><p><strong>show_plots</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to provide live plots during optimisation in notebooks</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger._build_grid_spec">
<span class="sig-name descname"><span class="pre">_build_grid_spec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger._build_grid_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._build_grid_spec" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GridSpec</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The layout object for the plots</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger._create_gif">
<span class="sig-name descname"><span class="pre">_create_gif</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger._create_gif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._create_gif" title="Permalink to this definition"></a></dt>
<dd><p>Combines plot snapshots into a gif</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger._prep_plots">
<span class="sig-name descname"><span class="pre">_prep_plots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger._prep_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._prep_plots" title="Permalink to this definition"></a></dt>
<dd><p>Creates the plots for a new optimisation</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._reset" title="Permalink to this definition"></a></dt>
<dd><p>Resets plots and logs for a new optimisation</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger._snapshot_monitor">
<span class="sig-name descname"><span class="pre">_snapshot_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger._snapshot_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._snapshot_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Saves an image of all the plots in their current state</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.cat_palette">
<span class="sig-name descname"><span class="pre">cat_palette</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab10'</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.cat_palette" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.get_loss_history">
<span class="sig-name descname"><span class="pre">get_loss_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.get_loss_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.get_loss_history" title="Permalink to this definition"></a></dt>
<dd><p>Get the current history of losses and metrics</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tuple of ordered dictionaries: first with losses, second with validation metrics</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>history</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.get_results">
<span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loaded_best</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.get_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.get_results" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.h_mid">
<span class="sig-name descname"><span class="pre">h_mid</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.h_mid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_col">
<span class="sig-name descname"><span class="pre">lbl_col</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'black'</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_col" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_sz">
<span class="sig-name descname"><span class="pre">lbl_sz</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">24</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_sz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.leg_sz">
<span class="sig-name descname"><span class="pre">leg_sz</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.leg_sz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_backwards_end">
<span class="sig-name descname"><span class="pre">on_backwards_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_backwards_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_backwards_end" title="Permalink to this definition"></a></dt>
<dd><p>Records the training loss for the latest volume batch</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_epoch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepare to track new loss and snapshot the plots if training</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>If validation epoch finished, record validation losses, compute info and update plots</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepare for new training</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_end" title="Permalink to this definition"></a></dt>
<dd><p>Cleans up plots, and optionally creates a gif of the training history</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_batch_end">
<span class="sig-name descname"><span class="pre">on_volume_batch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_volume_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_batch_end" title="Permalink to this definition"></a></dt>
<dd><p>Grabs the validation losses for the latest volume batch</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_end">
<span class="sig-name descname"><span class="pre">on_volume_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.on_volume_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_end" title="Permalink to this definition"></a></dt>
<dd><p>Grabs the validation sub-losses for the latest volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.print_losses">
<span class="sig-name descname"><span class="pre">print_losses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.print_losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.print_losses" title="Permalink to this definition"></a></dt>
<dd><p>Print training and validation losses for the last epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.style">
<span class="sig-name descname"><span class="pre">style</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'rc':</span> <span class="pre">{'patch.edgecolor':</span> <span class="pre">'none'},</span> <span class="pre">'style':</span> <span class="pre">'whitegrid'}</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.style" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.tk_col">
<span class="sig-name descname"><span class="pre">tk_col</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'black'</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.tk_col" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.tk_sz">
<span class="sig-name descname"><span class="pre">tk_sz</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.tk_sz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.update_plot">
<span class="sig-name descname"><span class="pre">update_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#MetricLogger.update_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.update_plot" title="Permalink to this definition"></a></dt>
<dd><p>Updates the plot(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.MetricLogger.w_mid">
<span class="sig-name descname"><span class="pre">w_mid</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">14.222222222222221</span></em><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.w_mid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.PanelMetricLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.monitors.</span></span><span class="sig-name descname"><span class="pre">PanelMetricLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gif_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'optimisation_history.gif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#PanelMetricLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger" title="tomopt.optimisation.callbacks.monitors.MetricLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetricLogger</span></code></a></p>
<p>Logger for use with :class:<a href="#id1"><span class="problematic" id="id2">`</span></a>~tomopt.volume.layer.PanelDetectorLayer`s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gif_filename</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – optional savename for recording a gif of the optimisation process (None -&gt; no gif)
The savename will be appended to the callback savepath</p></li>
<li><p><strong>show_plots</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to provide live plots during optimisation in notebooks</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.PanelMetricLogger._build_grid_spec">
<span class="sig-name descname"><span class="pre">_build_grid_spec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#PanelMetricLogger._build_grid_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger._build_grid_spec" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GridSpec</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The layout object for the plots</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.PanelMetricLogger._prep_plots">
<span class="sig-name descname"><span class="pre">_prep_plots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#PanelMetricLogger._prep_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger._prep_plots" title="Permalink to this definition"></a></dt>
<dd><p>Creates the plots for a new optimisation</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.PanelMetricLogger._set_axes_labels">
<span class="sig-name descname"><span class="pre">_set_axes_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#PanelMetricLogger._set_axes_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger._set_axes_labels" title="Permalink to this definition"></a></dt>
<dd><p>Adds styling to plots after they are cleared</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.monitors.PanelMetricLogger.update_plot">
<span class="sig-name descname"><span class="pre">update_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/monitors.html#PanelMetricLogger.update_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger.update_plot" title="Permalink to this definition"></a></dt>
<dd><p>Updates the plot(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="tomopt-optimisation-callbacks-opt-callbacks-module">
<h2>tomopt.optimisation.callbacks.opt_callbacks module<a class="headerlink" href="#tomopt-optimisation-callbacks-opt-callbacks-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-tomopt.optimisation.callbacks.pred_callbacks">
<span id="tomopt-optimisation-callbacks-pred-callbacks-module"></span><h2>tomopt.optimisation.callbacks.pred_callbacks module<a class="headerlink" href="#module-tomopt.optimisation.callbacks.pred_callbacks" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.PredHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.pred_callbacks.</span></span><span class="sig-name descname"><span class="pre">PredHandler</span></span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#PredHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Default callback for predictions. Collects predictions and true voxelwise X0 pairs for a range of volumes and returns them as list of tuples of numpy arrays
when <a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.get_preds" title="tomopt.optimisation.callbacks.pred_callbacks.PredHandler.get_preds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_preds()</span></code></a> is called.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.PredHandler.get_preds">
<span class="sig-name descname"><span class="pre">get_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#PredHandler.get_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.get_preds" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of predicted and target pairs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_pred_begin">
<span class="sig-name descname"><span class="pre">on_pred_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#PredHandler.on_pred_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_pred_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to record predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_x0_pred_end">
<span class="sig-name descname"><span class="pre">on_x0_pred_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#PredHandler.on_x0_pred_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_x0_pred_end" title="Permalink to this definition"></a></dt>
<dd><p>Records predictions and true volume layout for the latest volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.pred_callbacks.</span></span><span class="sig-name descname"><span class="pre">Save2HDF5PredHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_volume_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x02id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lzf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#Save2HDF5PredHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler" title="tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">VolumeTargetPredHandler</span></code></a></p>
<p>Saves predictions and targets to an HDF5 file, rather than caching and returning them.
Samples are written incrementally. Can optionally save volume targets rather than voxel-wise X0 targets
If an x02id lookup is provided, it transforms the target from an X0 value to a material class ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – savename of file to save predictions and targets</p></li>
<li><p><strong>use_volume_target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, saves the volume target value instead of the volume X0s</p></li>
<li><p><strong>overwrite</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True will overwrite existing files with the same path, otherwise will append to them</p></li>
<li><p><strong>x02id</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – optional map from X0 values to class IDs</p></li>
<li><p><strong>compression</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – optional string representation of any compression to use when saving data</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._open_file">
<span class="sig-name descname"><span class="pre">_open_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#Save2HDF5PredHandler._open_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._open_file" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Save file to write data to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._write_data">
<span class="sig-name descname"><span class="pre">_write_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targ</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#Save2HDF5PredHandler._write_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._write_data" title="Permalink to this definition"></a></dt>
<dd><p>Writes a new prediction-target pair to the save file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – volume predictions to save</p></li>
<li><p><strong>targ</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – volume targets to save</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler.on_x0_pred_end">
<span class="sig-name descname"><span class="pre">on_x0_pred_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#Save2HDF5PredHandler.on_x0_pred_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler.on_x0_pred_end" title="Permalink to this definition"></a></dt>
<dd><p>Records predictions and true volume layout or target for the latest volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.pred_callbacks.</span></span><span class="sig-name descname"><span class="pre">VolumeTargetPredHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x02id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#VolumeTargetPredHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler" title="tomopt.optimisation.callbacks.pred_callbacks.PredHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredHandler</span></code></a></p>
<p>Returns the volume target as the target value, rather than the voxel-wise X0s.
If an x02id lookup is provided, it transforms the target from an X0 value to a material class ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x02id</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – optional map from X0 values to class IDs</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler.on_x0_pred_end">
<span class="sig-name descname"><span class="pre">on_x0_pred_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/pred_callbacks.html#VolumeTargetPredHandler.on_x0_pred_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler.on_x0_pred_end" title="Permalink to this definition"></a></dt>
<dd><p>Records predictions and volume target for the latest volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="tomopt-optimisation-callbacks-warmup-callbacks-module">
<h2>tomopt.optimisation.callbacks.warmup_callbacks module<a class="headerlink" href="#tomopt-optimisation-callbacks-warmup-callbacks-module" title="Permalink to this heading"></a></h2>
<span class="target" id="module-tomopt.optimisation.callbacks.warmup_callbacks"></span><dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.warmup_callbacks.</span></span><span class="sig-name descname"><span class="pre">CostCoefWarmup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_warmup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#CostCoefWarmup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback" title="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">WarmupCallback</span></code></a></p>
<p>Sets a more stable cost coefficient in the <a class="reference internal" href="tomopt.optimisation.loss.html#tomopt.optimisation.loss.loss.AbsDetectorLoss" title="tomopt.optimisation.loss.loss.AbsDetectorLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsDetectorLoss</span></code></a>
by averaging the inference-error component for several epochs.
During this warm-up monitoring phase, the detectors will be kept fixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_warmup</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of training epochs to wait before setting the cost coefficient</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#CostCoefWarmup._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup._reset" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the callback to warmup, and ensures that only the first <cite>WarmupCallback</cite> is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#CostCoefWarmup.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>If enough epochs have past, the overall median inference-error is computed and used to set the cost coefficient in the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_volume_end">
<span class="sig-name descname"><span class="pre">on_volume_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#CostCoefWarmup.on_volume_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_volume_end" title="Permalink to this definition"></a></dt>
<dd><p>If training, grabs the inference-error for the latest volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.warmup_callbacks.</span></span><span class="sig-name descname"><span class="pre">PanelOptConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_warmup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_pos_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_pos_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_span_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#PanelOptConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback" title="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">WarmupCallback</span></code></a></p>
<p>Allows the user to specify the desired update steps for :class:<a href="#id3"><span class="problematic" id="id4">`</span></a>~tomopt.volume.layer.PanelDetectorLayer`s in physical units.
Over the course of several warm-up epochs the gradients on the parameters are monitored, after which suitable learning rates for the optimisation are set.
During the warm-up, the detectors will not be updated as optimiser learning rates will be set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_warmup</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of training epochs to wait before setting learning rates</p></li>
<li><p><strong>xy_pos_rate</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – desired distance in metres the panels should move in xy every update</p></li>
<li><p><strong>z_pos_rate</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – desired distance in metres the panels should move in z every update</p></li>
<li><p><strong>xy_span_rate</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – desired distance in metres the panels should expand in xy every update</p></li>
<li><p><strong>budget_rate</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – desired rate at which the fractional budget assignments should change every update</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#PanelOptConfig._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig._reset" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the callback to warmup, and ensures that only the first <cite>WarmupCallback</cite> is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_backwards_end">
<span class="sig-name descname"><span class="pre">on_backwards_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#PanelOptConfig.on_backwards_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_backwards_end" title="Permalink to this definition"></a></dt>
<dd><p>Grabs training gradients from detector parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#PanelOptConfig.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>When enough training epochs have passed, sets suitable learning rates for the optimisers based on the median gradients and desired update rates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.optimisation.callbacks.warmup_callbacks.</span></span><span class="sig-name descname"><span class="pre">WarmupCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_warmup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#WarmupCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback" title="tomopt.optimisation.callbacks.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Warmup callbacks act at the start of training to track and set paramters based on the initial state of the detector.
During warmup, optimisation of the detector is prevented, via a flag.
If multiple warmup callbacks aare present, they will wait to warmup according to the order they are provided in.
Once the last warmup callback finished, the flag will be set to allow the detectors to be optimised.
When a <cite>WarmupCallback</cite> is warming up, its <cite>warmup_active</cite> attribute will be True.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When inheriting from <cite>WarmupCallback</cite>, the super methods of <cite>on_train_begin</cite>, <cite>on_epoch_begin</cite>, and <cite>on_epoch_end</cite> must be called.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_warmup</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of training epochs overwhich to warmup</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#WarmupCallback._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback._reset" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the callback to warmup, and ensures that only the first <cite>WarmupCallback</cite> is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.check_warmups">
<span class="sig-name descname"><span class="pre">check_warmups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#WarmupCallback.check_warmups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.check_warmups" title="Permalink to this definition"></a></dt>
<dd><p>If a <cite>WarmupCallback</cite> has finished, then its <cite>warmup_active</cite> is set to False,
and the next <cite>WarmupCallback</cite> will have its <cite>warmup_active</cite> is set to True.
If the finishing callback was the last <cite>WarmupCallback</cite>, then the “skip optimisation” flag is unset.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#WarmupCallback.on_epoch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_begin" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that when one <cite>WarmupCallback</cite> has finished, either the next is called, or the detectors are set to be optimised.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#WarmupCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>After a training epoch is finished, increments the number of epochs that the callback has been warming up, provided it is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/optimisation/callbacks/warmup_callbacks.html#WarmupCallback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Prepares to warmup</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tomopt.optimisation.data.html" class="btn btn-neutral float-right" title="tomopt.optimisation.data package" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="tomopt.optimisation.html" class="btn btn-neutral" title="tomopt.optimisation package" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021-2022, TomOpt Authors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/GilesStrong/tomopt_sphinx_theme">theme</a> based on a <a href="https://github.com/pytorch/pytorch_sphinx_theme">theme</a> provided by <a href="https://pytorch.org/">PyTorch</a> based on a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">tomopt.optimisation.callbacks package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.callback">tomopt.optimisation.callbacks.callback module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback"><code class="docutils literal notranslate"><span class="pre">Callback</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_backwards_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_backwards_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_backwards_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_backwards_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_epoch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_epoch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_mu_batch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_mu_batch_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_mu_batch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_pred_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_pred_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_pred_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_pred_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_scatter_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_scatter_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_train_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_train_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_train_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_volume_batch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_batch_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_volume_batch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_volume_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_volume_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_volume_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_begin"><code class="docutils literal notranslate"><span class="pre">Callback.on_x0_pred_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.on_x0_pred_end"><code class="docutils literal notranslate"><span class="pre">Callback.on_x0_pred_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.set_wrapper"><code class="docutils literal notranslate"><span class="pre">Callback.set_wrapper()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.callback.Callback.wrapper"><code class="docutils literal notranslate"><span class="pre">Callback.wrapper</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.cyclic_callbacks">tomopt.optimisation.callbacks.cyclic_callbacks module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.cyclic_callbacks.CyclicCallback"><code class="docutils literal notranslate"><span class="pre">CyclicCallback</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.data_callbacks">tomopt.optimisation.callbacks.data_callbacks module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler"><code class="docutils literal notranslate"><span class="pre">MuonResampler</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler.check_mu_batch"><code class="docutils literal notranslate"><span class="pre">MuonResampler.check_mu_batch()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler.on_mu_batch_begin"><code class="docutils literal notranslate"><span class="pre">MuonResampler.on_mu_batch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.data_callbacks.MuonResampler.resample"><code class="docutils literal notranslate"><span class="pre">MuonResampler.resample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.diagnostic_callbacks">tomopt.optimisation.callbacks.diagnostic_callbacks module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord"><code class="docutils literal notranslate"><span class="pre">HitRecord</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord._to_df"><code class="docutils literal notranslate"><span class="pre">HitRecord._to_df()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.HitRecord.on_scatter_end"><code class="docutils literal notranslate"><span class="pre">HitRecord.on_scatter_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord"><code class="docutils literal notranslate"><span class="pre">ScatterRecord</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._reset"><code class="docutils literal notranslate"><span class="pre">ScatterRecord._reset()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord._to_df"><code class="docutils literal notranslate"><span class="pre">ScatterRecord._to_df()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.get_record"><code class="docutils literal notranslate"><span class="pre">ScatterRecord.get_record()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_pred_begin"><code class="docutils literal notranslate"><span class="pre">ScatterRecord.on_pred_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_scatter_end"><code class="docutils literal notranslate"><span class="pre">ScatterRecord.on_scatter_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.diagnostic_callbacks.ScatterRecord.on_train_begin"><code class="docutils literal notranslate"><span class="pre">ScatterRecord.on_train_begin()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.eval_metric">tomopt.optimisation.callbacks.eval_metric module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.eval_metric.EvalMetric"><code class="docutils literal notranslate"><span class="pre">EvalMetric</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.eval_metric.EvalMetric.get_metric"><code class="docutils literal notranslate"><span class="pre">EvalMetric.get_metric()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.eval_metric.EvalMetric.on_train_begin"><code class="docutils literal notranslate"><span class="pre">EvalMetric.on_train_begin()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.grad_callbacks">tomopt.optimisation.callbacks.grad_callbacks module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs"><code class="docutils literal notranslate"><span class="pre">NoMoreNaNs</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.grad_callbacks.NoMoreNaNs.on_backwards_end"><code class="docutils literal notranslate"><span class="pre">NoMoreNaNs.on_backwards_end()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.heatmap_gif">tomopt.optimisation.callbacks.heatmap_gif module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif"><code class="docutils literal notranslate"><span class="pre">HeatMapGif</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._create_gif"><code class="docutils literal notranslate"><span class="pre">HeatMapGif._create_gif()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._plot_current"><code class="docutils literal notranslate"><span class="pre">HeatMapGif._plot_current()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif._reset"><code class="docutils literal notranslate"><span class="pre">HeatMapGif._reset()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">HeatMapGif.on_epoch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_begin"><code class="docutils literal notranslate"><span class="pre">HeatMapGif.on_train_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.heatmap_gif.HeatMapGif.on_train_end"><code class="docutils literal notranslate"><span class="pre">HeatMapGif.on_train_end()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt-optimisation-callbacks-loss-callbacks-module">tomopt.optimisation.callbacks.loss_callbacks module</a></li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.monitors">tomopt.optimisation.callbacks.monitors module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger"><code class="docutils literal notranslate"><span class="pre">MetricLogger</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._build_grid_spec"><code class="docutils literal notranslate"><span class="pre">MetricLogger._build_grid_spec()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._create_gif"><code class="docutils literal notranslate"><span class="pre">MetricLogger._create_gif()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._prep_plots"><code class="docutils literal notranslate"><span class="pre">MetricLogger._prep_plots()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._reset"><code class="docutils literal notranslate"><span class="pre">MetricLogger._reset()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger._snapshot_monitor"><code class="docutils literal notranslate"><span class="pre">MetricLogger._snapshot_monitor()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.cat_palette"><code class="docutils literal notranslate"><span class="pre">MetricLogger.cat_palette</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.get_loss_history"><code class="docutils literal notranslate"><span class="pre">MetricLogger.get_loss_history()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.get_results"><code class="docutils literal notranslate"><span class="pre">MetricLogger.get_results()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.h_mid"><code class="docutils literal notranslate"><span class="pre">MetricLogger.h_mid</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_col"><code class="docutils literal notranslate"><span class="pre">MetricLogger.lbl_col</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.lbl_sz"><code class="docutils literal notranslate"><span class="pre">MetricLogger.lbl_sz</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.leg_sz"><code class="docutils literal notranslate"><span class="pre">MetricLogger.leg_sz</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_backwards_end"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_backwards_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_epoch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_epoch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_begin"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_train_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_train_end"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_train_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_batch_end"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_volume_batch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.on_volume_end"><code class="docutils literal notranslate"><span class="pre">MetricLogger.on_volume_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.print_losses"><code class="docutils literal notranslate"><span class="pre">MetricLogger.print_losses()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.style"><code class="docutils literal notranslate"><span class="pre">MetricLogger.style</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.tk_col"><code class="docutils literal notranslate"><span class="pre">MetricLogger.tk_col</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.tk_sz"><code class="docutils literal notranslate"><span class="pre">MetricLogger.tk_sz</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.update_plot"><code class="docutils literal notranslate"><span class="pre">MetricLogger.update_plot()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.MetricLogger.w_mid"><code class="docutils literal notranslate"><span class="pre">MetricLogger.w_mid</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger"><code class="docutils literal notranslate"><span class="pre">PanelMetricLogger</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger._build_grid_spec"><code class="docutils literal notranslate"><span class="pre">PanelMetricLogger._build_grid_spec()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger._prep_plots"><code class="docutils literal notranslate"><span class="pre">PanelMetricLogger._prep_plots()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger._set_axes_labels"><code class="docutils literal notranslate"><span class="pre">PanelMetricLogger._set_axes_labels()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.monitors.PanelMetricLogger.update_plot"><code class="docutils literal notranslate"><span class="pre">PanelMetricLogger.update_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt-optimisation-callbacks-opt-callbacks-module">tomopt.optimisation.callbacks.opt_callbacks module</a></li>
<li><a class="reference internal" href="#module-tomopt.optimisation.callbacks.pred_callbacks">tomopt.optimisation.callbacks.pred_callbacks module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler"><code class="docutils literal notranslate"><span class="pre">PredHandler</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.get_preds"><code class="docutils literal notranslate"><span class="pre">PredHandler.get_preds()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_pred_begin"><code class="docutils literal notranslate"><span class="pre">PredHandler.on_pred_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.PredHandler.on_x0_pred_end"><code class="docutils literal notranslate"><span class="pre">PredHandler.on_x0_pred_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler"><code class="docutils literal notranslate"><span class="pre">Save2HDF5PredHandler</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._open_file"><code class="docutils literal notranslate"><span class="pre">Save2HDF5PredHandler._open_file()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler._write_data"><code class="docutils literal notranslate"><span class="pre">Save2HDF5PredHandler._write_data()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.Save2HDF5PredHandler.on_x0_pred_end"><code class="docutils literal notranslate"><span class="pre">Save2HDF5PredHandler.on_x0_pred_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler"><code class="docutils literal notranslate"><span class="pre">VolumeTargetPredHandler</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.pred_callbacks.VolumeTargetPredHandler.on_x0_pred_end"><code class="docutils literal notranslate"><span class="pre">VolumeTargetPredHandler.on_x0_pred_end()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt-optimisation-callbacks-warmup-callbacks-module">tomopt.optimisation.callbacks.warmup_callbacks module</a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup"><code class="docutils literal notranslate"><span class="pre">CostCoefWarmup</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup._reset"><code class="docutils literal notranslate"><span class="pre">CostCoefWarmup._reset()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">CostCoefWarmup.on_epoch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.CostCoefWarmup.on_volume_end"><code class="docutils literal notranslate"><span class="pre">CostCoefWarmup.on_volume_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig"><code class="docutils literal notranslate"><span class="pre">PanelOptConfig</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig._reset"><code class="docutils literal notranslate"><span class="pre">PanelOptConfig._reset()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_backwards_end"><code class="docutils literal notranslate"><span class="pre">PanelOptConfig.on_backwards_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.PanelOptConfig.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">PanelOptConfig.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback"><code class="docutils literal notranslate"><span class="pre">WarmupCallback</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback._reset"><code class="docutils literal notranslate"><span class="pre">WarmupCallback._reset()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.check_warmups"><code class="docutils literal notranslate"><span class="pre">WarmupCallback.check_warmups()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">WarmupCallback.on_epoch_begin()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">WarmupCallback.on_epoch_end()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.optimisation.callbacks.warmup_callbacks.WarmupCallback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">WarmupCallback.on_train_begin()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/sphinx_highlight.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-6 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer and user documentation for TomOpt</p>
          <a class="with-right-arrow" href="https://tomopt.readthedocs.io/en/stable">View Docs</a>
        </div>

        <div class="col-md-6 text-center">
          <h2>Tutorials</h2>
          <p>Get tutorials for beginner and advanced researchers demonstrating many of the features of TomOpt</p>
          <a class="with-right-arrow" href="https://github.com/GilesStrong/mode_muon_tomography#examples">View Tutorials</a>
        </div>

        <!-- <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="">View Resources</a>
        </div> -->
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://tomopt.readthedocs.io/en/stable" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <!-- <li class="list-title"><a href="https://tomopt.readthedocs.io/en/stable">TomOpt</a></li> -->
            <!-- <li><a href="">Get Started</a></li> -->
            <!-- <li><a href="">Features</a></li> -->
            <!-- <li><a href="">Ecosystem</a></li> -->
            <!-- <li><a href="">Blog</a></li> -->
            <!-- <li><a href="">Resources</a></li> -->
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Support</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a></li>
            <li><a href="https://tomopt.readthedocs.io/en/stable">Docs</a></li>
            <!-- <li><a href="" target="_blank">Discuss</a></li> -->
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CHANGES.md" target="_blank">Change Log</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CITATION.md" target="_blank">Citation</a></li>
            <!-- <li><a href="" target="_blank">Slack</a></li> -->
            <!-- <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CONTRIBUTING.md" target="_blank">Contributing</a></li> -->
          </ul>
        </div>

        <!-- <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    real people should not fill this in and expect good things - do not remove this or risk form bot signups

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="" target="_blank" class="facebook"></a>
            <a href="" target="_blank" class="twitter"></a>
          </div>
        </div> -->
      </div>
    </div>
  </footer>

  <!-- <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div> -->

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://tomopt.readthedocs.io/en/stable" aria-label="TomOpt"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <!-- <li>
            <a href="#">Get Started</a>
          </li> -->

          <!-- <li>
            <a href="#">Features</a>
          </li> -->

          <!-- <li>
            <a href="#">Ecosystem</a>
          </li> -->

          <!-- <li>
            <a href="">Blog</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a>
          </li>

          <li>
            <a href="https://tomopt.readthedocs.io/en/stable">Docs</a>
          </li>

          <!-- <li>
            <a href="">Resources</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>