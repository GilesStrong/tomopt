


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tomopt.inference package &mdash; TomOpt  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tomopt.muon package" href="tomopt.muon.html" />
    <link rel="prev" title="tomopt.benchmarks.u_lorry package" href="tomopt.benchmarks.u_lorry.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://tomopt.readthedocs.io/en/stable" aria-label="TomOpt"></a>

      <div class="main-menu">
        <ul>
          <!-- <li>
            <a href="">Get Started</a>
          </li> -->

          <!-- <li>
            <a href="">Features</a>
          </li> -->

          <!-- <li>
            <a href="">Ecosystem</a>
          </li> -->

          <!-- <li>
            <a href="">Blog</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a>
          </li>

          <li>
            <a href="https://tomopt.readthedocs.io/en/stable">Docs</a>
          </li>

          <!-- <li>
            <a href="">Resources</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#external-repos">External repos</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#authors">Authors</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tomopt.html">tomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.muon.html">tomopt.muon package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.volume.html">tomopt.volume package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tomopt.inference package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.optimisation.html">tomopt.optimisation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.plotting.html">tomopt.plotting package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tomopt.benchmarks.html">tomopt.benchmarks package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="tomopt.html">tomopt package</a> &gt;</li>
        
      <li>tomopt.inference package</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/tomopt.inference.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <section id="tomopt-inference-package">
<h1>tomopt.inference package<a class="headerlink" href="#tomopt-inference-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-tomopt.inference.scattering">
<span id="tomopt-inference-scattering-module"></span><h2>tomopt.inference.scattering module<a class="headerlink" href="#module-tomopt.inference.scattering" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.scattering.GenScatterBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.scattering.</span></span><span class="sig-name descname"><span class="pre">GenScatterBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/scattering.html#GenScatterBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.scattering.GenScatterBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a></p>
<p>Class for computing scattering information from the true hits via incoming/outgoing trajectory fitting.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class is intended for diagnostic purposes only.
The tracks and scatter variables carry no gradient w.r.t. detector parameters (except z position).</p>
</div>
<p>Linear fits are performed separately to all hits associated with layer groups, as indicated by the <cite>pos</cite> attribute of the layers which recorded hits.
Currently, the inference methods expect detectors above the passive layer to have <cite>pos==’above’</cite>,
and those below the passive volume to have <cite>pos==’below’</cite>.
Trajectory fitting is performed using an analytic likelihood minimisation, but no uncertainties on the hits are considered.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The current separation of hits into above and below groups does not allow for e.g. a third set of detectors,
since this split is based on the value of the <cite>n_hits_above</cite> attribute.</p>
</div>
<p>One instance of this class should created for each <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>.
As part of the initialisation, muons will be filtered using <code class="xref py py-meth docutils literal notranslate"><span class="pre">_filter_scatters()</span></code>
in order to avoid NaN/Inf values. This results in direct, in-place changes to the <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>.</p>
<p>Since many variables of the scattering can be inferred, but not all are required for further inference downstream,
variables, and their uncertainties, are computed on a lazy basis, with memoisation: the values are only computed on the first request (if at all)
and then stored in case of further requests.</p>
<p>The dtheta, dphi, and total scattering variables are computed under the assumption of small angular scatterings.
An assumption is necessary here, since there is a loss of information in the when the muons undergo scattering in theta and phi:
since theta is [0,pi] a negative scattering in theta will always results in a positive theta, but phi can become phi+pi.
When inferring the angular scattering, one cannot precisely tell whether instead a large scattering in phi occurred.
The total scattering (<cite>total_scatter</cite>) is the quadrature sum of dtheta and dphi, and all three are computed under both hypotheses.
The final values of these are chosen using the hypothesis which minimises the total amount of scattering.
This assumption has been tested and found to be good.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – muons with hits to infer on</p></li>
<li><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons travelled</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.scattering.</span></span><span class="sig-name descname"><span class="pre">ScatterBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/scattering.html#ScatterBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for computing scattering information from the hits via incoming/outgoing trajectory fitting.</p>
<p>Linear fits are performed separately to all hits associated with layer groups, as indicated by the <cite>pos</cite> attribute of the layers which recorded hits.
Currently, the inference methods expect detectors above the passive layer to have <cite>pos==’above’</cite>,
and those below the passive volume to have <cite>pos==’below’</cite>.
Trajectory fitting is performed using an analytic likelihood minimisation, which considers uncertainties and efficiencies on the hits in x and y.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The current separation of hits into above and below groups does not allow for e.g. a third set of detectors,
since this split is based on the value of the <cite>n_hits_above</cite> attribute.</p>
</div>
<p>One instance of this class should created for each <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>.
As part of the initialisation, muons will be filtered using <code class="xref py py-meth docutils literal notranslate"><span class="pre">_filter_scatters()</span></code>
in order to avoid NaN/Inf gradients or values. This results in direct, in-place changes to the <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>.</p>
<p>Since many variables of the scattering can be inferred, but not all are required for further inference downstream,
variables, and their uncertainties, are computed on a lazy basis, with memoisation: the values are only computed on the first request (if at all)
and then stored in case of further requests.</p>
<p>The dtheta, dphi, and total scattering variables are computed under the assumption of small angular scatterings.
An assumption is necessary here, since there is a loss of information in the when the muons undergo scattering in theta and phi:
since theta is [0,pi] a negative scattering in theta will always results in a positive theta, but phi can become phi+pi.
When inferring the angular scattering, one cannot precisely tell whether instead a large scattering in phi occurred.
The total scattering (<cite>total_scatter</cite>) is the quadrature sum of dtheta and dphi, and all three are computed under both hypotheses.
The final values of these are chosen using the hypothesis which minimises the total amount of scattering.
This assumption has been tested and found to be good.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch" title="tomopt.muon.muon_batch.MuonBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuonBatch</span></code></a>) – muons with hits to infer on</p></li>
<li><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons travelled</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.above_gen_hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">above_gen_hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.above_gen_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of true hits in the “above” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.above_hit_effs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">above_hit_effs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.above_hit_effs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,effs) tensor of hit efficiencies in the “above” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.above_hit_uncs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">above_hit_uncs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.above_hit_uncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of uncertainties on hits in the “above” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.above_hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">above_hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.above_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of recorded hits in the “above” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.below_gen_hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">below_gen_hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.below_gen_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of true hits in the “below” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.below_hit_effs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">below_hit_effs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.below_hit_effs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,eff) tensor of hit efficiencies in the “below” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.below_hit_uncs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">below_hit_uncs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.below_hit_uncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of uncertainties on hits in the “below” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.below_hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">below_hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.below_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of recorded hits in the “below” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dphi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dphi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) delta phi between incoming &amp; outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dphi_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dphi_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dphi_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on dphi</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dtheta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtheta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dtheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) delta theta between incoming &amp; outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dtheta_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtheta_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dtheta_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on dtheta</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dtheta_xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtheta_xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dtheta_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) delta theta_xy between incoming &amp; outgoing muons in the zx and zy planes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dtheta_xy_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtheta_xy_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dtheta_xy_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) uncertainty on dtheta_xy</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dxy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dxy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) distances in x &amp; y from PoCA to incoming|outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.dxy_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dxy_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.dxy_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) uncertainty on dxy</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.gen_hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gen_hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.gen_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of true hits</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.get_muon_trajectory">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_muon_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/scattering.html#ScatterBatch.get_muon_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.get_muon_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a linear trajectory to a group of hits, whilst considering their uncertainties on their xy positions.
No uncertainty is considered for z positions of hits.
The fit is performed via an analytical likelihood-maximisation.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Muons with &lt;2 hits have NaN trajectory</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (muons,hits,xyz) tensor of hit positions</p></li>
<li><p><strong>uncs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (muons,hits,(unc x,unc y,0)) tensor of hit uncertainties</p></li>
<li><p><strong>lw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – length and width of the passive layers of the volume</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(muons,xyz) fitted-vector directions
start: (muons,xyz) initial point of fitted-vector</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>vec</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.get_scatter_mask">
<span class="sig-name descname"><span class="pre">get_scatter_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/scattering.html#ScatterBatch.get_scatter_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.get_scatter_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(muons) Boolean tensor where True indicates that the PoCA of the muon is located within the passive volume</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.hit_effs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hit_effs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.hit_effs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,eff) tensor of hit efficiencies</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.hit_uncs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hit_uncs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.hit_uncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of uncertainties on hits</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
Dictionary of hits, as returned by <a class="reference internal" href="tomopt.muon.html#tomopt.muon.muon_batch.MuonBatch.get_hits" title="tomopt.muon.muon_batch.MuonBatch.get_hits"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_hits()</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.n_hits_above">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_hits_above</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.n_hits_above" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
Number of hits per muon in the “above” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.n_hits_below">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_hits_below</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.n_hits_below" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
Number of hits per muon in the “below” detectors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.phi_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.phi_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) phi of incoming muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.phi_in_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi_in_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.phi_in_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on phi_in</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.phi_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.phi_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) phi of outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.phi_out_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi_out_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.phi_out_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on phi_out</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.plot_scatter">
<span class="sig-name descname"><span class="pre">plot_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/scattering.html#ScatterBatch.plot_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.plot_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots representation of hits and fitted trajectories for a single muon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – index of muon to plot</p></li>
<li><p><strong>savename</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]) – optional path to save figure to</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.poca_xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">poca_xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.poca_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) xyz location of PoCA</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.poca_xyz_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">poca_xyz_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.poca_xyz_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) uncertainty on poca_xyz</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.reco_hits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reco_hits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.reco_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,hits,xyz) tensor of recorded hits</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) theta of incoming muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_in_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_in_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_in_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on theta_in</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_msc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_msc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_msc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) theta_msc; the total amount of angular scattering</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_msc_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_msc_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_msc_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on total_scatter</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) theta of outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_out_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_out_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_out_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on theta_out</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_xy_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_xy_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) decomposed theta and phi of incoming muons in the zx and zy planes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_xy_in_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_xy_in_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_in_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) uncertainty on theta_xy_in</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_xy_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_xy_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) decomposed theta and phi of outgoing muons in the zx and zy planes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.theta_xy_out_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_xy_out_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_out_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xy) uncertainty on theta_xy_out</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.total_scatter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_scatter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.total_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) theta_msc; the total amount of angular scattering</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.total_scatter_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_scatter_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.total_scatter_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) uncertainty on total_scatter</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.track_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">track_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.track_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) incoming xyz vector</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.track_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">track_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.track_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) outgoing xyz vector</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.track_start_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">track_start_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.track_start_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) initial point of incoming xyz vector</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.track_start_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">track_start_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.track_start_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) initial point of outgoing xyz vector</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.xyz_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.xyz_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) inferred xy position of muon at the z-level of the top of the passive volume</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.xyz_in_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz_in_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.xyz_in_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) uncertainty on xyz_in</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.xyz_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.xyz_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) inferred xy position of muon at the z-level of the bottom of the passive volume</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.scattering.ScatterBatch.xyz_out_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz_out_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.scattering.ScatterBatch.xyz_out_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) uncertainty on xyz_out</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-tomopt.inference.volume">
<span id="tomopt-inference-volume-module"></span><h2>tomopt.inference.volume module<a class="headerlink" href="#module-tomopt.inference.volume" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsIntClassifierFromX0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.volume.</span></span><span class="sig-name descname"><span class="pre">AbsIntClassifierFromX0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partial_x0_inferrer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class2float</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsIntClassifierFromX0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsIntClassifierFromX0" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer" title="tomopt.inference.volume.AbsVolumeInferrer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeInferrer</span></code></a></p>
<p>Abstract base class for inferring integer targets through multiclass classification from voxelwise X0 predictions.
Inheriting classes must provide a way to convert voxelwise X0s into class probabilities of the required dimension.
Requires a basic inferrer for providing the voxelwise X0 predictions.
Optionally, the predictions can be returns as the raw class predictions, or the most probable class.
In case of the latter, this class can be optionally be converted to a float value via a user-provided processing function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>partial_x0_inferrer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer" title="tomopt.inference.volume.AbsX0Inferrer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsX0Inferrer</span></code></a>]) – (partial) class to instatiate to provide the voxelwise X0 predictions</p></li>
<li><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons will be passed</p></li>
<li><p><strong>output_probs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, will return the per-class probabilites, otherwise will return the argmax of the probabilities, over the last dimension</p></li>
<li><p><strong>class2float</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]) – optional function to convert class indices to a floating value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsIntClassifierFromX0.add_scatters">
<span class="sig-name descname"><span class="pre">add_scatters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsIntClassifierFromX0.add_scatters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsIntClassifierFromX0.add_scatters" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new set of muon scatter vairables.
When <a class="reference internal" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction" title="tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_prediction()</span></code></a> is called, the prediction will be based on all
<a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a> s added up to that point</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsIntClassifierFromX0.compute_efficiency">
<span class="sig-name descname"><span class="pre">compute_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsIntClassifierFromX0.compute_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsIntClassifierFromX0.compute_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Compuates the per-muon efficiency according to the method implemented by the X0 inferrer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scatters</strong> (<a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a>) – scatter batch containing muons whose efficiency should be computed</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(muons) tensor of muon efficiencies</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsIntClassifierFromX0.get_prediction">
<span class="sig-name descname"><span class="pre">get_prediction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsIntClassifierFromX0.get_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsIntClassifierFromX0.get_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the predicions for the volume.
If class probabilities were requested during initialisation, then these will be returned.
Otherwise the most probable class will be returned, and this will be converted to a float value if <cite>class2float</cite> is not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(*) volume prediction</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pred</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsIntClassifierFromX0.x02probs">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x02probs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vox_preds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsIntClassifierFromX0.x02probs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsIntClassifierFromX0.x02probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes must override this method to convert voxelwise X0 predictions to class probabilities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vox_preds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (z,x,y) tensor of voxelwise X0 predictions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(*) tensor of class probabilities</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsVolumeInferrer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.volume.</span></span><span class="sig-name descname"><span class="pre">AbsVolumeInferrer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsVolumeInferrer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsVolumeInferrer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for volume inference.</p>
<p>Inheriting classes are expected to be fed multiple <a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a> s,
via <a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer.add_scatters" title="tomopt.inference.volume.AbsVolumeInferrer.add_scatters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_scatters()</span></code></a>, for a single <a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>
and return a volume prediction based on all of the muon batches when <a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer.get_prediction" title="tomopt.inference.volume.AbsVolumeInferrer.get_prediction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_prediction()</span></code></a> is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons will be passed</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsVolumeInferrer.add_scatters">
<span class="sig-name descname"><span class="pre">add_scatters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsVolumeInferrer.add_scatters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsVolumeInferrer.add_scatters" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new set of muon scatter variables.
When <a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer.get_prediction" title="tomopt.inference.volume.AbsVolumeInferrer.get_prediction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_prediction()</span></code></a> is called, the prediction will be based on all
<a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a> s added up to that point</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsVolumeInferrer.compute_efficiency">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsVolumeInferrer.compute_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsVolumeInferrer.compute_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes must override this method to provide a computation of the per-muon efficiency, given the individual muon hit efficiencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsVolumeInferrer.get_prediction">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_prediction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsVolumeInferrer.get_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsVolumeInferrer.get_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Inheriting classes must override this method to provide a prediction computed using the added scatter batches.
E.g. the sum of muon efficiencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.volume.</span></span><span class="sig-name descname"><span class="pre">AbsX0Inferrer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsX0Inferrer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer" title="tomopt.inference.volume.AbsVolumeInferrer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeInferrer</span></code></a></p>
<p>Abstract base class for inferring the X0 of every voxel in the passive volume.</p>
<p>The inference is based on the PoCA approach of assigning the entirety of the muon scattering to a single point,
and the X0 computation is based on inversion of the PDG scattering model described in
<a class="reference external" href="https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf">https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf</a>.</p>
<dl class="simple">
<dt>Once all scatter batches have been added, the inference proceeds thusly:</dt><dd><ul class="simple">
<li><p>For each muon i, a probability p_ij, is computed according to the probability that the PoCA was located in voxel j.</p></li>
<li><p>These probabilities are computed by integrating over the voxel the PDF of 3 uncorrelated Gaussians centred on the PoCA, with scales equal the uncertainty on the PoCA position in x,y,z.</p></li>
<li><p>p_ij is multiplied by muon efficiency e_i to compute a muon/voxel weight w_ij.</p></li>
<li><p>Inversion of the PDG model gives: <span class="math notranslate nohighlight">\(X_0 = \left(\frac{0.0136}{p^{\mathrm{rms}}}\right)^2\frac{\delta z}{\cos\left(\bar{\theta}^{\mathrm{rms}}\right)}\frac{2}{\theta^{\mathrm{rms}}_{\mathrm{tot.}}}\)</span></p></li>
<li><dl class="simple">
<dt>In order to account for the muon weights and compute different X0s for the voxels whilst using the whole muon population:</dt><dd><ul>
<li><p>Weighted RMSs are computed for each of the scattering terms in the right-hand side of the equation.</p></li>
<li><p>In addition to the muon weight w_ij, the variances of the squared values of the scattering variables is used to divide w_ij.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>The result is a set of X0 predictions X0_j.</p></li>
</ul>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Inversion of the PDG model does NOT account for the natural log term.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To simplify the computation code, this class relies heavily on lazy computation and memoisation; be careful if calling private methods manually.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons will be passed</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.get_prediction">
<span class="sig-name descname"><span class="pre">get_prediction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsX0Inferrer.get_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.get_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the predicted X0 per voxel as a (z,x,y) tensor via PDG scatter-model inversion for the provided scatter batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(z,x,y) voxelwise X0 predictions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pred</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_efficiency">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_efficiency</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the efficiencies of the muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_mom">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_mom</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_mom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the momenta of the muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_mom_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_mom_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_mom_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the uncertainty on the momenta of the muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_poca_xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_poca_xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_poca_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) tensor of PoCA locations</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_poca_xyz_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_poca_xyz_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_poca_xyz_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,xyz) tensor of PoCA location uncertainties</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_probs_per_voxel_zxy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_probs_per_voxel_zxy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_probs_per_voxel_zxy" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Integration tested only</p>
</div>
<p>TODO: Don’t assume that poca_xyz uncertainties are uncorrelated
TODO: Improve efficiency: currently CDFs are computed multiple times at the same points; could precompute x,y,z probs once, and combine in triples
:returns: (muons,z,x,y) tensor of probabilities that the muons’ PoCAs were located in the given voxels.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_theta_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_theta_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the thetas of the incoming muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_theta_in_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_theta_in_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_in_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the uncertainty on the theta of the incoming muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_theta_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_theta_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the thetas of the outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_theta_out_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_theta_out_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_out_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of the uncertainty on the theta of the outgoing muons</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_total_scatter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_total_scatter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_total_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of total angular scatterings</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.muon_total_scatter_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muon_total_scatter_unc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.muon_total_scatter_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(muons,1) tensor of uncertainties on the total angular scatterings</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.n_mu">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_mu</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.n_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
Total number muons included in the inference</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.vox_zxy_x0_pred_uncs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vox_zxy_x0_pred_uncs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.vox_zxy_x0_pred_uncs" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not recommended for use: long calculation; not unit-tested</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(z,x,y) tensor of uncertainties on voxelwise X0s</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.vox_zxy_x0_preds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vox_zxy_x0_preds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.vox_zxy_x0_preds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
(z,x,y) tensor of voxelwise X0 predictions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.AbsX0Inferrer.x0_from_scatters">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x0_from_scatters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deltaz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_scatter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#AbsX0Inferrer.x0_from_scatters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.AbsX0Inferrer.x0_from_scatters" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the X0 of a voxel, by inverting the PDG scattering model in terms of the scattering variables</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Inversion of the PDG model does NOT account for the natural log term.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deltaz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – height of the voxels</p></li>
<li><p><strong>total_scatter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (voxels,1) tensor of the (RMS of the) total angular scattering of the muon(s)</p></li>
<li><p><strong>theta_in</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (voxels,1) tensor of the (RMS of the) theta of the muon(s), as inferred using the incoming trajectory/ies</p></li>
<li><p><strong>theta_out</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (voxels,1) tensor of the (RMS of the) theta of the muon(s), as inferred using the outgoing trajectory/ies</p></li>
<li><p><strong>mom</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – (voxels,1) tensor of the (RMS of the) momentum/a of the muon(s)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(voxels,1) estimated X0 in metres</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.volume.DenseBlockClassifierFromX0s">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.volume.</span></span><span class="sig-name descname"><span class="pre">DenseBlockClassifierFromX0s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_block_voxels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partial_x0_inferrer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_avgpool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#DenseBlockClassifierFromX0s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer" title="tomopt.inference.volume.AbsVolumeInferrer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsVolumeInferrer</span></code></a></p>
<p>Class for inferreing the presence of a small amount of denser material in the passive volume.</p>
<p>Transforms voxel-wise X0 preds into binary classification statistic under the hypothesis of a small, dense block against a light-weight background.
This test statistic, s is computed as:</p>
<div class="math notranslate nohighlight">
\[r = 2 \frac{\bar{X0}_{0,\mathrm{bkg}} - \bar{X0}_{0,\mathrm{blk}}}{\bar{X0}_{0,\mathrm{bkg}} + \bar{X0}_{0,\mathrm{blk}}}
s = \sigma\!(a(r+b))\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{X0}_{0,\mathrm{blk}}\)</span> is the mean X0 of the N lowest X0 voxels,
and <span class="math notranslate nohighlight">\(\bar{X0}_{0,\mathrm{bkg}}\)</span> is the mean X0 of the remaining voxels.
a and b are rescaling coefficients and offsets.</p>
<p>This results in a differentiable value constrained beween 0 and 1, with values near 0 indicating that no relatively dense material is present,
and values nearer 1 indicating that it is present.
In case it is expected that the dense material forms a contiguous block, the voxelwise X0s can be blurred via a stride-1 kernel-size-3 average pooling.</p>
<p>In actuality, the “cut” on X0s into background and block is implemented as a sigmoid weight, centred at the necessary kth value of the X0.
This means that the test statisitc is also differentiable w.r.t. the cut.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_block_voxels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of voxels expected to be occupied by the dense material, if present</p></li>
<li><p><strong>partial_x0_inferrer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer" title="tomopt.inference.volume.AbsX0Inferrer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsX0Inferrer</span></code></a>]) – (partial) class to instatiate to provide the voxelwise X0 predictions</p></li>
<li><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons will be passed</p></li>
<li><p><strong>use_avgpool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – wether to blur voxelwise X0 predicitons with a stride-1 kernel-size-3 average pooling
useful when the dense material is expected to form a contiguous block</p></li>
<li><p><strong>cut_coef</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the “sharpness” of the sigmoid weight that splits voxels into block and background.
Higher values results in a sharper cut.</p></li>
<li><p><strong>ratio_offset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – additive constant for the X0 ratio</p></li>
<li><p><strong>ratio_coef</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – multiplicative coefficient for the offset X0 ratio</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.DenseBlockClassifierFromX0s.add_scatters">
<span class="sig-name descname"><span class="pre">add_scatters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#DenseBlockClassifierFromX0s.add_scatters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.add_scatters" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new set of muon scatter vairables.
When <a class="reference internal" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction" title="tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_prediction()</span></code></a> is called, the prediction will be based on all
<a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a> s added up to that point</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.DenseBlockClassifierFromX0s.compute_efficiency">
<span class="sig-name descname"><span class="pre">compute_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#DenseBlockClassifierFromX0s.compute_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.compute_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Compuates the per-muon efficiency according to the method implemented by the X0 inferrer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scatters</strong> (<a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a>) – scatter batch containing muons whose efficiency should be computed</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(muons) tensor of muon efficiencies</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction">
<span class="sig-name descname"><span class="pre">get_prediction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#DenseBlockClassifierFromX0s.get_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the test statistic for the volume, with values near 0 indicating that no relatively dense material is present,
and values nearer 1 indicating that it is present.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(1,1,1) volume prediction</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pred</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tomopt.inference.volume.PanelX0Inferrer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tomopt.inference.volume.</span></span><span class="sig-name descname"><span class="pre">PanelX0Inferrer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#PanelX0Inferrer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.PanelX0Inferrer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer" title="tomopt.inference.volume.AbsX0Inferrer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsX0Inferrer</span></code></a></p>
<p>Class for inferring the X0 of every voxel in the passive volume using hits recorded by <a class="reference internal" href="tomopt.volume.html#tomopt.volume.layer.PanelDetectorLayer" title="tomopt.volume.layer.PanelDetectorLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PanelDetectorLayer</span></code></a> s.</p>
<p>The inference is based on the PoCA approach of assigning the entirety of the muon scattering to a single point,
and the X0 computation is based on inversion of the PDG scattering model described in
<a class="reference external" href="https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf">https://pdg.lbl.gov/2019/reviews/rpp2018-rev-passage-particles-matter.pdf</a>.</p>
<dl class="simple">
<dt>Once all scatter batches have been added, the inference proceeds thusly:</dt><dd><ul class="simple">
<li><p>For each muon i, a probability p_ij, is computed according to the probability that the PoCA was located in voxel j.</p></li>
<li><p>These probabilities are computed by integrating over the voxel the PDF of 3 uncorrelated Gaussians centred on the PoCA, with scales equal the uncertainty on the PoCA position in x,y,z.</p></li>
<li><p>p_ij is multiplied by muon efficiency e_i to compute a muon/voxel weight w_ij.</p></li>
<li><p>Inversion of the PDG model gives: <span class="math notranslate nohighlight">\(X_0 = \left(\frac{0.0136}{p^{\mathrm{rms}}}\right)^2\frac{\delta z}{\cos\left(\bar{\theta}^{\mathrm{rms}}\right)}\frac{2}{\theta^{\mathrm{rms}}_{\mathrm{tot.}}}\)</span></p></li>
<li><dl class="simple">
<dt>In order to account for the muon weights and compute different X0s for the voxels whilst using the whole muon population:</dt><dd><ul>
<li><p>Weighted RMSs are computed for each of the scattering terms in the right-hand side of the equation.</p></li>
<li><p>In addition to the muon weight w_ij, the variances of the squared values of the scattering variables is used to divide w_ij.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>The result is a set of X0 predictions X0_j.</p></li>
</ul>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Inversion of the PDG model does NOT account for the natural log term.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To simplify the computation code, this class relies heavily on lazy computation and memoisation; be careful if calling private methods manually.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> (<a class="reference internal" href="tomopt.volume.html#tomopt.volume.volume.Volume" title="tomopt.volume.volume.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a>) – volume through which the muons will be passed</p>
</dd>
</dl>
<p># TODO: refactor this to be provided to volume inference as a callable</p>
<dl class="py method">
<dt class="sig sig-object py" id="tomopt.inference.volume.PanelX0Inferrer.compute_efficiency">
<span class="sig-name descname"><span class="pre">compute_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scatters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tomopt/inference/volume.html#PanelX0Inferrer.compute_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tomopt.inference.volume.PanelX0Inferrer.compute_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the per-muon efficiency, given the individual muon hit efficiencies,
as the probability of at least two hits above and below the passive volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scatters</strong> (<a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch" title="tomopt.inference.scattering.ScatterBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a>) – scatter batch containing muons whose efficiency should be computed</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(muons) tensor of muon efficiencies</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tomopt.muon.html" class="btn btn-neutral float-right" title="tomopt.muon package" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="tomopt.benchmarks.u_lorry.html" class="btn btn-neutral" title="tomopt.benchmarks.u_lorry package" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021-2024, TomOpt Authors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/GilesStrong/tomopt_sphinx_theme">theme</a> based on a <a href="https://github.com/pytorch/pytorch_sphinx_theme">theme</a> provided by <a href="https://pytorch.org/">PyTorch</a> based on a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">tomopt.inference package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tomopt.inference.scattering">tomopt.inference.scattering module</a><ul>
<li><a class="reference internal" href="#tomopt.inference.scattering.GenScatterBatch"><code class="docutils literal notranslate"><span class="pre">GenScatterBatch</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch"><code class="docutils literal notranslate"><span class="pre">ScatterBatch</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.above_gen_hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.above_gen_hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.above_hit_effs"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.above_hit_effs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.above_hit_uncs"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.above_hit_uncs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.above_hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.above_hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.below_gen_hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.below_gen_hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.below_hit_effs"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.below_hit_effs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.below_hit_uncs"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.below_hit_uncs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.below_hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.below_hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dphi"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dphi</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dphi_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dphi_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dtheta"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dtheta</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dtheta_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dtheta_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dtheta_xy"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dtheta_xy</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dtheta_xy_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dtheta_xy_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dxy"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dxy</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.dxy_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.dxy_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.gen_hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.gen_hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.get_muon_trajectory"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.get_muon_trajectory()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.get_scatter_mask"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.get_scatter_mask()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.hit_effs"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.hit_effs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.hit_uncs"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.hit_uncs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.n_hits_above"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.n_hits_above</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.n_hits_below"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.n_hits_below</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.phi_in"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.phi_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.phi_in_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.phi_in_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.phi_out"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.phi_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.phi_out_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.phi_out_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.plot_scatter"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.plot_scatter()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.poca_xyz"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.poca_xyz</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.poca_xyz_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.poca_xyz_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.reco_hits"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.reco_hits</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_in"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_in_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_in_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_msc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_msc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_msc_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_msc_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_out"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_out_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_out_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_in"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_xy_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_in_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_xy_in_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_out"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_xy_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.theta_xy_out_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.theta_xy_out_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.total_scatter"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.total_scatter</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.total_scatter_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.total_scatter_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.track_in"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.track_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.track_out"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.track_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.track_start_in"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.track_start_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.track_start_out"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.track_start_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.xyz_in"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.xyz_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.xyz_in_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.xyz_in_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.xyz_out"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.xyz_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.scattering.ScatterBatch.xyz_out_unc"><code class="docutils literal notranslate"><span class="pre">ScatterBatch.xyz_out_unc</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-tomopt.inference.volume">tomopt.inference.volume module</a><ul>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsIntClassifierFromX0"><code class="docutils literal notranslate"><span class="pre">AbsIntClassifierFromX0</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsIntClassifierFromX0.add_scatters"><code class="docutils literal notranslate"><span class="pre">AbsIntClassifierFromX0.add_scatters()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsIntClassifierFromX0.compute_efficiency"><code class="docutils literal notranslate"><span class="pre">AbsIntClassifierFromX0.compute_efficiency()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsIntClassifierFromX0.get_prediction"><code class="docutils literal notranslate"><span class="pre">AbsIntClassifierFromX0.get_prediction()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsIntClassifierFromX0.x02probs"><code class="docutils literal notranslate"><span class="pre">AbsIntClassifierFromX0.x02probs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer"><code class="docutils literal notranslate"><span class="pre">AbsVolumeInferrer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer.add_scatters"><code class="docutils literal notranslate"><span class="pre">AbsVolumeInferrer.add_scatters()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer.compute_efficiency"><code class="docutils literal notranslate"><span class="pre">AbsVolumeInferrer.compute_efficiency()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsVolumeInferrer.get_prediction"><code class="docutils literal notranslate"><span class="pre">AbsVolumeInferrer.get_prediction()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.get_prediction"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.get_prediction()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_efficiency"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_efficiency</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_mom"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_mom</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_mom_unc"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_mom_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_poca_xyz"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_poca_xyz</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_poca_xyz_unc"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_poca_xyz_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_probs_per_voxel_zxy"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_probs_per_voxel_zxy</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_in"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_theta_in</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_in_unc"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_theta_in_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_out"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_theta_out</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_theta_out_unc"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_theta_out_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_total_scatter"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_total_scatter</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.muon_total_scatter_unc"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.muon_total_scatter_unc</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.n_mu"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.n_mu</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.vox_zxy_x0_pred_uncs"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.vox_zxy_x0_pred_uncs</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.vox_zxy_x0_preds"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.vox_zxy_x0_preds</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.AbsX0Inferrer.x0_from_scatters"><code class="docutils literal notranslate"><span class="pre">AbsX0Inferrer.x0_from_scatters()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s"><code class="docutils literal notranslate"><span class="pre">DenseBlockClassifierFromX0s</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.add_scatters"><code class="docutils literal notranslate"><span class="pre">DenseBlockClassifierFromX0s.add_scatters()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.compute_efficiency"><code class="docutils literal notranslate"><span class="pre">DenseBlockClassifierFromX0s.compute_efficiency()</span></code></a></li>
<li><a class="reference internal" href="#tomopt.inference.volume.DenseBlockClassifierFromX0s.get_prediction"><code class="docutils literal notranslate"><span class="pre">DenseBlockClassifierFromX0s.get_prediction()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tomopt.inference.volume.PanelX0Inferrer"><code class="docutils literal notranslate"><span class="pre">PanelX0Inferrer</span></code></a><ul>
<li><a class="reference internal" href="#tomopt.inference.volume.PanelX0Inferrer.compute_efficiency"><code class="docutils literal notranslate"><span class="pre">PanelX0Inferrer.compute_efficiency()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/sphinx_highlight.js"></script>
         <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-6 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer and user documentation for TomOpt</p>
          <a class="with-right-arrow" href="https://tomopt.readthedocs.io/en/stable">View Docs</a>
        </div>

        <div class="col-md-6 text-center">
          <h2>Tutorials</h2>
          <p>Get tutorials for beginner and advanced researchers demonstrating many of the features of TomOpt</p>
          <a class="with-right-arrow" href="https://github.com/GilesStrong/mode_muon_tomography#examples">View Tutorials</a>
        </div>

        <!-- <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="">View Resources</a>
        </div> -->
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://tomopt.readthedocs.io/en/stable" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <!-- <li class="list-title"><a href="https://tomopt.readthedocs.io/en/stable">TomOpt</a></li> -->
            <!-- <li><a href="">Get Started</a></li> -->
            <!-- <li><a href="">Features</a></li> -->
            <!-- <li><a href="">Ecosystem</a></li> -->
            <!-- <li><a href="">Blog</a></li> -->
            <!-- <li><a href="">Resources</a></li> -->
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Support</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a></li>
            <li><a href="https://tomopt.readthedocs.io/en/stable">Docs</a></li>
            <!-- <li><a href="" target="_blank">Discuss</a></li> -->
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CHANGES.md" target="_blank">Change Log</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CITATION.md" target="_blank">Citation</a></li>
            <!-- <li><a href="" target="_blank">Slack</a></li> -->
            <!-- <li><a href="https://github.com/GilesStrong/mode_muon_tomography/blob/main/CONTRIBUTING.md" target="_blank">Contributing</a></li> -->
          </ul>
        </div>

        <!-- <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    real people should not fill this in and expect good things - do not remove this or risk form bot signups

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="" target="_blank" class="facebook"></a>
            <a href="" target="_blank" class="twitter"></a>
          </div>
        </div> -->
      </div>
    </div>
  </footer>

  <!-- <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div> -->

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://tomopt.readthedocs.io/en/stable" aria-label="TomOpt"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <!-- <li>
            <a href="#">Get Started</a>
          </li> -->

          <!-- <li>
            <a href="#">Features</a>
          </li> -->

          <!-- <li>
            <a href="#">Ecosystem</a>
          </li> -->

          <!-- <li>
            <a href="">Blog</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography#examples">Tutorials</a>
          </li>

          <li>
            <a href="https://tomopt.readthedocs.io/en/stable">Docs</a>
          </li>

          <!-- <li>
            <a href="">Resources</a>
          </li> -->

          <li>
            <a href="https://github.com/GilesStrong/mode_muon_tomography">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>